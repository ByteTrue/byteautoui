import{d as ie,c as z,o as _,h as ut,a as k,i as Dt,r as V,j as ce,k as dt,t as Kt,l as Je,m as Le,b as d,u as l,n as Ut,w as p,p as et,g as q,N as oe,q as F,s as lt,v as ke,x as Se,y as Me,z as Rt,F as Oe,A as We,C as pe,e as je,B as ae,D as qe,E as Et,G as Mt,H as tt,I as qt,J as Jt,K as yt,L as Zt,M as Bt,O as Lt,P as De,Q as Be,R as Ye,S as gt,T as Qt,U as Ot,V as en,W as wt,X as tn,Y as nn,Z as Fe,_ as rn,$ as an,a0 as on,a1 as sn,a2 as kt,f as ln}from"./index-CG5BB-Ov.js";import{g as cn,a as zt,s as Te,t as ft,_ as ze,c as bt,R as ct,L as St,S as Ct,b as un,D as dn}from"./DeviceSelector--QEyPhi8.js";const fn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},_t=ie({name:"AppsOutline",render:function(f,c){return _(),z("svg",fn,c[0]||(c[0]=[ut('<rect x="64" y="64" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="216" y="64" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="368" y="64" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="64" y="216" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="216" y="216" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="368" y="216" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="64" y="368" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="216" y="368" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="368" y="368" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect>',9)]))}}),pn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Pt=ie({name:"ArrowBackOutline",render:function(f,c){return _(),z("svg",pn,c[0]||(c[0]=[k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M244 400L100 256l144-144"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M120 256h292"},null,-1)]))}}),hn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},vn=ie({name:"ArrowDownOutline",render:function(f,c){return _(),z("svg",hn,c[0]||(c[0]=[k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 268l144 144l144-144"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M256 392V100"},null,-1)]))}}),mn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},It=ie({name:"ArrowForwardOutline",render:function(f,c){return _(),z("svg",mn,c[0]||(c[0]=[k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M268 112l144 144l-144 144"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M392 256H100"},null,-1)]))}}),xn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},yn=ie({name:"ArrowUpOutline",render:function(f,c){return _(),z("svg",xn,c[0]||(c[0]=[k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 244l144-144l144 144"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M256 120v292"},null,-1)]))}}),gn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},wn=ie({name:"CloseOutline",render:function(f,c){return _(),z("svg",gn,c[0]||(c[0]=[k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 144L144 368"},null,-1)]))}}),kn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},At=ie({name:"CopyOutline",render:function(f,c){return _(),z("svg",kn,c[0]||(c[0]=[k("rect",{x:"128",y:"128",width:"336",height:"336",rx:"57",ry:"57",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{d:"M383.5 128l.5-24a56.16 56.16 0 0 0-56-56H112a64.19 64.19 0 0 0-64 64v216a56.16 56.16 0 0 0 56 56h24",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),bn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Nt=ie({name:"CreateOutline",render:function(f,c){return _(),z("svg",bn,c[0]||(c[0]=[k("path",{d:"M384 224v184a40 40 0 0 1-40 40H104a40 40 0 0 1-40-40V168a40 40 0 0 1 40-40h167.48",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{d:"M459.94 53.25a16.06 16.06 0 0 0-23.22-.56L424.35 65a8 8 0 0 0 0 11.31l11.34 11.32a8 8 0 0 0 11.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38z",fill:"currentColor"},null,-1),k("path",{d:"M399.34 90L218.82 270.2a9 9 0 0 0-2.31 3.93L208.16 299a3.91 3.91 0 0 0 4.86 4.86l24.85-8.35a9 9 0 0 0 3.93-2.31L422 112.66a9 9 0 0 0 0-12.66l-9.95-10a9 9 0 0 0-12.71 0z",fill:"currentColor"},null,-1)]))}}),Sn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Cn=ie({name:"DocumentOutline",render:function(f,c){return _(),z("svg",Sn,c[0]||(c[0]=[k("path",{d:"M416 221.25V416a48 48 0 0 1-48 48H144a48 48 0 0 1-48-48V96a48 48 0 0 1 48-48h98.75a32 32 0 0 1 22.62 9.37l141.26 141.26a32 32 0 0 1 9.37 22.62z",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{d:"M256 56v120a32 32 0 0 0 32 32h120",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),_n={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Pn=ie({name:"DownloadOutline",render:function(f,c){return _(),z("svg",_n,c[0]||(c[0]=[k("path",{d:"M336 176h40a40 40 0 0 1 40 40v208a40 40 0 0 1-40 40H136a40 40 0 0 1-40-40V216a40 40 0 0 1 40-40h40",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M176 272l80 80l80-80"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 48v288"},null,-1)]))}}),An={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Tn=ie({name:"EyeOutline",render:function(f,c){return _(),z("svg",An,c[0]||(c[0]=[k("path",{d:"M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 0 0-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 0 0 0-17.47C428.89 172.28 347.8 112 255.66 112z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("circle",{cx:"256",cy:"256",r:"80",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1)]))}}),$n={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Fn=ie({name:"FingerPrintOutline",render:function(f,c){return _(),z("svg",$n,c[0]||(c[0]=[k("path",{d:"M390.42 75.28a10.45 10.45 0 0 1-5.32-1.44C340.72 50.08 302.35 40 256.35 40c-45.77 0-89.23 11.28-128.76 33.84C122 77 115.11 74.8 111.87 69a12.4 12.4 0 0 1 4.63-16.32A281.81 281.81 0 0 1 256.35 16c49.23 0 92.23 11.28 139.39 36.48a12 12 0 0 1 4.85 16.08a11.3 11.3 0 0 1-10.17 6.72zm-330.79 126a11.73 11.73 0 0 1-6.7-2.16a12.26 12.26 0 0 1-2.78-16.8c22.89-33.6 52-60 86.69-78.48c72.58-38.84 165.51-39.12 238.32-.24c34.68 18.48 63.8 44.64 86.69 78a12.29 12.29 0 0 1-2.78 16.8a11.26 11.26 0 0 1-16.18-2.88c-20.8-30.24-47.15-54-78.36-70.56c-66.34-35.28-151.18-35.28-217.29.24c-31.44 16.8-57.79 40.8-78.59 71a10 10 0 0 1-9.02 5.08zM204.1 491a10.66 10.66 0 0 1-8.09-3.6C175.9 466.48 165 453 149.55 424c-16-29.52-24.27-65.52-24.27-104.16c0-71.28 58.71-129.36 130.84-129.36S387 248.56 387 319.84a11.56 11.56 0 1 1-23.11 0c0-58.08-48.32-105.36-107.72-105.36S148.4 261.76 148.4 319.84c0 34.56 7.39 66.48 21.49 92.4c14.8 27.6 25 39.36 42.77 58.08a12.67 12.67 0 0 1 0 17a12.44 12.44 0 0 1-8.56 3.68zm165.75-44.4c-27.51 0-51.78-7.2-71.66-21.36a129.1 129.1 0 0 1-55-105.36a11.57 11.57 0 1 1 23.12 0a104.28 104.28 0 0 0 44.84 85.44c16.41 11.52 35.6 17 58.72 17a147.41 147.41 0 0 0 24-2.4c6.24-1.2 12.25 3.12 13.4 9.84a11.92 11.92 0 0 1-9.47 13.92a152.28 152.28 0 0 1-27.95 2.88zM323.38 496a13 13 0 0 1-3-.48c-36.76-10.56-60.8-24.72-86-50.4c-32.37-33.36-50.16-77.76-50.16-125.28c0-38.88 31.9-70.56 71.19-70.56s71.2 31.68 71.2 70.56c0 25.68 21.5 46.56 48.08 46.56s48.08-20.88 48.08-46.56c0-90.48-75.13-163.92-167.59-163.92c-65.65 0-125.75 37.92-152.79 96.72c-9 19.44-13.64 42.24-13.64 67.2c0 18.72 1.61 48.24 15.48 86.64c2.32 6.24-.69 13.2-6.7 15.36a11.34 11.34 0 0 1-14.79-7a276.39 276.39 0 0 1-16.88-95c0-28.8 5.32-55 15.72-77.76c30.75-67 98.94-110.4 173.6-110.4c105.18 0 190.71 84.24 190.71 187.92c0 38.88-31.9 70.56-71.2 70.56s-71.2-31.68-71.2-70.56c.01-25.68-21.49-46.6-48.07-46.6s-48.08 20.88-48.08 46.56c0 41 15.26 79.44 43.23 108.24c22 22.56 43 35 75.59 44.4c6.24 1.68 9.71 8.4 8.09 14.64a11.39 11.39 0 0 1-10.87 9.16z",fill:"currentColor"},null,-1)]))}}),Dn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Un=ie({name:"FolderOutline",render:function(f,c){return _(),z("svg",Dn,c[0]||(c[0]=[k("path",{d:"M440 432H72a40 40 0 0 1-40-40V120a40 40 0 0 1 40-40h75.89a40 40 0 0 1 22.19 6.72l27.84 18.56a40 40 0 0 0 22.19 6.72H440a40 40 0 0 1 40 40v240a40 40 0 0 1-40 40z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 192h448"},null,-1)]))}}),Rn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},En=ie({name:"HomeOutline",render:function(f,c){return _(),z("svg",Rn,c[0]||(c[0]=[k("path",{d:"M80 212v236a16 16 0 0 0 16 16h96V328a24 24 0 0 1 24-24h80a24 24 0 0 1 24 24v136h96a16 16 0 0 0 16-16V212",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{d:"M480 256L266.89 52c-5-5.28-16.69-5.34-21.78 0L32 256",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 179V64h-48v69"},null,-1)]))}}),Mn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Bn=ie({name:"MoonOutline",render:function(f,c){return _(),z("svg",Mn,c[0]||(c[0]=[k("path",{d:"M160 136c0-30.62 4.51-61.61 16-88C99.57 81.27 48 159.32 48 248c0 119.29 96.71 216 216 216c88.68 0 166.73-51.57 200-128c-26.39 11.49-57.38 16-88 16c-119.29 0-216-96.71-216-216z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),Ln={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},On=ie({name:"PauseOutline",render:function(f,c){return _(),z("svg",Ln,c[0]||(c[0]=[k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M176 96h16v320h-16z"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M320 96h16v320h-16z"},null,-1)]))}}),zn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},In=ie({name:"PlayCircleOutline",render:function(f,c){return _(),z("svg",zn,c[0]||(c[0]=[k("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),k("path",{d:"M216.32 334.44l114.45-69.14a10.89 10.89 0 0 0 0-18.6l-114.45-69.14a10.78 10.78 0 0 0-16.32 9.31v138.26a10.78 10.78 0 0 0 16.32 9.31z",fill:"currentColor"},null,-1)]))}}),Nn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},jn=ie({name:"PlayOutline",render:function(f,c){return _(),z("svg",Nn,c[0]||(c[0]=[k("path",{d:"M112 111v290c0 17.44 17 28.52 31 20.16l247.9-148.37c12.12-7.25 12.12-26.33 0-33.58L143 90.84c-14-8.36-31 2.72-31 20.16z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1)]))}}),Hn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Vn=ie({name:"PlaySkipForwardOutline",render:function(f,c){return _(),z("svg",Hn,c[0]||(c[0]=[k("path",{d:"M112 111v290c0 17.44 17 28.52 31 20.16l247.9-148.37c12.12-7.25 12.12-26.33 0-33.58L143 90.84c-14-8.36-31 2.72-31 20.16z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32",d:"M400 80v352"},null,-1)]))}}),Xn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Gn=ie({name:"PowerOutline",render:function(f,c){return _(),z("svg",Xn,c[0]||(c[0]=[k("path",{d:"M378 108a191.41 191.41 0 0 1 70 148c0 106-86 192-192 192S64 362 64 256a192 192 0 0 1 69-148",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 64v192"},null,-1)]))}}),Yn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},pt=ie({name:"RefreshOutline",render:function(f,c){return _(),z("svg",Yn,c[0]||(c[0]=[k("path",{d:"M320 146s24.36-12-64-12a160 160 0 1 0 160 160",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 58l80 80l-80 80"},null,-1)]))}}),Wn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Kn=ie({name:"SaveOutline",render:function(f,c){return _(),z("svg",Wn,c[0]||(c[0]=[k("path",{d:"M380.93 57.37A32 32 0 0 0 358.3 48H94.22A46.21 46.21 0 0 0 48 94.22v323.56A46.21 46.21 0 0 0 94.22 464h323.56A46.36 46.36 0 0 0 464 417.78V153.7a32 32 0 0 0-9.37-22.63zM256 416a64 64 0 1 1 64-64a63.92 63.92 0 0 1-64 64zm48-224H112a16 16 0 0 1-16-16v-64a16 16 0 0 1 16-16h192a16 16 0 0 1 16 16v64a16 16 0 0 1-16 16z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),qn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Jn=ie({name:"SearchOutline",render:function(f,c){return _(),z("svg",qn,c[0]||(c[0]=[k("path",{d:"M221.09 64a157.09 157.09 0 1 0 157.09 157.09A157.1 157.1 0 0 0 221.09 64z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),k("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32",d:"M338.29 338.29L448 448"},null,-1)]))}}),Zn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Qn=ie({name:"SendOutline",render:function(f,c){return _(),z("svg",Zn,c[0]||(c[0]=[k("path",{d:"M470.3 271.15L43.16 447.31a7.83 7.83 0 0 1-11.16-7V327a8 8 0 0 1 6.51-7.86l247.62-47c17.36-3.29 17.36-28.15 0-31.44l-247.63-47a8 8 0 0 1-6.5-7.85V72.59c0-5.74 5.88-10.26 11.16-8L470.3 241.76a16 16 0 0 1 0 29.39z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),er={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ht=ie({name:"StopCircleOutline",render:function(f,c){return _(),z("svg",er,c[0]||(c[0]=[k("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),k("path",{d:"M310.4 336H201.6a25.62 25.62 0 0 1-25.6-25.6V201.6a25.62 25.62 0 0 1 25.6-25.6h108.8a25.62 25.62 0 0 1 25.6 25.6v108.8a25.62 25.62 0 0 1-25.6 25.6z",fill:"currentColor"},null,-1)]))}}),tr={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},vt=ie({name:"TrashOutline",render:function(f,c){return _(),z("svg",tr,c[0]||(c[0]=[ut('<path d="M112 112l20 320c.95 18.49 14.4 32 32 32h184c17.67 0 30.87-13.51 32-32l20-320" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32" d="M80 112h352" fill="currentColor"></path><path d="M192 112V72h0a23.93 23.93 0 0 1 24-24h80a23.93 23.93 0 0 1 24 24h0v40" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M256 176v224"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M184 176l8 224"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M328 176l-8 224"></path>',6)]))}}),nr={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},rr=ie({name:"VolumeHighOutline",render:function(f,c){return _(),z("svg",nr,c[0]||(c[0]=[k("path",{d:"M126 192H56a8 8 0 0 0-8 8v112a8 8 0 0 0 8 8h69.65a15.93 15.93 0 0 1 10.14 3.54l91.47 74.89A8 8 0 0 0 240 392V120a8 8 0 0 0-12.74-6.43l-91.47 74.89A15 15 0 0 1 126 192z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{d:"M320 320c9.74-19.38 16-40.84 16-64c0-23.48-6-44.42-16-64",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{d:"M368 368c19.48-33.92 32-64.06 32-112s-12-77.74-32-112",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{d:"M416 416c30-46 48-91.43 48-160s-18-113-48-160",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),ar={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},or=ie({name:"VolumeLowOutline",render:function(f,c){return _(),z("svg",ar,c[0]||(c[0]=[k("path",{d:"M189.65 192H120a8 8 0 0 0-8 8v112a8 8 0 0 0 8 8h69.65a16 16 0 0 1 10.14 3.63l91.47 75a8 8 0 0 0 12.74-6.46V119.83a8 8 0 0 0-12.74-6.44l-91.47 75a16 16 0 0 1-10.14 3.61z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),k("path",{d:"M384 320c9.74-19.41 16-40.81 16-64c0-23.51-6-44.4-16-64",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),ir={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},sr=ie({name:"VolumeMuteOutline",render:function(f,c){return _(),z("svg",ir,c[0]||(c[0]=[ut('<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32" d="M416 432L64 80"></path><path d="M224 136.92v33.8a4 4 0 0 0 1.17 2.82l24 24a4 4 0 0 0 6.83-2.82v-74.15a24.53 24.53 0 0 0-12.67-21.72a23.91 23.91 0 0 0-25.55 1.83a8.27 8.27 0 0 0-.66.51l-31.94 26.15a4 4 0 0 0-.29 5.92l17.05 17.06a4 4 0 0 0 5.37.26z" fill="currentColor"></path><path d="M224 375.08l-78.07-63.92a32 32 0 0 0-20.28-7.16H64v-96h50.72a4 4 0 0 0 2.82-6.83l-24-24a4 4 0 0 0-2.82-1.17H56a24 24 0 0 0-24 24v112a24 24 0 0 0 24 24h69.76l91.36 74.8a8.27 8.27 0 0 0 .66.51a23.93 23.93 0 0 0 25.85 1.69A24.49 24.49 0 0 0 256 391.45v-50.17a4 4 0 0 0-1.17-2.82l-24-24a4 4 0 0 0-6.83 2.82zM125.82 336z" fill="currentColor"></path><path d="M352 256c0-24.56-5.81-47.88-17.75-71.27a16 16 0 0 0-28.5 14.54C315.34 218.06 320 236.62 320 256q0 4-.31 8.13a8 8 0 0 0 2.32 6.25l19.66 19.67a4 4 0 0 0 6.75-2A146.89 146.89 0 0 0 352 256z" fill="currentColor"></path><path d="M416 256c0-51.19-13.08-83.89-34.18-120.06a16 16 0 0 0-27.64 16.12C373.07 184.44 384 211.83 384 256c0 23.83-3.29 42.88-9.37 60.65a8 8 0 0 0 1.9 8.26l16.77 16.76a4 4 0 0 0 6.52-1.27C410.09 315.88 416 289.91 416 256z" fill="currentColor"></path><path d="M480 256c0-74.26-20.19-121.11-50.51-168.61a16 16 0 1 0-27 17.22C429.82 147.38 448 189.5 448 256c0 47.45-8.9 82.12-23.59 113a4 4 0 0 0 .77 4.55L443 391.39a4 4 0 0 0 6.4-1C470.88 348.22 480 307 480 256z" fill="currentColor"></path>',6)]))}});function lr(i,f){const c=[];let h=i;for(;h;){const y=cr(h,f);c.unshift(y),h=jt(h,f)}return"/"+c.join("/")}function cr(i,f){if(i.resource_id)return`*[@resource-id="${i.resource_id}"]`;if(i.text&&i.text.trim())return`*[@text="${i.text}"]`;const c=i.class_name||"*",h=jt(i,f);if(h){const y=h.children?.filter(g=>g.class_name===i.class_name)||[];if(y.length>1){const g=y.findIndex(M=>M.key===i.key);return`${c}[${g+1}]`}}return c}function jt(i,f){for(const c of f)if(c.children?.some(h=>h.key===i.key))return c}function ur(i){const f=[];function c(h){f.push(h),h.children?.forEach(c)}return i.forEach(c),f}const nt=Dt("device",()=>{const i=V("android"),f=V(""),c=V(null),h=V(null),y=V(null),g=V(!1),M=V(null),C=V(0),S=ce(()=>c.value?{width:c.value.width,height:c.value.height}:{width:0,height:0}),O=ce(()=>f.value?(C.value,cn(i.value,f.value)):"");function v(b,w){i.value=b,f.value=w,c.value=null,h.value=null,M.value=null}async function D(){if(f.value){g.value=!0,M.value=null;try{c.value=await zt(i.value,f.value),C.value++}catch(b){M.value=b instanceof Error?b.message:String(b)}finally{g.value=!1}}}function L(b){if(b&&c.value){const w=ur(c.value.nodes);b.xpath=lr(b,w)}h.value=b}function X(){C.value++}function B(b){y.value=b}function U(b){b.hierarchy&&(c.value=b.hierarchy),b.screenshot&&C.value++}return{platform:i,serial:f,hierarchy:c,selectedNode:h,hoveredNode:y,loading:g,error:M,screenSize:S,screenshotUrl:O,setDevice:v,refreshHierarchy:D,selectNode:L,refreshScreenshot:X,setHoveredNode:B,updateFromRemote:U}}),dr={zh:{common:{confirm:"确定",cancel:"取消",save:"保存",delete:"删除",edit:"编辑",close:"关闭",search:"搜索",refresh:"刷新",loading:"加载中...",clear:"清除",yes:"是",no:"否"},device:{selectDevice:"选择设备",hierarchy:"层级",actions:"录制回放",package:"包管理",home:"主页",back:"返回",apps:"应用",wake:"唤醒",stop:"停止",volumeUp:"音量+",volumeDown:"音量-",volumeMute:"静音",swipeUp:"上滑",swipeDown:"下滑",swipeLeft:"左滑",swipeRight:"右滑",refresh:"刷新 (按键盘R也可以刷新画面)",tapElement:"点击元素"},screen:{viewMode:"检查",pointerMode:"控制"},hierarchy:{searchPlaceholder:"输入搜索内容...",searchType:{text:"文本 (text)",xpath:"XPath",id:"Resource ID",className:"Class Name"},foundResults:"找到 {count} 个结果",noResults:"未找到匹配的元素",noElement:"暂无层级数据"},actions:{recordTab:"录制",playbackTab:"回放",editTab:"编辑",startRecording:"开始录制",stopRecording:"停止录制",pauseRecording:"暂停",continueRecording:"继续",clearRecording:"清空",saveRecording:"保存",recording:"正在录制...",recordingPaused:"录制已暂停",operationSteps:"操作步骤",noOperations:"暂无录制操作",play:"播放",pause:"暂停",stop:"停止",step:"单步",progress:"进度",recordingList:"录制列表",noRecordings:"暂无录制文件",load:"加载",editRecording:"编辑录制",noEditingRecording:"请从回放列表中选择一个录制进行编辑",group:"分组",name:"名称",operationCount:"操作数",editAction:"编辑操作",actionType:"操作类型",waitTime:"等待时间",relativeTime:"相对时间",milliseconds:"毫秒",seconds:"秒",coordinates:"坐标",coordinateX:"X坐标",coordinateY:"Y坐标",startPosition:"起始位置",endPosition:"结束位置",xpathSelector:"XPath选择器",xpathPlaceholder:"可选，留空则使用坐标模式",inputText:"输入文本",swipeDuration:"滑动时长",sleepDuration:"等待时长",command:"命令",selectRecording:"请选择录制",idle:"待机",playing:"播放中",paused:"已暂停",stopped:"已停止",error:"错误",confirmClear:"确认清空",confirmClearMessage:"确定要清空所有录制的操作吗?此操作不可撤销。",confirmDelete:"确认删除",confirmDeleteMessage:'确定要删除录制 "{name}" 吗?此操作不可撤销。',saveDialogTitle:"保存录制",groupPlaceholder:"default",namePlaceholder:"Recording_xxx",recordingStopped:"录制已停止,共 {count} 步操作",recordingStarted:"开始录制操作",recordingCleared:"已清空录制",recordingSaved:"录制已保存: {name}",recordingLoaded:"已加载录制: {name}",recordingDeleted:"录制已删除",playbackComplete:"回放完成",actionTypes:{tap:"点击",swipe:"滑动",input:"输入",sleep:"等待",command:"命令",back:"返回",home:"主页"}},package:{currentApp:"当前应用",packageName:"包名",launchActivity:"启动Activity",version:"版本",installTime:"安装时间",actions:"操作",noAppSelected:"未选择应用",pleaseSelectApp:"请从下方列表选择一个应用",installedApps:"已安装应用",noApps:"未找到应用",launch:"启动",stop:"停止",clear:"清除数据",uninstall:"卸载",confirmUninstall:"确认卸载",confirmUninstallMessage:'确定要卸载应用 "{name}" 吗?',confirmClearData:"确认清除",confirmClearDataMessage:'确定要清除应用 "{name}" 的数据吗?',appLaunched:"应用已启动",appStopped:"应用已停止",dataCleared:"数据已清除",appUninstalled:"应用已卸载"}},en:{common:{confirm:"Confirm",cancel:"Cancel",save:"Save",delete:"Delete",edit:"Edit",close:"Close",search:"Search",refresh:"Refresh",loading:"Loading...",clear:"Clear",yes:"Yes",no:"No"},device:{selectDevice:"Select Device",hierarchy:"Hierarchy",actions:"Actions",package:"Package",home:"Home",back:"Back",apps:"Apps",wake:"Wake",stop:"Stop",volumeUp:"Vol +",volumeDown:"Vol -",volumeMute:"Mute",swipeUp:"Swipe Up",swipeDown:"Swipe Down",swipeLeft:"Swipe Left",swipeRight:"Swipe Right",refresh:"Refresh (Press R to refresh)",tapElement:"Tap Element"},screen:{viewMode:"Inspect",pointerMode:"Control"},hierarchy:{searchPlaceholder:"Enter search text...",searchType:{text:"Text",xpath:"XPath",id:"Resource ID",className:"Class Name"},foundResults:"Found {count} results",noResults:"No matching elements found",noElement:"No hierarchy data"},actions:{recordTab:"Record",playbackTab:"Playback",editTab:"Edit",startRecording:"Start Recording",stopRecording:"Stop Recording",pauseRecording:"Pause",continueRecording:"Continue",clearRecording:"Clear",saveRecording:"Save",recording:"Recording...",recordingPaused:"Recording Paused",operationSteps:"Steps",noOperations:"No recorded operations",play:"Play",pause:"Pause",stop:"Stop",step:"Step",progress:"Progress",recordingList:"Recordings",noRecordings:"No recordings found",load:"Load",editRecording:"Edit Recording",noEditingRecording:"Please select a recording from the list to edit",group:"Group",name:"Name",operationCount:"Operations",editAction:"Edit Action",actionType:"Action Type",waitTime:"Wait Time",relativeTime:"Relative Time",milliseconds:"ms",seconds:"s",coordinates:"Coordinates",coordinateX:"X Coordinate",coordinateY:"Y Coordinate",startPosition:"Start Position",endPosition:"End Position",xpathSelector:"XPath Selector",xpathPlaceholder:"Optional, use coordinates if empty",inputText:"Input Text",swipeDuration:"Swipe Duration",sleepDuration:"Sleep Duration",command:"Command",selectRecording:"Select Recording",idle:"Idle",playing:"Playing",paused:"Paused",stopped:"Stopped",error:"Error",confirmClear:"Confirm Clear",confirmClearMessage:"Are you sure to clear all recorded operations? This cannot be undone.",confirmDelete:"Confirm Delete",confirmDeleteMessage:'Are you sure to delete recording "{name}"? This cannot be undone.',saveDialogTitle:"Save Recording",groupPlaceholder:"default",namePlaceholder:"Recording_xxx",recordingStopped:"Recording stopped, {count} operations",recordingStarted:"Recording started",recordingCleared:"Recording cleared",recordingSaved:"Recording saved: {name}",recordingLoaded:"Recording loaded: {name}",recordingDeleted:"Recording deleted",playbackComplete:"Playback complete",actionTypes:{tap:"Tap",swipe:"Swipe",input:"Input",sleep:"Sleep",command:"Command",back:"Back",home:"Home"}},package:{currentApp:"Current App",packageName:"Package",launchActivity:"Launch Activity",version:"Version",installTime:"Install Time",actions:"Actions",noAppSelected:"No app selected",pleaseSelectApp:"Please select an app from the list below",installedApps:"Installed Apps",noApps:"No apps found",launch:"Launch",stop:"Stop",clear:"Clear Data",uninstall:"Uninstall",confirmUninstall:"Confirm Uninstall",confirmUninstallMessage:'Are you sure to uninstall app "{name}"?',confirmClearData:"Confirm Clear",confirmClearDataMessage:'Are you sure to clear data of app "{name}"?',appLaunched:"App launched",appStopped:"App stopped",dataCleared:"Data cleared",appUninstalled:"App uninstalled"}}},Ke=Dt("i18n",()=>{const i=V(localStorage.getItem("language")||"zh"),f=ce(()=>dr[i.value]);function c(y){i.value=y,localStorage.setItem("language",y)}function h(y,g){return g?y.replace(/\{(\w+)\}/g,(M,C)=>g[C]!==void 0?String(g[C]):M):y}return{locale:i,t:f,setLocale:c,format:h}});class mt{name;style;constructor(f,c){this.name=f,this.style=c}}class fr extends mt{x;y;width;height;constructor(f,c,h,y,g){super("rect",g),this.x=f,this.y=c,this.width=h,this.height=y}draw(f){f.beginPath(),f.rect(this.x,this.y,this.width,this.height),this.style==="select"?(f.fillStyle="rgba(255, 255, 0, 0.3)",f.strokeStyle="#FFD700",f.lineWidth=3):this.style==="hover"&&(f.fillStyle="rgba(0, 150, 255, 0.2)",f.strokeStyle="#0096FF",f.lineWidth=2),f.fill(),f.stroke()}}class pr extends mt{x;y;canvasWidth;canvasHeight;constructor(f,c,h,y){super("crosshair","crosshair"),this.x=f,this.y=c,this.canvasWidth=h,this.canvasHeight=y}draw(f){f.beginPath(),f.strokeStyle="#FF0000",f.lineWidth=1,f.setLineDash([5,5]),f.moveTo(0,this.y),f.lineTo(this.canvasWidth,this.y),f.moveTo(this.x,0),f.lineTo(this.x,this.canvasHeight),f.stroke(),f.setLineDash([])}}class hr extends mt{points;constructor(f){super("track","hover"),this.points=f}draw(f){if(this.points.length<2)return;f.beginPath(),f.strokeStyle="rgba(0, 150, 255, 0.8)",f.lineWidth=3,f.lineCap="round",f.lineJoin="round";const c=this.points[0];c&&f.moveTo(c.x,c.y);for(let h=1;h<this.points.length;h++){const y=this.points[h];y&&f.lineTo(y.x,y.y)}f.stroke()}}function vr(){const i=V(null),f=ce(()=>i.value?.getContext("2d")||null),c=V([]);function h(){if(!f.value||!i.value)return;const v=i.value;f.value.clearRect(0,0,v.width,v.height),c.value.forEach(D=>{f.value&&D.draw(f.value)})}function y(v,D){const[L,X,B,U]=v,b=B-L,w=U-X;c.value.push(new fr(L,X,b,w,D)),h()}function g(v,D){i.value&&(c.value.push(new pr(v,D,i.value.width,i.value.height)),h())}function M(v){c.value.push(new hr(v)),h()}function C(){c.value=[],h()}function S(v){c.value=c.value.filter(D=>D.style!==v),h()}function O(v,D){i.value&&(i.value.width=v,i.value.height=D,h())}return{canvasRef:i,addRect:y,addCrosshair:g,addTrack:M,clearShapes:C,clearShapesByType:S,resizeCanvas:O,redraw:h}}function mr(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function xr(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var f=i.default;if(typeof f=="function"){var c=function h(){var y=!1;try{y=this instanceof h}catch{}return y?Reflect.construct(f,arguments,this.constructor):f.apply(this,arguments)};c.prototype=f.prototype}else c={};return Object.defineProperty(c,"__esModule",{value:!0}),Object.keys(i).forEach(function(h){var y=Object.getOwnPropertyDescriptor(i,h);Object.defineProperty(c,h,y.get?y:{enumerable:!0,get:function(){return i[h]}})}),c}var Qe={exports:{}};const yr={},gr=Object.freeze(Object.defineProperty({__proto__:null,default:yr},Symbol.toStringTag,{value:"Module"})),wr=xr(gr);var kr=Qe.exports,Tt;function br(){return Tt||(Tt=1,(function(i,f){(function(c,h){i.exports=h(wr)})(kr,(function(c){function h(a,u){(u==null||u>a.length)&&(u=a.length);for(var t=0,n=Array(u);t<u;t++)n[t]=a[t];return n}function y(a){if(Array.isArray(a))return a}function g(a){if(Array.isArray(a))return h(a)}function M(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function C(a,u){if(!(a instanceof u))throw new TypeError("Cannot call a class as a function")}function S(a,u){for(var t=0;t<u.length;t++){var n=u[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,P(n.key),n)}}function O(a,u,t){return u&&S(a.prototype,u),t&&S(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function v(a,u){var t=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!t){if(Array.isArray(a)||(t=G(a))||u){t&&(a=t);var n=0,r=function(){};return{s:r,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(m){throw m},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,e=!0,o=!1;return{s:function(){t=t.call(a)},n:function(){var m=t.next();return e=m.done,m},e:function(m){o=!0,s=m},f:function(){try{e||t.return==null||t.return()}finally{if(o)throw s}}}}function D(a){var u=U();return function(){var t,n=X(a);if(u){var r=X(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return me(this,t)}}function L(a,u,t){return(u=P(u))in a?Object.defineProperty(a,u,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[u]=t,a}function X(a){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(u){return u.__proto__||Object.getPrototypeOf(u)},X(a)}function B(a,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(u&&u.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),u&&ge(a,u)}function U(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(U=function(){return!!a})()}function b(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function w(a,u){var t=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(t!=null){var n,r,s,e,o=[],m=!0,x=!1;try{if(s=(t=t.call(a)).next,u!==0)for(;!(m=(n=s.call(t)).done)&&(o.push(n.value),o.length!==u);m=!0);}catch($){x=!0,r=$}finally{try{if(!m&&t.return!=null&&(e=t.return(),Object(e)!==e))return}finally{if(x)throw r}}return o}}function J(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function de(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function me(a,u){if(u&&(typeof u=="object"||typeof u=="function"))return u;if(u!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M(a)}function ge(a,u){return ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},ge(a,u)}function he(a,u){return y(a)||w(a,u)||G(a,u)||J()}function ve(a){return g(a)||b(a)||G(a)||de()}function E(a,u){if(typeof a!="object"||!a)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var n=t.call(a,u);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}function P(a){var u=E(a,"string");return typeof u=="symbol"?u:u+""}function A(a){"@babel/helpers - typeof";return A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},A(a)}function G(a,u){if(a){if(typeof a=="string")return h(a,u);var t={}.toString.call(a).slice(8,-1);return t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set"?Array.from(a):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?h(a,u):void 0}}var te,ue;function Ce(a,u){te=a,ue=u}function se(a){if(te){for(var u=arguments.length,t=new Array(u>1?u-1:0),n=1;n<u;n++)t[n-1]=arguments[n];te.apply(void 0,[a].concat(t))}}function ne(a){if(ue){for(var u=arguments.length,t=new Array(u>1?u-1:0),n=1;n<u;n++)t[n-1]=arguments[n];ue.apply(void 0,[a].concat(t))}}var T=(function(){function a(u){C(this,a),this.listener={},this.type=u|""}return O(a,[{key:"on",value:function(t,n){return this.listener[t]||(this.listener[t]=[]),this.listener[t].push(n),!0}},{key:"off",value:function(t,n){if(this.listener[t]){var r=this.listener[t].indexOf(n);return r>-1&&this.listener[t].splice(r,1),!0}return!1}},{key:"offAll",value:function(){this.listener={}}},{key:"dispatch",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return this.listener[t]?(this.listener[t].map(function(e){e.apply(null,r)}),!0):!1}}]),a})(),W=(function(){function a(){C(this,a)}return O(a,null,[{key:"init",value:function(){a.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hev1:[],hvcC:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t;for(t in a.types)a.types.hasOwnProperty(t)&&(a.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);a.HDLR_TYPES={video:n,audio:r};var s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),e=new Uint8Array([0,0,0,0,0,0,0,0]);a.STTS=a.STSC=a.STCO=e,a.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),a.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),a.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),a.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),m=new Uint8Array([97,118,99,49]),x=new Uint8Array([0,0,0,1]);a.FTYP=a.box(a.types.ftyp,o,x,o,m),a.DINF=a.box(a.types.dinf,a.box(a.types.dref,s))}},{key:"box",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];for(var e=8,o=r.length,m=o,x;o--;)e+=r[o].byteLength;for(x=new Uint8Array(e),x[0]=e>>24&255,x[1]=e>>16&255,x[2]=e>>8&255,x[3]=e&255,x.set(t,4),o=0,e=8;o<m;++o)x.set(r[o],e),e+=r[o].byteLength;return x}},{key:"hdlr",value:function(t){return a.box(a.types.hdlr,a.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return a.box(a.types.mdat,t)}},{key:"mdhd",value:function(t,n){return a.box(a.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255,85,196,0,0]))}},{key:"mdia",value:function(t){return a.box(a.types.mdia,a.mdhd(t.timescale,t.duration),a.hdlr(t.type),a.minf(t))}},{key:"mfhd",value:function(t){return a.box(a.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}},{key:"minf",value:function(t){return t.type==="audio"?a.box(a.types.minf,a.box(a.types.smhd,a.SMHD),a.DINF,a.stbl(t)):a.box(a.types.minf,a.box(a.types.vmhd,a.VMHD),a.DINF,a.stbl(t))}},{key:"moof",value:function(t,n,r){return a.box(a.types.moof,a.mfhd(t),a.traf(r,n))}},{key:"moov",value:function(t,n,r){for(var s=t.length,e=[];s--;)e[s]=a.trak(t[s]);return a.box.apply(null,[a.types.moov,a.mvhd(r,n)].concat(e).concat(a.mvex(t)))}},{key:"mvex",value:function(t){for(var n=t.length,r=[];n--;)r[n]=a.trex(t[n]);return a.box.apply(null,[a.types.mvex].concat(r))}},{key:"mvhd",value:function(t,n){var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,t>>24&255,t>>16&255,t>>8&255,t&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return a.box(a.types.mvhd,r)}},{key:"sdtp",value:function(t){var n=t.samples||[],r=new Uint8Array(4+n.length),s,e;for(e=0;e<n.length;e++)s=n[e].flags,r[e+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return a.box(a.types.sdtp,r)}},{key:"stbl",value:function(t){return a.box(a.types.stbl,a.stsd(t),a.box(a.types.stts,a.STTS),a.box(a.types.stsc,a.STSC),a.box(a.types.stsz,a.STSZ),a.box(a.types.stco,a.STCO))}},{key:"avc1",value:function(t){var n=[],r=[],s,e,o;for(s=0;s<t.sps.length;s++)e=t.sps[s],o=e.byteLength,n.push(o>>>8&255),n.push(o&255),n=n.concat(Array.prototype.slice.call(e));for(s=0;s<t.pps.length;s++)e=t.pps[s],o=e.byteLength,r.push(o>>>8&255),r.push(o&255),r=r.concat(Array.prototype.slice.call(e));var m=a.box(a.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|t.sps.length].concat(n).concat([t.pps.length]).concat(r))),x=t.width,$=t.height;return a.box(a.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,x>>8&255,x&255,$>>8&255,$&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,98,105,110,101,108,112,114,111,46,114,117,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),m,a.box(a.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"hev1",value:function(t){for(var n=[],r=[],s=[],e,o,m=0;m<(((x=t.vps)===null||x===void 0?void 0:x.length)||0);m++){var x;e=t.vps[m],o=e.byteLength,n.push(o>>>8&255,o&255),n=n.concat(Array.prototype.slice.call(e))}for(var $=0;$<(((N=t.sps)===null||N===void 0?void 0:N.length)||0);$++){var N;e=t.sps[$],o=e.byteLength,r.push(o>>>8&255,o&255),r=r.concat(Array.prototype.slice.call(e))}for(var H=0;H<(((Q=t.pps)===null||Q===void 0?void 0:Q.length)||0);H++){var Q;e=t.pps[H],o=e.byteLength,s.push(o>>>8&255,o&255),s=s.concat(Array.prototype.slice.call(e))}var fe=t.hvcC,$e=fe.profile_space,Ue=fe.tier_flag,_e=fe.profile_idc,Pe=fe.profile_compatibility_flags,be=fe.constraint_indicator_flags,Xe=fe.level_idc,Ie=fe.chroma_format_idc,Ge=a.box(a.types.hvcC,new Uint8Array([1,$e<<6|Ue<<5|_e,Pe>>24&255,Pe>>16&255,Pe>>8&255,Pe&255].concat(ve(be),[Xe,240,0,252,252|Ie,248,248,0,0,3,3,32,0,1],ve(n),[33,0,1],ve(r),[34,0,1],ve(s)))),Ne=t.width,ye=t.height;return a.box(a.types.hev1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ne>>8&255,Ne&255,ye>>8&255,ye&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,98,105,110,101,108,112,114,111,46,114,117,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),Ge,a.box(a.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(t){var n=t.config.byteLength,r=new Uint8Array(26+n+3);return r.set([0,0,0,0,3,23+n,0,1,0,4,15+n,64,21,0,0,0,0,0,0,0,0,0,0,0,5,n]),r.set(t.config,26),r.set([6,1,2],26+n),r}},{key:"mp4a",value:function(t){var n=t.audiosamplerate;return a.box(a.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,n&255,0,0]),a.box(a.types.esds,a.esds(t)))}},{key:"stsd",value:function(t){return t.type==="audio"?a.box(a.types.stsd,a.STSD,a.mp4a(t)):t.codec.startsWith("hvc1")?a.box(a.types.stsd,a.STSD,a.hev1(t)):a.box(a.types.stsd,a.STSD,a.avc1(t))}},{key:"tkhd",value:function(t){var n=t.id,r=t.duration,s=t.width,e=t.height,o=t.volume;return a.box(a.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,n&255,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,r&255,0,0,0,0,0,0,0,0,0,0,0,0,o>>0&255,o%1*10>>0&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,e>>8&255,e&255,0,0]))}},{key:"traf",value:function(t,n){var r=a.sdtp(t),s=t.id;return a.box(a.types.traf,a.box(a.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),a.box(a.types.tfdt,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),a.trun(t,r.length+16+16+8+16+8+8),r)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,a.box(a.types.trak,a.tkhd(t),a.mdia(t))}},{key:"trex",value:function(t){var n=t.id;return a.box(a.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,n){var r=t.samples||[],s=r.length,e=12+16*s,o=new Uint8Array(e),m,x,$,N,H,Q;for(n+=8+e,o.set([0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0),m=0;m<s;m++)x=r[m],$=x.duration,N=x.size,H=x.flags,Q=x.cts,o.set([$>>>24&255,$>>>16&255,$>>>8&255,$&255,N>>>24&255,N>>>16&255,N>>>8&255,N&255,H.isLeading<<2|H.dependsOn,H.isDependedOn<<6|H.hasRedundancy<<4|H.paddingValue<<1|H.isNonSync,H.degradPrio&61440,H.degradPrio&15,Q>>>24&255,Q>>>16&255,Q>>>8&255,Q&255],12+16*m);return a.box(a.types.trun,o)}},{key:"initSegment",value:function(t,n,r){a.types||a.init();var s=a.moov(t,n,r),e;return e=new Uint8Array(a.FTYP.byteLength+s.byteLength),e.set(a.FTYP),e.set(s,a.FTYP.byteLength),e}}]),a})(),Z=(function(){function a(){C(this,a)}return O(a,null,[{key:"samplingRateMap",get:function(){return[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]}},{key:"getHeaderLength",value:function(t){return t[1]&1?7:9}},{key:"getFrameLength",value:function(t){return(t[3]&3)<<11|t[4]<<3|(t[5]&224)>>>5}},{key:"isAACPattern",value:function(t){return t[0]===255&&(t[1]&240)===240&&(t[1]&6)===0}},{key:"extractAAC",value:function(t){var n=0,r=t.byteLength,s=[],e,o;if(!a.isAACPattern(t))return ne("Invalid ADTS audio format"),{valid:!1};e=a.getHeaderLength(t);for(var m=t.subarray(0,e);n<r;)o=a.getFrameLength(t),s.push(t.subarray(e,o)),t=t.slice(o),n+=o;return{valid:!0,header:m,slices:s}}}]),a})(),xe=1,I=(function(a){B(t,a);var u=D(t);function t(){return C(this,t),u.apply(this,arguments)}return O(t,[{key:"flush",value:function(){this.mp4track.len=0,this.mp4track.samples=[]}},{key:"isReady",value:function(){return!this.readyToDecode||!this.samples.length?null:!0}}],[{key:"getTrackID",value:function(){return xe++}}]),t})(T),Y=(function(a){B(t,a);var u=D(t);function t(n,r,s){var e;return C(this,t),e=u.call(this,"AACRemuxer"),e.frameDuration=s,e.readyToDecode=!1,e.header=null,e.nextDts=0,e.dts=0,e.mp4track={id:I.getTrackID(),type:"audio",channelCount:0,len:0,fragmented:!0,timescale:n,duration:r,samples:[],config:"",codec:""},e.samples=[],e}return O(t,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.header=null,this.mp4track.codec="",this.mp4track.channelCount="",this.mp4track.config="",this.mp4track.timescale=this.timescale,this.nextDts=0,this.dts=0}},{key:"feed",value:function(r,s){var e=Z.extractAAC(r),o=e.valid,m=e.header,x=e.slices;return this.header||(this.header=m),o&&x.length>0?(this.remux(this.getAudioFrames(x,s)),!0):(ne("Failed to extract audio data from:",r),this.dispatch("outOfData"),!1)}},{key:"getAudioFrames",value:function(r,s){var e=[],o=0,m=0,x=v(r),$;try{for(x.s();!($=x.n()).done;){var N=$.value;e.push({units:N})}}catch(H){x.e(H)}finally{x.f()}return o=s?s/e.length|0:this.frameDuration,m=s?s-o*e.length:0,e.map(function(H){H.duration=o,m>0&&(H.duration++,m--)}),e}},{key:"remux",value:function(r){if(r.length>0)for(var s=0;s<r.length;s++){var e=r[s],o=e.units,m=o.byteLength;this.samples.push({units:o,size:m,duration:e.duration}),this.mp4track.len+=m,this.readyToDecode||this.setAACConfig()}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var r=new Uint8Array(this.mp4track.len),s=0,e=this.mp4track.samples,o,m;for(this.dts=this.nextDts;this.samples.length;){var x=this.samples.shift();if(x.units,m=x.duration,m<=0){se("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(m)),this.mp4track.len-=x.size;continue}this.nextDts+=m,o={size:x.size,duration:m,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},r.set(x.units,s),s+=x.size,e.push(o)}return e.length?new Uint8Array(r.buffer,0,this.mp4track.len):null}},{key:"setAACConfig",value:function(){var r,s,e,o=new Uint8Array(2);this.header&&(r=((this.header[2]&192)>>>6)+1,s=(this.header[2]&60)>>>2,e=(this.header[2]&1)<<2,e|=(this.header[3]&192)>>>6,o[0]=r<<3,o[0]|=(s&14)>>1,o[1]|=(s&1)<<7,o[1]|=e<<3,this.mp4track.codec="mp4a.40."+r,this.mp4track.channelCount=e,this.mp4track.config=o,this.readyToDecode=!0)}}]),t})(I),ee=(function(){function a(u){C(this,a),this.data=u,this.index=0,this.bitLength=u.byteLength*8}return O(a,[{key:"setData",value:function(t){this.data=t,this.index=0,this.bitLength=t.byteLength*8}},{key:"bitsAvailable",get:function(){return this.bitLength-this.index}},{key:"skipBits",value:function(t){if(this.bitsAvailable<t)return!1;this.index+=t}},{key:"readBits",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this.getBits(t,this.index,n);return r}},{key:"getBits",value:function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(this.bitsAvailable<t)return 0;var s=n%8,e=this.data[n/8|0]&255>>>s,o=8-s;if(o>=t)return r&&(this.index+=t),e>>o-t;r&&(this.index+=o);var m=t-o;return e<<m|this.getBits(m,n+o,r)}},{key:"skipLZ",value:function(){var t;for(t=0;t<this.bitLength-this.index;++t)if(this.getBits(1,this.index+t,!1)!==0)return this.index+=t,t;return t}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var t=this.skipLZ();return this.readBits(t+1)-1}},{key:"readEG",value:function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}},{key:"readBoolean",value:function(){return this.readBits(1)===1}},{key:"readUByte",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return this.readBits(t*8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}}]),a})(),j=(function(){function a(){C(this,a)}return O(a,null,[{key:"extractNALu",value:function(t){for(var n=0,r=t.byteLength,s=[],e=0,o=0;n<r;){var m=t[n++];if(m===0)o++;else if(m===1&&o>=2){var x=o+1;e!==n-x&&s.push(t.subarray(e,n-x)),e=n,o=0}else o=0}var $=null;return e<r&&($=t.subarray(e,r)),[s,$]}},{key:"skipScalingList",value:function(t,n){for(var r=8,s=8,e,o=0;o<n;o++)s!==0&&(e=t.readEG(),s=(r+e+256)%256),r=s===0?r:s}},{key:"readSPS",value:function(t){var n=new ee(t),r=0,s=0,e=0,o=0,m=1,x,$,N,H,Q,fe,$e=0;n.readUByte();for(var Ue=[],_e=1,Pe=t.byteLength,be=_e;be<Pe;be++)be+2<Pe&&n.readBits(24,!1)===3?(Ue.push(n.readBits(8)),Ue.push(n.readBits(8)),be+=2,n.readBits(8)):Ue.push(n.readBits(8));if(n.setData(new Uint8Array(Ue)),x=n.readUByte(),n.readBits(5),n.skipBits(3),n.readUByte(),n.skipUEG(),x===100||x===110||x===122||x===244||x===44||x===83||x===86||x===118||x===128){var Xe=n.readUEG();if(Xe===3&&n.skipBits(1),n.skipUEG(),n.skipUEG(),n.skipBits(1),n.readBoolean()){fe=Xe!==3?8:12;for(var Ie=0;Ie<fe;++Ie)n.readBoolean()&&(Ie<6?a.skipScalingList(n,16):a.skipScalingList(n,64))}}n.skipUEG();var Ge=n.readUEG();if(Ge===0)n.readUEG();else if(Ge===1){n.skipBits(1),n.skipEG(),n.skipEG(),$=n.readUEG();for(var Ne=0;Ne<$;++Ne)n.skipEG()}if(n.skipUEG(),n.skipBits(1),N=n.readUEG(),H=n.readUEG(),Q=n.readBits(1),Q===0&&n.skipBits(1),n.skipBits(1),n.readBoolean()&&(r=n.readUEG(),s=n.readUEG(),e=n.readUEG(),o=n.readUEG()),n.readBoolean()){if(n.readBoolean()){var ye,at=n.readUByte();switch(at){case 1:ye=[1,1];break;case 2:ye=[12,11];break;case 3:ye=[10,11];break;case 4:ye=[16,11];break;case 5:ye=[40,33];break;case 6:ye=[24,11];break;case 7:ye=[20,11];break;case 8:ye=[32,11];break;case 9:ye=[80,33];break;case 10:ye=[18,11];break;case 11:ye=[15,11];break;case 12:ye=[64,33];break;case 13:ye=[160,99];break;case 14:ye=[4,3];break;case 15:ye=[3,2];break;case 16:ye=[2,1];break;case 255:{ye=[n.readUByte()<<8|n.readUByte(),n.readUByte()<<8|n.readUByte()];break}}ye&&ye[0]>0&&ye[1]>0&&(m=ye[0]/ye[1])}if(n.readBoolean()&&n.skipBits(1),n.readBoolean()&&(n.skipBits(4),n.readBoolean()&&n.skipBits(24)),n.readBoolean()&&(n.skipUEG(),n.skipUEG()),n.readBoolean()){var ot=n.readUInt(),it=n.readUInt(),Ze=n.readBoolean(),st=it/(2*ot);Ze&&($e=st)}}return{fps:$e>0?$e:void 0,width:Math.ceil(((N+1)*16-r*2-s*2)*m),height:(2-Q)*(H+1)*16-(Q?2:4)*(e+o)}}}]),a})(),R=(function(){function a(u){C(this,a),this.payload=u,this.nri=(this.payload[0]&96)>>5,this.nalUnitType=this.payload[0]&31,this._sliceType=null,this._isFirstSlice=!1}return O(a,[{key:"toString",value:function(){return"".concat(a.TYPES[this.type()]||"UNKNOWN",": NRI: ").concat(this.getNri())}},{key:"getNri",value:function(){return this.nri}},{key:"type",value:function(){return this.nalUnitType}},{key:"isKeyframe",get:function(){return this.nalUnitType===a.IDR}},{key:"isVCL",get:function(){return this.nalUnitType==a.IDR||this.nalUnitType==a.NDR}},{key:"parseHeader",value:function(){var t=new ee(this.getPayload());t.readUByte(),this._isFirstSlice=t.readUEG()===0,this._sliceType=t.readUEG()}},{key:"isFirstSlice",get:function(){return this._isFirstSlice||this.parseHeader(),this._isFirstSlice}},{key:"sliceType",get:function(){return this._sliceType||this.parseHeader(),this._sliceType}},{key:"getPayload",value:function(){return this.payload}},{key:"getPayloadSize",value:function(){return this.payload.byteLength}},{key:"getSize",value:function(){return 4+this.getPayloadSize()}},{key:"getData",value:function(){var t=new Uint8Array(this.getSize()),n=new DataView(t.buffer);return n.setUint32(0,this.getSize()-4),t.set(this.getPayload(),4),t}}],[{key:"NDR",get:function(){return 1}},{key:"IDR",get:function(){return 5}},{key:"SEI",get:function(){return 6}},{key:"SPS",get:function(){return 7}},{key:"PPS",get:function(){return 8}},{key:"AUD",get:function(){return 9}},{key:"TYPES",get:function(){var t;return t={},L(t,a.IDR,"IDR"),L(t,a.SEI,"SEI"),L(t,a.SPS,"SPS"),L(t,a.PPS,"PPS"),L(t,a.NDR,"NDR"),L(t,a.AUD,"AUD"),t}}]),a})();function K(a,u){var t=new Uint8Array((a.byteLength|0)+(u.byteLength|0));return t.set(a,0),t.set(u,a.byteLength|0),t}function le(a){var u,t,n,r="";return u=Math.floor(a),t=parseInt(u/3600,10)%24,n=parseInt(u/60,10)%60,u=u<0?0:u%60,t>0&&(r+=(t<10?"0"+t:t)+":"),r+=(n<10?"0"+n:n)+":"+(u<10?"0"+u:u),r}var re=(function(a){B(t,a);var u=D(t);function t(n,r,s){var e;return C(this,t),e=u.call(this,"H264Remuxer"),e.frameDuration=s,e.readyToDecode=!1,e.nextDts=0,e.dts=0,e.mp4track={id:I.getTrackID(),type:"video",len:0,fragmented:!0,sps:"",pps:"",fps:30,width:0,height:0,timescale:n,duration:r,samples:[]},e.samples=[],e.remainingData=new Uint8Array,e.kfCounter=0,e.pendingUnits={},e}return O(t,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.mp4track.sps="",this.mp4track.pps="",this.nextDts=0,this.dts=0,this.remainingData=new Uint8Array,this.kfCounter=0,this.pendingUnits={}}},{key:"feed",value:function(r,s,e){var o=[],m;r=K(this.remainingData,r);var x=j.extractNALu(r),$=he(x,2);return o=$[0],m=$[1],this.remainingData=m||new Uint8Array,o.length>0?(this.remux(this.getVideoFrames(o,s,e)),!0):(ne("Failed to extract any NAL units from video data:",m),this.dispatch("outOfData"),!1)}},{key:"getVideoFrames",value:function(r,s,e){var o=this,m=[],x=[],$=0,N=0,H=!1,Q=!1;this.pendingUnits.units&&(m=this.pendingUnits.units,Q=this.pendingUnits.vcl,H=this.pendingUnits.keyFrame,this.pendingUnits={});var fe=v(r),$e;try{for(fe.s();!($e=fe.n()).done;){var Ue=$e.value,_e=new R(Ue);m.length&&Q&&(_e.isFirstSlice||!_e.isVCL)&&(x.push({units:m,keyFrame:H}),m=[],H=!1,Q=!1),m.push(_e),H=H||_e.isKeyframe,Q=Q||_e.isVCL}}catch(be){fe.e(be)}finally{fe.f()}if(m.length)if(!s)this.pendingUnits={units:m,keyFrame:H,vcl:Q};else if(Q)x.push({units:m,keyFrame:H});else{var Pe=x.length-1;Pe>=0&&(x[Pe].units=x[Pe].units.concat(m))}return $=s?s/x.length|0:this.frameDuration,N=s?s-$*x.length:0,x.map(function(be){be.duration=$,be.compositionTimeOffset=e,N>0&&(be.duration++,N--),o.kfCounter++,be.keyFrame&&o.dispatch("keyframePosition",o.kfCounter*$/1e3)}),se("jmuxer: No. of H264 frames of the last chunk: ".concat(x.length)),x}},{key:"remux",value:function(r){var s=v(r),e;try{for(s.s();!(e=s.n()).done;){var o=e.value,m=[],x=0,$=v(o.units),N;try{for($.s();!(N=$.n()).done;){var H=N.value;this.parseNAL(H)&&(m.push(H),x+=H.getSize())}}catch(Q){$.e(Q)}finally{$.f()}m.length>0&&this.readyToDecode&&(this.mp4track.len+=x,this.samples.push({units:m,size:x,keyFrame:o.keyFrame,duration:o.duration,compositionTimeOffset:o.compositionTimeOffset}))}}catch(Q){s.e(Q)}finally{s.f()}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var r=new Uint8Array(this.mp4track.len),s=0,e=this.mp4track.samples,o,m;for(this.dts=this.nextDts;this.samples.length;){var x=this.samples.shift(),$=x.units;if(m=x.duration,m<=0){se("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(m)),this.mp4track.len-=x.size;continue}this.nextDts+=m,o={size:x.size,duration:m,cts:x.compositionTimeOffset||0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,isNonSync:x.keyFrame?0:1,dependsOn:x.keyFrame?2:1}};var N=v($),H;try{for(N.s();!(H=N.n()).done;){var Q=H.value;r.set(Q.getData(),s),s+=Q.getSize()}}catch(fe){N.e(fe)}finally{N.f()}e.push(o)}return e.length?new Uint8Array(r.buffer,0,this.mp4track.len):null}},{key:"parseSPS",value:function(r){var s=j.readSPS(new Uint8Array(r));this.mp4track.fps=s.fps||this.mp4track.fps,this.mp4track.width=s.width,this.mp4track.height=s.height,this.mp4track.sps=[new Uint8Array(r)],this.mp4track.codec="avc1.";for(var e=new DataView(r.buffer,r.byteOffset+1,4),o=0;o<3;++o){var m=e.getUint8(o).toString(16);m.length<2&&(m="0"+m),this.mp4track.codec+=m}}},{key:"parsePPS",value:function(r){this.mp4track.pps=[new Uint8Array(r)]}},{key:"parseNAL",value:function(r){if(!r)return!1;if(r.isVCL)return!0;var s=!1;switch(r.type()){case R.PPS:this.mp4track.pps||this.parsePPS(r.getPayload()),s=!0;break;case R.SPS:this.mp4track.sps||this.parseSPS(r.getPayload()),s=!0;break;case R.AUD:se("AUD - ignoing");break;case R.SEI:se("SEI - ignoing");break}return!this.readyToDecode&&this.mp4track.pps&&this.mp4track.sps&&(this.readyToDecode=!0),s}}]),t})(I),Ae=(function(){function a(){C(this,a)}return O(a,null,[{key:"extractNALu",value:function(t){for(var n=0,r=t.byteLength,s=[],e=0,o=0;n<r;){var m=t[n++];if(m===0)o++;else if(m===1&&o>=2){var x=o+1;e!==n-x&&s.push(t.subarray(e,n-x)),e=n,o=0}else o=0}var $=null;return e<r&&($=t.subarray(e,r)),[s,$]}},{key:"removeEmulationPreventionBytes",value:function(t){for(var n=[],r=0,s=0;s<t.length;s++){var e=t[s];if(r===2&&e===3){r=0;continue}n.push(e),e===0?r++:r=0}return new Uint8Array(n)}},{key:"readSPS",value:function(t){var n=new ee(t);n.readUByte(),n.readUByte(),n.readBits(4),n.readBits(3),n.readBits(1);for(var r=n.readBits(2),s=n.readBits(1),e=n.readBits(5),o=n.readUInt(),m=new Uint8Array(6),x=0;x<6;x++)m[x]=n.readUByte();var $=n.readUByte();n.readUEG();var N=n.readUEG();N===3&&n.readBits(1);var H=n.readUEG(),Q=n.readUEG(),fe=n.readBoolean(),$e=0,Ue=0,_e=0,Pe=0;fe&&($e=n.readUEG(),Ue=n.readUEG(),_e=n.readUEG(),Pe=n.readUEG());var be=null,Xe=n.readBoolean();if(Xe){var Ie=n.readBoolean();if(Ie){var Ge=n.readUByte();Ge===255&&(n.readUShort(),n.readUShort())}var Ne=n.readBoolean();Ne&&n.readBoolean();var ye=n.readBoolean();if(ye){n.readBits(3),n.readBoolean();var at=n.readBoolean();at&&(n.readUByte(),n.readUByte(),n.readUByte())}var ot=n.readBoolean();ot&&(n.readUEG(),n.readUEG()),n.readBoolean(),n.readBoolean(),n.readBoolean();var it=n.readBoolean();if(it){var Ze=n.readUInt(),st=n.readUInt();n.readBoolean(),Ze&&(be=st/(2*Ze))}}var Xt=N===1||N===2?2:1,Gt=N===1?2:1,Yt=H-Xt*(Ue+$e),Wt=Q-Gt*(_e+Pe);return{width:Yt,height:Wt,profile_space:r,tier_flag:s,profile_idc:e,profile_compatibility_flags:o,constraint_indicator_flags:m,level_idc:$,chroma_format_idc:N,fps:be}}}]),a})(),we=(function(){function a(u){C(this,a),this.payload=u,this.nalUnitType=(u[0]&126)>>1,this.nuhLayerId=(u[0]&1)<<5|(u[1]&248)>>3,this.nuhTemporalIdPlus1=u[1]&7,this._isFirstSlice=null,this._sliceType=null}return O(a,[{key:"toString",value:function(){return"".concat(a.TYPES[this.type()]||"UNKNOWN ("+this.type()+")",": Layer: ").concat(this.nuhLayerId,", Temporal Id: ").concat(this.nuhTemporalIdPlus1)}},{key:"type",value:function(){return this.nalUnitType}},{key:"isKeyframe",get:function(){return[a.IDR_W_RADL,a.IDR_N_LP,a.CRA].includes(this.nalUnitType)}},{key:"isVCL",get:function(){return this.nalUnitType<=31}},{key:"parseHeader",value:function(){var t=new ee(this.getPayload());t.readUByte(),t.readUByte(),this._isFirstSlice=t.readBoolean(),this.isKeyframe&&t.readBits(1),t.readUEG(),this._sliceType=t.readUEG()}},{key:"isFirstSlice",get:function(){return this._isFirstSlice||this.parseHeader(),this._isFirstSlice}},{key:"sliceType",get:function(){return this._sliceType||this.parseHeader(),this._sliceType}},{key:"getPayload",value:function(){return this.payload}},{key:"getPayloadSize",value:function(){return this.payload.byteLength}},{key:"getSize",value:function(){return 4+this.getPayloadSize()}},{key:"getData",value:function(){var t=new Uint8Array(this.getSize()),n=new DataView(t.buffer);return n.setUint32(0,this.getSize()-4),t.set(this.getPayload(),4),t}}],[{key:"TRAIL_N",get:function(){return 0}},{key:"TRAIL_R",get:function(){return 1}},{key:"IDR_W_RADL",get:function(){return 19}},{key:"IDR_N_LP",get:function(){return 20}},{key:"CRA",get:function(){return 21}},{key:"VPS",get:function(){return 32}},{key:"SPS",get:function(){return 33}},{key:"PPS",get:function(){return 34}},{key:"AUD",get:function(){return 35}},{key:"SEI",get:function(){return 39}},{key:"SEI2",get:function(){return 40}},{key:"TYPES",get:function(){var t;return t={},L(t,a.TRAIL_N,"TRAIL_N"),L(t,a.TRAIL_R,"TRAIL_R"),L(t,a.IDR_W_RADL,"IDR"),L(t,a.IDR_N_LP,"IDR2"),L(t,a.CRA,"CRA"),L(t,a.VPS,"VPS"),L(t,a.SPS,"SPS"),L(t,a.PPS,"PPS"),L(t,a.AUD,"AUD"),L(t,a.SEI,"SEI"),L(t,a.SEI2,"SEI2"),t}}]),a})(),Re=(function(a){B(t,a);var u=D(t);function t(n,r,s){var e;return C(this,t),e=u.call(this,"H264Remuxer"),e.frameDuration=s,e.readyToDecode=!1,e.nextDts=0,e.dts=0,e.mp4track={id:I.getTrackID(),type:"video",len:0,fragmented:!0,vps:"",sps:"",pps:"",hvcC:{},fps:30,width:0,height:0,timescale:n,duration:r,samples:[]},e.samples=[],e.remainingData=new Uint8Array,e.kfCounter=0,e.pendingUnits={},e}return O(t,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.mp4track.vps="",this.mp4track.sps="",this.mp4track.pps="",this.mp4track.hvcC={},this.nextDts=0,this.dts=0,this.remainingData=new Uint8Array,this.kfCounter=0,this.pendingUnits={}}},{key:"feed",value:function(r,s,e){var o=[],m;r=K(this.remainingData,r);var x=Ae.extractNALu(r),$=he(x,2);return o=$[0],m=$[1],this.remainingData=m||new Uint8Array,o.length>0?(this.remux(this.getVideoFrames(o,s,e)),!0):(ne("Failed to extract any NAL units from video data:",m),this.dispatch("outOfData"),!1)}},{key:"getVideoFrames",value:function(r,s,e){var o=this,m=[],x=[],$=0,N=0,H=!1,Q=!1;this.pendingUnits.units&&(m=this.pendingUnits.units,Q=this.pendingUnits.vcl,H=this.pendingUnits.keyFrame,this.pendingUnits={});var fe=v(r),$e;try{for(fe.s();!($e=fe.n()).done;){var Ue=$e.value,_e=new we(Ue);m.length&&Q&&(_e.isFirstSlice||!_e.isVCL)&&(x.push({units:m,keyFrame:H}),m=[],H=!1,Q=!1),m.push(_e),H=H||_e.isKeyframe,Q=Q||_e.isVCL}}catch(be){fe.e(be)}finally{fe.f()}if(m.length)if(!s)this.pendingUnits={units:m,keyFrame:H,vcl:Q};else if(Q)x.push({units:m,keyFrame:H});else{var Pe=x.length-1;Pe>=0&&(x[Pe].units=x[Pe].units.concat(m))}return $=s?s/x.length|0:this.frameDuration,N=s?s-$*x.length:0,x.map(function(be){be.duration=$,be.compositionTimeOffset=e,N>0&&(be.duration++,N--),o.kfCounter++,be.keyFrame&&o.dispatch("keyframePosition",o.kfCounter*$/1e3)}),se("jmuxer: No. of H265 frames of the last chunk: ".concat(x.length)),x}},{key:"remux",value:function(r){var s=v(r),e;try{for(s.s();!(e=s.n()).done;){var o=e.value,m=[],x=0,$=v(o.units),N;try{for($.s();!(N=$.n()).done;){var H=N.value;this.parseNAL(H)&&(m.push(H),x+=H.getSize())}}catch(Q){$.e(Q)}finally{$.f()}m.length>0&&this.readyToDecode&&(this.mp4track.len+=x,this.samples.push({units:m,size:x,keyFrame:o.keyFrame,duration:o.duration,compositionTimeOffset:o.compositionTimeOffset}))}}catch(Q){s.e(Q)}finally{s.f()}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var r=new Uint8Array(this.mp4track.len),s=0,e=this.mp4track.samples,o,m;for(this.dts=this.nextDts;this.samples.length;){var x=this.samples.shift(),$=x.units;if(m=x.duration,m<=0){se("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(m)),this.mp4track.len-=x.size;continue}this.nextDts+=m,o={size:x.size,duration:m,cts:x.compositionTimeOffset||0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,isNonSync:x.keyFrame?0:1,dependsOn:x.keyFrame?2:1}};var N=v($),H;try{for(N.s();!(H=N.n()).done;){var Q=H.value;r.set(Q.getData(),s),s+=Q.getSize()}}catch(fe){N.e(fe)}finally{N.f()}e.push(o)}return e.length?new Uint8Array(r.buffer,0,this.mp4track.len):null}},{key:"parseSPS",value:function(r){this.mp4track.sps=[new Uint8Array(r)],r=Ae.removeEmulationPreventionBytes(r);var s=Ae.readSPS(new Uint8Array(r));this.mp4track.fps=s.fps||this.mp4track.fps,this.mp4track.width=s.width,this.mp4track.height=s.height,this.mp4track.codec="hvc1.".concat(s.profile_idc,".").concat(s.profile_compatibility_flags.toString(16))+".L".concat(s.level_idc).concat(s.tier_flag?"H":"L")+".".concat(s.constraint_indicator_flags.map(function(e){return e.toString(16)}).join(".").toUpperCase()),this.mp4track.hvcC={profile_space:s.profile_space,tier_flag:s.tier_flag,profile_idc:s.profile_idc,profile_compatibility_flags:s.profile_compatibility_flags,constraint_indicator_flags:s.constraint_indicator_flags,level_idc:s.level_idc,chroma_format_idc:s.chroma_format_idc}}},{key:"parsePPS",value:function(r){this.mp4track.pps=[r]}},{key:"parseVPS",value:function(r){this.mp4track.vps=[r]}},{key:"parseNAL",value:function(r){if(!r)return!1;if(r.isVCL)return!0;var s=!1;switch(r.type()){case we.VPS:this.mp4track.vps||this.parseVPS(r.getPayload()),s=!0;break;case we.SPS:this.mp4track.sps||this.parseSPS(r.getPayload()),s=!0;break;case we.PPS:this.mp4track.pps||this.parsePPS(r.getPayload()),s=!0;break;case we.AUD:se("AUD - ignoing");break;case we.SEI:case we.SEI2:se("SEI - ignoing");break}return!this.readyToDecode&&this.mp4track.vps&&this.mp4track.sps&&this.mp4track.pps&&(this.readyToDecode=!0),s}}]),t})(I),Ee=(function(a){B(t,a);var u=D(t);function t(n,r,s,e){var o;return C(this,t),o=u.call(this,"remuxer"),o.videoCodec=s,o.frameDuration=e,o.initialized=!1,o.tracks={},o.seq=1,o.env=n,o.timescale=1e3,o.mediaDuration=r?4294967295:0,o}return O(t,[{key:"addTrack",value:function(r){var s=this;if((r==="video"||r==="both")&&(this.videoCodec=="H265"?this.tracks.video=new Re(this.timescale,this.mediaDuration,this.frameDuration):this.tracks.video=new re(this.timescale,this.mediaDuration,this.frameDuration),this.tracks.video.on("outOfData",function(){s.dispatch("missingVideoFrames")}),this.tracks.video.on("keyframePosition",function(o){s.dispatch("keyframePosition",o)})),r==="audio"||r==="both"){var e=new Y(this.timescale,this.mediaDuration,this.frameDuration);this.tracks.audio=e,this.tracks.video.on("outOfData",function(){s.dispatch("missingAudioFrames")})}}},{key:"reset",value:function(){for(var r in this.tracks)this.tracks[r].resetTrack();this.initialized=!1}},{key:"destroy",value:function(){this.tracks={},this.offAll()}},{key:"flush",value:function(){if(!this.initialized){if(!this.isReady())return;this.dispatch("ready"),this.initSegment(),this.initialized=!0}for(var r in this.tracks){var s=this.tracks[r],e=s.getPayload();if(e&&e.byteLength){var o=W.moof(this.seq,s.dts,s.mp4track),m=W.mdat(e),x=K(o,m),$={type:r,payload:x,dts:s.dts};r==="video"&&($.fps=s.mp4track.fps),this.dispatch("buffer",$);var N=le(s.dts/this.timescale);se("put segment (".concat(r,"): dts: ").concat(s.dts," frames: ").concat(s.mp4track.samples.length," second: ").concat(N)),s.flush(),this.seq++}}}},{key:"initSegment",value:function(){var r=[];for(var s in this.tracks){var e=this.tracks[s];if(this.env=="browser"){var o={type:s,payload:W.initSegment([e.mp4track],this.mediaDuration,this.timescale)};this.dispatch("buffer",o)}else r.push(e.mp4track)}if(this.env=="node"){var m={type:"all",payload:W.initSegment(r,this.mediaDuration,this.timescale)};this.dispatch("buffer",m)}se("Initial segment generated.")}},{key:"isReady",value:function(){for(var r in this.tracks)if(!this.tracks[r].readyToDecode||!this.tracks[r].samples.length)return!1;return!0}},{key:"feed",value:function(r){var s=!1;if(r.video&&this.tracks.video&&(s|=this.tracks.video.feed(r.video,r.duration,r.compositionTimeOffset)),r.audio&&this.tracks.audio&&(s|=this.tracks.audio.feed(r.audio,r.duration)),!s){ne("Input object must have video and/or audio property. Make sure it is a valid typed array");return}this.flush()}}]),t})(T),He=(function(a){B(t,a);var u=D(t);function t(n,r){var s;return C(this,t),s=u.call(this,"buffer"),s.type=r,s.queue=new Uint8Array,s.cleaning=!1,s.pendingCleaning=0,s.cleanOffset=30,s.cleanRanges=[],s.sourceBuffer=n,s.sourceBuffer.addEventListener("updateend",function(){if(s.pendingCleaning>0&&(s.initCleanup(s.pendingCleaning),s.pendingCleaning=0),s.cleaning=!1,s.cleanRanges.length){s.doCleanup();return}}),s.sourceBuffer.addEventListener("error",function(){s.dispatch("error",{type:s.type,name:"buffer",error:"buffer error"})}),s}return O(t,[{key:"destroy",value:function(){this.queue=null,this.sourceBuffer=null,this.offAll()}},{key:"doCleanup",value:function(){if(!this.cleanRanges.length){this.cleaning=!1;return}var r=this.cleanRanges.shift();se("".concat(this.type," remove range [").concat(r[0]," - ").concat(r[1],")")),this.cleaning=!0,this.sourceBuffer.remove(r[0],r[1])}},{key:"initCleanup",value:function(r){try{if(this.sourceBuffer.updating){this.pendingCleaning=r;return}if(this.sourceBuffer.buffered&&this.sourceBuffer.buffered.length&&!this.cleaning){for(var s=0;s<this.sourceBuffer.buffered.length;++s){var e=this.sourceBuffer.buffered.start(s),o=this.sourceBuffer.buffered.end(s);r-e>this.cleanOffset&&(o=r-this.cleanOffset,e<o&&this.cleanRanges.push([e,o]))}this.doCleanup()}}catch(m){ne("Error occured while cleaning ".concat(this.type," buffer - ").concat(m.name,": ").concat(m.message))}}},{key:"doAppend",value:function(){if(this.queue.length&&!(!this.sourceBuffer||this.sourceBuffer.updating))try{this.sourceBuffer.appendBuffer(this.queue),this.queue=new Uint8Array}catch(s){var r="unexpectedError";s.name==="QuotaExceededError"?(se("".concat(this.type," buffer quota full")),r="QuotaExceeded"):(ne("Error occured while appending ".concat(this.type," buffer - ").concat(s.name,": ").concat(s.message)),r="InvalidStateError"),this.dispatch("error",{type:this.type,name:r,error:"buffer error"})}}},{key:"feed",value:function(r){this.queue=K(this.queue,r)}}]),t})(T),Ve=(function(a){B(t,a);var u=D(t);function t(n){var r;C(this,t),r=u.call(this,"jmuxer"),r.isReset=!1;var s={node:"",mode:"both",videoCodec:"H264",flushingTime:500,maxDelay:500,clearBuffer:!0,fps:30,readFpsFromTrack:!1,debug:!1,onReady:function(){},onData:function(){},onError:function(){},onUnsupportedCodec:function(){},onMissingVideoFrames:function(){},onMissingAudioFrames:function(){},onKeyframePosition:function(){},onLoggerLog:console.log,onLoggerErr:console.error};return r.options=Object.assign({},s,n),r.env=(typeof process>"u"?"undefined":A(process))==="object"&&typeof window>"u"?"node":"browser",r.options.debug&&Ce(r.options.onLoggerLog,r.options.onLoggerErr),r.options.fps||(r.options.fps=30),r.frameDuration=1e3/r.options.fps|0,r.remuxController=new Ee(r.env,n.live,r.options.videoCodec,r.frameDuration),r.remuxController.addTrack(r.options.mode),r.initData(),r.remuxController.on("buffer",r.onBuffer.bind(M(r))),r.env=="browser"&&(r.remuxController.on("ready",r.createBuffer.bind(M(r))),r.initBrowser()),r.remuxController.on("missingVideoFrames",function(){typeof r.options.onMissingVideoFrames=="function"&&r.options.onMissingVideoFrames.call(null)}),r.remuxController.on("missingAudioFrames",function(){typeof r.options.onMissingAudioFrames=="function"&&r.options.onMissingAudioFrames.call(null)}),r.clearBuffer&&r.remuxController.on("keyframePosition",function(e){r.kfPosition.push(e)}),typeof r.options.onKeyframePosition=="function"&&r.remuxController.on("keyframePosition",function(e){r.options.onKeyframePosition.call(null,e)}),r}return O(t,[{key:"initData",value:function(){this.lastCleaningTime=Date.now(),this.kfPosition=[],this.pendingUnits={},this.remainingData=new Uint8Array,this.startInterval()}},{key:"initBrowser",value:function(){typeof this.options.node=="string"&&this.options.node==""&&ne("no video element were found to render, provide a valid video element"),this.node=typeof this.options.node=="string"?document.getElementById(this.options.node):this.options.node,this.mseReady=!1,this.setupMSE()}},{key:"createStream",value:function(){var r=this.feed.bind(this),s=this.destroy.bind(this);return this.stream=new c.Duplex({writableObjectMode:!0,read:function(o){},write:function(o,m,x){r(o),x()},final:function(o){s(),o()}}),this.stream}},{key:"setupMSE",value:function(){if(window.MediaSource=window.MediaSource||window.WebKitMediaSource||window.ManagedMediaSource,!window.MediaSource)throw"Oops! Browser does not support Media Source Extension or Managed Media Source (IOS 17+).";if(this.isMSESupported=!!window.MediaSource,this.mediaSource=new window.MediaSource,this.url=URL.createObjectURL(this.mediaSource),window.MediaSource===window.ManagedMediaSource)try{this.node.removeAttribute("src"),this.node.disableRemotePlayback=!0;var r=document.createElement("source");r.type="video/mp4",r.src=this.url,this.node.appendChild(r),this.node.load()}catch{this.node.src=this.url}else this.node.src=this.url;this.mseEnded=!1,this.mediaSource.addEventListener("sourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("sourceclose",this.onMSEClose.bind(this)),this.mediaSource.addEventListener("webkitsourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("webkitsourceclose",this.onMSEClose.bind(this))}},{key:"endMSE",value:function(){if(!this.mseEnded)try{this.mseEnded=!0,this.mediaSource.endOfStream()}catch{ne("mediasource is not available to end")}}},{key:"feed",value:function(r){!r||!this.remuxController||(r.duration=r.duration?parseInt(r.duration):0,this.remuxController.feed(r))}},{key:"destroy",value:function(){if(this.stopInterval(),this.stream&&(this.remuxController.flush(),this.stream.push(null),this.stream=null),this.remuxController&&(this.remuxController.destroy(),this.remuxController=null),this.bufferControllers){for(var r in this.bufferControllers)this.bufferControllers[r].destroy();this.bufferControllers=null,this.endMSE()}this.node=!1,this.mseReady=!1,this.videoStarted=!1,this.mediaSource=null}},{key:"reset",value:function(){if(this.stopInterval(),this.isReset=!0,this.node.pause(),this.remuxController&&this.remuxController.reset(),this.bufferControllers){for(var r in this.bufferControllers)this.bufferControllers[r].destroy();this.bufferControllers=null,this.endMSE()}this.initData(),this.env=="browser"&&this.initBrowser(),se("JMuxer was reset")}},{key:"createBuffer",value:function(){if(!(!this.mseReady||!this.remuxController||!this.remuxController.isReady()||this.bufferControllers)){this.bufferControllers={};for(var r in this.remuxController.tracks){var s=this.remuxController.tracks[r];if(!t.isSupported("".concat(r,'/mp4; codecs="').concat(s.mp4track.codec,'"')))return ne("Browser does not support codec: ".concat(r,'/mp4; codecs="').concat(s.mp4track.codec,'"')),typeof this.options.onUnsupportedCodec=="function"&&this.options.onUnsupportedCodec.call(null,s.mp4track.codec),!1;var e=this.mediaSource.addSourceBuffer("".concat(r,'/mp4; codecs="').concat(s.mp4track.codec,'"'));this.bufferControllers[r]=new He(e,r),this.bufferControllers[r].on("error",this.onBufferError.bind(this))}}}},{key:"startInterval",value:function(){var r=this;this.interval=setInterval(function(){r.options.flushingTime?r.applyAndClearBuffer():r.bufferControllers&&r.cancelDelay()},this.options.flushingTime||1e3)}},{key:"stopInterval",value:function(){this.interval&&clearInterval(this.interval)}},{key:"cancelDelay",value:function(){if(this.node.buffered&&this.node.buffered.length>0&&!this.node.seeking){var r=this.node.buffered.end(0);r-this.node.currentTime>this.options.maxDelay/1e3&&(se("delay"),this.node.paused&&this.node.play().catch(ne),this.node.currentTime=r-.001)}}},{key:"releaseBuffer",value:function(){for(var r in this.bufferControllers)this.bufferControllers[r].doAppend()}},{key:"applyAndClearBuffer",value:function(){this.bufferControllers&&(this.releaseBuffer(),this.clearBuffer())}},{key:"getSafeClearOffsetOfBuffer",value:function(r){for(var s=this.options.mode==="audio"&&r||0,e,o=0;o<this.kfPosition.length&&!(this.kfPosition[o]>=r);o++)e=this.kfPosition[o];return e&&(this.kfPosition=this.kfPosition.filter(function(m){return m<e&&(s=m),m>=e})),s}},{key:"clearBuffer",value:function(){if(this.options.clearBuffer&&Date.now()-this.lastCleaningTime>1e4){for(var r in this.bufferControllers){var s=this.getSafeClearOffsetOfBuffer(this.node.currentTime);this.bufferControllers[r].initCleanup(s)}this.lastCleaningTime=Date.now()}}},{key:"onBuffer",value:function(r){this.options.readFpsFromTrack&&typeof r.fps<"u"&&this.options.fps!=r.fps&&(this.options.fps=r.fps,this.frameDuration=Math.ceil(1e3/r.fps),se("JMuxer changed FPS to ".concat(r.fps," from track data"))),this.env=="browser"?this.bufferControllers&&this.bufferControllers[r.type]&&this.bufferControllers[r.type].feed(r.payload):this.stream&&this.stream.push(r.payload),this.options.onData&&this.options.onData(r.payload),this.options.flushingTime===0&&this.applyAndClearBuffer()}},{key:"onMSEOpen",value:function(){this.mseReady=!0,URL.revokeObjectURL(this.url),typeof this.options.onReady=="function"&&this.options.onReady.call(null,this.isReset)}},{key:"onMSEClose",value:function(){this.mseReady=!1,this.videoStarted=!1}},{key:"onBufferError",value:function(r){if(r.name=="QuotaExceeded"){se("JMuxer cleaning ".concat(r.type," buffer due to QuotaExceeded error")),this.bufferControllers[r.type].initCleanup(this.node.currentTime);return}else r.name=="InvalidStateError"?(se("JMuxer is reseting due to InvalidStateError"),this.reset()):this.endMSE();typeof this.options.onError=="function"&&this.options.onError.call(null,r)}}],[{key:"isSupported",value:function(r){return window.MediaSource&&window.MediaSource.isTypeSupported(r)}}]),t})(T);return Ve}))})(Qe)),Qe.exports}var Sr=br();const Cr=mr(Sr);function _r(i){const{platform:f,serial:c,videoRef:h}=i,y=V(!1),g=V(!1),M=V(null);let C=null,S=null,O=null;const v=3e3;function D(){if(!h.value){const U="Video element not ready";return M.value=U,console.error("[Scrcpy]",U),!1}try{return console.log("[Scrcpy] Initializing JMuxer for video element:",h.value),S=new Cr({node:h.value,mode:"video",flushingTime:0,fps:30,debug:!1}),console.log("[Scrcpy] JMuxer initialized successfully"),!0}catch(U){const b=`JMuxer init failed: ${U instanceof Error?U.message:String(U)}`;return M.value=b,console.error("[Scrcpy]",b,U),!1}}function L(){if(C&&C.readyState===WebSocket.OPEN){console.warn("[Scrcpy] WebSocket already connected");return}if(!h.value){console.warn("[Scrcpy] Video element not available, cannot connect");return}if(!(!S&&!D()))try{const b=`${location.protocol==="https:"?"wss:":"ws:"}//${location.host}/ws/${f.value}/scrcpy/${c.value}`;console.log(`[Scrcpy] Connecting to ${b}`),C=new WebSocket(b),C.binaryType="arraybuffer",C.onopen=()=>{y.value=!0,g.value=!1,M.value=null,console.log("[Scrcpy] Connected"),O&&(clearTimeout(O),O=null)},C.onmessage=w=>{if(w.data instanceof ArrayBuffer){if(S&&w.data.byteLength>0)try{S.feed({video:new Uint8Array(w.data)})}catch(J){console.error("[Scrcpy] JMuxer feed error:",J)}}else try{const J=JSON.parse(w.data);console.log("[Scrcpy] Control message:",J)}catch{console.warn("[Scrcpy] Invalid message:",w.data)}},C.onerror=w=>{const J="WebSocket connection error";console.error("[Scrcpy]",J,w),console.error("[Scrcpy] WebSocket URL was:",b),console.error("[Scrcpy] WebSocket readyState:",C?.readyState),M.value=J},C.onclose=()=>{y.value=!1,console.log("[Scrcpy] Disconnected"),!g.value&&h.value&&(g.value=!0,console.log(`[Scrcpy] Reconnecting in ${v}ms...`),O=setTimeout(()=>{L()},v))}}catch(U){M.value=`WebSocket init failed: ${U instanceof Error?U.message:String(U)}`,console.error("[Scrcpy] Connection error:",U)}}function X(){if(g.value=!1,O&&(clearTimeout(O),O=null),C&&(C.close(),C=null),S){try{S.destroy()}catch(U){console.warn("[Scrcpy] JMuxer destroy error:",U)}S=null}y.value=!1,M.value=null,console.log("[Scrcpy] Disconnected and cleaned up")}function B(U,b,w,J,de){if(!C||C.readyState!==WebSocket.OPEN){console.warn("[Scrcpy] WebSocket not connected");return}const me=b/J,ge=w/de,ve=JSON.stringify({type:U==="down"?"touchDown":U==="move"?"touchMove":"touchUp",xP:me,yP:ge});C.send(ve)}return dt(()=>{X()}),{connected:y,reconnecting:g,error:M,connect:L,disconnect:X,sendTouch:B}}const Pr={class:"screen-panel",ref:"containerRef"},Ar={class:"mode-selector"},Tr={class:"info-display"},$r={class:"canvas-container"},Fr={class:"canvas-wrapper"},Dr=["src"],Ur=ie({__name:"ScreenPanel",props:{platform:{},serial:{},screenSize:{}},emits:["tap","recordTap","recordSwipe"],setup(i,{expose:f,emit:c}){const h=i,{platform:y,serial:g}=Kt(h),M=c,C=Je(),S=nt(),O=Ke(),v=ce(()=>O.t.screen),D=V("default"),L=V({x:0,y:0}),X=V(!1),B=V([]),U=ce(()=>D.value==="pointer"),b=V(null),w=V(null),{canvasRef:J,addRect:de,addTrack:me,clearShapes:ge,clearShapesByType:he,resizeCanvas:ve}=vr(),E=_r({platform:y,serial:g,videoRef:w}),P=ce(()=>S.screenshotUrl),A=ce(()=>({width:h.screenSize?.width||S.screenSize?.width||0,height:h.screenSize?.height||S.screenSize?.height||0})),G=ce(()=>{const j=A.value.width,R=A.value.height;return!j||!R?{x:0,y:0}:{x:Math.round(L.value.x/j*100),y:Math.round(L.value.y/R*100)}});function te(){if(!b.value)return;const j=b.value.naturalWidth,R=b.value.naturalHeight;ve(j,R)}function ue(){C.error("截图加载失败")}function Ce(){if(!w.value)return;const j=w.value.videoWidth||A.value.width,R=w.value.videoHeight||A.value.height;ve(j,R),E&&!E.connected.value&&E.connect()}Le(()=>D.value,j=>{j==="pointer"&&(S.selectNode(null),he("select"),he("hover"))}),Le(()=>U.value,async(j,R)=>{if(R===void 0&&!j){console.log("[ScreenPanel] Initial state: Screenshot mode");return}j?(console.log("[ScreenPanel] Switching to Scrcpy mode, waiting for video element..."),await lt(),console.log("[ScreenPanel] Video element ready, connecting..."),E.connect()):(console.log("[ScreenPanel] Switching to Screenshot mode, disconnecting..."),E.disconnect())}),Le(w,j=>{j&&U.value&&j.addEventListener("loadedmetadata",Ce)},{immediate:!0}),dt(()=>{E.disconnect()});function se(j){const R=b.value||w.value;if(!R)return null;const K=R.getBoundingClientRect(),{width:le,height:re}=A.value;if(!le||!re)return null;const Ae=le/K.width,we=re/K.height,Re=Math.round((j.clientX-K.left)*Ae),Ee=Math.round((j.clientY-K.top)*we);return{x:Re,y:Ee}}function ne(j){if(!J.value)return null;const R=J.value.getBoundingClientRect(),K=J.value.width/R.width,le=J.value.height/R.height,re=(j.clientX-R.left)*K,Ae=(j.clientY-R.top)*le;return{x:re,y:Ae}}function T(j){if(!J.value)return null;const{width:R,height:K}=A.value;if(!R||!K)return null;const le=R/J.value.width,re=K/J.value.height,Ae=Math.round(j.x*le),we=Math.round(j.y*re);return{x:Ae,y:we}}function W(j,R){if(!S.hierarchy?.nodes)return null;const K=[];function le(we){we.forEach(Re=>{K.push(Re),Re.children&&le(Re.children)})}le(S.hierarchy.nodes);let re=null,Ae=1/0;for(const we of K){if(!we.bounds)continue;const[Re,Ee,He,Ve]=we.bounds;if(j>=Re&&j<=He&&R>=Ee&&R<=Ve){const a=(He-Re)*(Ve-Ee);a<Ae&&(Ae=a,re=we)}}return re}function Z(j){const R=se(j),K=ne(j);if(!(!R||!K)){if(L.value=R,he("hover"),D.value==="default"){const le=W(R.x,R.y);le&&le.bounds&&de(le.bounds,"hover")}else if(D.value==="pointer"&&X.value&&(B.value.push(K),he("hover"),me(B.value),U.value)){const{width:le,height:re}=A.value;le&&re&&E.sendTouch("move",R.x,R.y,le,re)}}}function xe(j){const R=se(j);if(R&&(X.value=!0,B.value=[],D.value==="pointer")){const K=ne(j);if(K&&B.value.push(K),U.value){const{width:le,height:re}=A.value;le&&re&&E.sendTouch("down",R.x,R.y,le,re)}}}function I(){if(B.value.length<2)return null;const j=B.value[0],R=B.value[B.value.length-1],K=T(j),le=T(R);if(!K||!le)return null;const re=Math.max(.2,Math.min(1,B.value.length/60));return{startX:K.x,startY:K.y,endX:le.x,endY:le.y,duration:re}}async function Y(j){const R=se(j);if(R){if(X.value=!1,D.value==="default"){const K=W(R.x,R.y);K&&(S.selectNode(K),he("select"),K.bounds&&de(K.bounds,"select"))}else if(D.value==="pointer")try{M("tap",R.x,R.y);const K=null,le=B.value.length>5;if(U.value){const{width:re,height:Ae}=A.value;re&&Ae&&E.sendTouch("up",R.x,R.y,re,Ae);const we=le?I():null;we?M("recordSwipe",we.startX,we.startY,we.endX,we.endY,we.duration,K):M("recordTap",R.x,R.y,K)}else{const re=le?I():null;re?(await Te(h.platform,h.serial,"swipe",{startX:re.startX,startY:re.startY,endX:re.endX,endY:re.endY,duration:re.duration}),M("recordSwipe",re.startX,re.startY,re.endX,re.endY,re.duration,K),C.success(`滑动: (${re.startX}, ${re.startY}) → (${re.endX}, ${re.endY})`)):(await ft(h.platform,h.serial,R.x,R.y),M("recordTap",R.x,R.y,K),C.success(`点击: (${R.x}, ${R.y})`))}}catch(K){C.error(`操作失败: ${K instanceof Error?K.message:String(K)}`)}B.value=[],he("hover")}}function ee(){if(X.value&&D.value==="pointer"&&U.value){const j=B.value[B.value.length-1];if(j){const R=T(j),{width:K,height:le}=A.value;R&&K&&le&&E.sendTouch("up",R.x,R.y,K,le)}}X.value=!1,B.value=[],he("hover")}return Le(()=>S.selectedNode,j=>{he("select"),j&&j.bounds&&de(j.bounds,"select")}),f({clearShapes:ge,resizeCanvas:ve}),(j,R)=>(_(),z("div",Pr,[k("div",Ar,[d(l(Ut),{value:D.value,"onUpdate:value":R[0]||(R[0]=K=>D.value=K),size:"small"},{default:p(()=>[d(l(et),{value:"default"},{default:p(()=>[d(l(oe),null,{default:p(()=>[d(l(Tn))]),_:1}),q(" "+F(v.value.viewMode),1)]),_:1}),d(l(et),{value:"pointer"},{default:p(()=>[d(l(oe),null,{default:p(()=>[d(l(Fn))]),_:1}),q(" "+F(v.value.pointerMode),1)]),_:1})]),_:1},8,["value"]),k("div",Tr,[k("span",null,F(A.value.width)+"x"+F(A.value.height),1),k("span",null,F(L.value.x)+", "+F(L.value.y),1),k("span",null,F(G.value.x)+"%, "+F(G.value.y)+"%",1)])]),k("div",$r,[k("div",Fr,[U.value?(_(),z("video",{key:1,ref_key:"videoRef",ref:w,class:"screen-video",autoplay:"",muted:""},null,512)):(_(),z("img",{key:0,ref_key:"imageRef",ref:b,src:P.value,class:"screen-image",onLoad:te,onError:ue},null,40,Dr)),k("canvas",{ref_key:"drawingCanvas",ref:J,class:"drawing-canvas",onMousemove:Z,onMousedown:xe,onMouseup:Y,onMouseleave:ee},null,544)])])],512))}}),Rr=ze(Ur,[["__scopeId","data-v-a643562a"]]),Er={class:"hierarchy-panel"},Mr={class:"hierarchy-search-bar"},Br={key:0,class:"search-results-info"},Lr={key:1,class:"search-results-list"},Or=["onClick"],zr={class:"result-index"},Ir={class:"result-content"},Nr={class:"result-primary"},jr={class:"result-secondary"},Hr={key:0,class:"result-tag"},Vr={key:1,class:"result-tag"},Xr=ie({__name:"HierarchyPanel",props:{platform:{},serial:{}},setup(i){const f=i,c=Je(),h=nt(),y=Ke(),g=ce(()=>y.t.hierarchy),M=V(""),C=V([]),S=V(!1),O=V("text"),v=ce(()=>[{label:g.value.searchType.text,value:"text"},{label:g.value.searchType.xpath,value:"xpath"},{label:g.value.searchType.id,value:"id"},{label:g.value.searchType.className,value:"className"}]),D=V(new Map),L=V([]),X=V([]);function B(P,A=""){return P.map((G,te)=>{const ue=A?`${A}-${te}`:`${te}`;D.value.set(ue,G);const Ce=G.children&&G.children.length>0;return{key:ue,label:`${te} ${G.class_name||"Node"}`,prefix:()=>pe(oe,null,{default:()=>pe(Ce?Un:Cn)}),children:Ce?B(G.children,ue):void 0,isLeaf:!Ce,raw:G}})}function U({option:P}){const A=P.raw,G=(P.label||"").split(" ")[0],te=A.class_name||"Node",ue=[pe("span",{class:"tree-node-index"},`${G} `),pe("span",{class:"tree-node-class"},te)];if(A.resource_id){const Ce=A.resource_id.split("/").pop()||A.resource_id;ue.push(pe("span",{class:"tree-node-highlight"},` id=${Ce}`))}return A.text&&ue.push(pe("span",{class:"tree-node-highlight"},` text=${A.text}`)),pe("span",{},ue)}const b=ce(()=>h.hierarchy?.nodes?(D.value.clear(),B(h.hierarchy.nodes)):[]);async function w(){if(!M.value.trim()){c.warning(g.value.searchPlaceholder);return}S.value=!0;try{await h.refreshHierarchy();const P=M.value.trim(),A=await Te(f.platform,f.serial,"findElements",{by:O.value,value:P});if(A&&typeof A=="object"&&"value"in A){const G=A;C.value=G.value.map(bt),G.count===0?c.warning(g.value.noResults):G.count===1?me(C.value[0]):c.success(y.format(g.value.foundResults,{count:G.count}))}else Array.isArray(A)?(C.value=A.map(bt),A.length===1?me(C.value[0]):c.success(y.format(g.value.foundResults,{count:A.length}))):(C.value=[],c.warning(g.value.noResults))}catch(P){c.error(`${g.value.searchPlaceholder}: ${P instanceof Error?P.message:String(P)}`),C.value=[]}finally{S.value=!1}}function J(P,A,G=""){if(!P||P.length!==4)return null;for(let te=0;te<A.length;te++){const ue=A[te],Ce=G?`${G}-${te}`:`${te}`,se=ue?.raw;if(se?.bounds){const ne=se.bounds;if(ne[0]===P[0]&&ne[1]===P[1]&&ne[2]===P[2]&&ne[3]===P[3])return Ce}if(ue&&ue.children){const ne=J(P,ue.children,Ce);if(ne)return ne}}return null}function de(P){const A=P.split("-"),G=[];for(let te=1;te<A.length;te++)G.push(A.slice(0,te).join("-"));return G}async function me(P){await lt();const A=J(P.bounds,b.value);if(A){const G=de(A),te=new Set([...X.value,...G]);X.value=Array.from(te),L.value=[A];const ue=D.value.get(A);ue&&h.selectNode(ue),c.success("已选中并定位到元素")}else h.selectNode(P),c.warning("已选中元素，但无法在树中定位（可能需要刷新）")}function ge(){M.value="",C.value=[]}function he(P,A){const G=A[0];if(G&&G.raw){const te=G.raw;h.selectNode(te)}}function ve(P){X.value=P}const E=({option:P})=>({onDblclick(){if(!P.isLeaf){const A=P.key;X.value.includes(A)?X.value=X.value.filter(G=>G!==A):X.value=[...X.value,A]}}});return Le(()=>h.selectedNode,async P=>{if(!P){L.value=[];return}await lt();const A=J(P.bounds,b.value);if(A){const G=de(A),te=new Set([...X.value,...G]);X.value=Array.from(te),L.value=[A]}},{deep:!0}),(P,A)=>{const G=Me("n-select"),te=Me("n-button"),ue=Me("n-input"),Ce=Me("n-tree"),se=Me("n-empty");return _(),z("div",Er,[k("div",Mr,[d(G,{value:O.value,"onUpdate:value":A[0]||(A[0]=ne=>O.value=ne),options:v.value,size:"small",style:{width:"160px","flex-shrink":"0"}},null,8,["value","options"]),d(ue,{value:M.value,"onUpdate:value":A[1]||(A[1]=ne=>M.value=ne),placeholder:g.value.searchPlaceholder,clearable:"",onKeydown:Rt(w,["enter"]),style:{flex:"1"}},{suffix:p(()=>[d(te,{text:"",onClick:w,loading:S.value,disabled:!M.value.trim()},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(Jn))]),_:1})]),_:1},8,["loading","disabled"])]),_:1},8,["value","placeholder"])]),C.value.length>0?(_(),z("div",Br,[k("span",null,F(l(y).format(g.value.foundResults,{count:C.value.length})),1),d(te,{text:"",size:"small",onClick:ge},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(wn))]),_:1})]),default:p(()=>[q(" "+F(l(y).t.common.clear),1)]),_:1})])):ke("",!0),C.value.length>0?(_(),z("div",Lr,[(_(!0),z(Oe,null,We(C.value,(ne,T)=>(_(),z("div",{key:T,class:"search-result-item",onClick:W=>me(ne)},[k("div",zr,F(T+1),1),k("div",Ir,[k("div",Nr,F(ne.text||ne.resource_id||ne.class_name||`${g.value.noElement} ${T+1}`),1),k("div",jr,[ne.resource_id?(_(),z("span",Hr,F(ne.resource_id),1)):ke("",!0),ne.class_name?(_(),z("span",Vr,F(ne.class_name),1)):ke("",!0)])]),d(l(oe),{size:"16",color:"var(--md-primary)"},{default:p(()=>[d(l(It))]),_:1})],8,Or))),128))])):ke("",!0),b.value.length>0?(_(),Se(Ce,{key:2,data:b.value,"selected-keys":L.value,"expanded-keys":X.value,"node-props":E,"render-label":U,selectable:"","block-line":"","onUpdate:selectedKeys":he,"onUpdate:expandedKeys":ve},null,8,["data","selected-keys","expanded-keys"])):(_(),Se(se,{key:3,description:g.value.noElement},null,8,["description"]))])}}}),Gr=ze(Xr,[["__scopeId","data-v-913aa837"]]);function Yr(i){const f=Math.floor(i/1e3),c=Math.floor(f/60),h=f%60;return`${c.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`}function Ht(i){return i<1e3?`${i}ms`:`${(i/1e3).toFixed(1)}s`}function Wr(i){return i<1024?`${i}B`:i<1024*1024?`${(i/1024).toFixed(1)}KB`:`${(i/(1024*1024)).toFixed(1)}MB`}function Kr(i){const f=new Date(i*1e3),h=new Date().getTime()-f.getTime(),y=Math.floor(h/(1e3*60*60*24));return y===0?f.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):y===1?"昨天 "+f.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):y<7?`${y}天前`:f.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}function $t(i){return i?i.text?`文本: "${i.text}"`:i.content_desc?`描述: "${i.content_desc}"`:i.resource_id?`ID: ${i.resource_id.split("/").pop()}`:i.class_name?`类: ${i.class_name.split(".").pop()}`:null:null}function Vt(i){switch(i.type){case"tap":{const f=$t(i.element);return f||(i.xpath?`XPath元素 (${Math.round(i.coords.x)}, ${Math.round(i.coords.y)})`:`坐标 (${Math.round(i.coords.x)}, ${Math.round(i.coords.y)})`)}case"swipe":{const f=$t(i.element);return f?`${f} → (${Math.round(i.endCoords.x)}, ${Math.round(i.endCoords.y)})`:`(${Math.round(i.coords.x)}, ${Math.round(i.coords.y)}) → (${Math.round(i.endCoords.x)}, ${Math.round(i.endCoords.y)})`}case"input":return`"${i.params.text}"`;case"sleep":return`${i.params.duration}ms`;case"command":return i.params.command;default:return JSON.stringify(i.params)}}function xt(i){switch(i){case"tap":return"primary";case"swipe":return"success";case"input":return"warning";case"sleep":return"default";case"command":case"back":case"home":return"error";default:return"default"}}function qr(i){switch(i){case"idle":return"default";case"playing":return"success";case"paused":return"warning";case"completed":return"primary";case"error":return"error";default:return"default"}}function Jr(i){switch(i){case"idle":return"待播放";case"playing":return"播放中";case"paused":return"已暂停";case"completed":return"已完成";case"error":return"错误";default:return i}}const Zr={class:"tab-content"},Qr={class:"control-bar"},ea={key:0,class:"recording-indicator"},ta={class:"duration"},na={class:"steps-section"},ra={key:0,class:"steps-list"},aa={class:"step-index"},oa={class:"step-details"},ia={class:"step-time"},sa=ie({__name:"RecordTab",props:{recorder:{},currentPlaybackIndex:{},isPlaybackActive:{type:Boolean},t:{}},emits:["toggle-recording","toggle-pause","clear-recording","save-recording","edit-action","delete-action"],setup(i){return(f,c)=>(_(),z("div",Zr,[k("div",Qr,[d(l(je),{size:8},{default:p(()=>[d(l(ae),{type:i.recorder.isRecording.value?"error":"primary",disabled:i.isPlaybackActive,onClick:c[0]||(c[0]=h=>f.$emit("toggle-recording"))},{icon:p(()=>[d(l(oe),null,{default:p(()=>[i.recorder.isRecording.value?(_(),Se(l(ht),{key:1})):(_(),Se(l(ct),{key:0}))]),_:1})]),default:p(()=>[q(" "+F(i.recorder.isRecording.value?i.t.stopRecording:i.t.startRecording),1)]),_:1},8,["type","disabled"]),i.recorder.isRecording.value?(_(),Se(l(ae),{key:0,type:i.recorder.isPaused.value?"default":"warning",onClick:c[1]||(c[1]=h=>f.$emit("toggle-pause"))},{default:p(()=>[q(F(i.recorder.isPaused.value?i.t.continueRecording:i.t.pauseRecording),1)]),_:1},8,["type"])):ke("",!0),d(l(ae),{disabled:i.recorder.actionCount.value===0,onClick:c[2]||(c[2]=h=>f.$emit("clear-recording"))},{default:p(()=>[q(F(i.t.clearRecording)+" ("+F(i.recorder.actionCount.value)+") ",1)]),_:1},8,["disabled"])]),_:1}),d(l(je),{size:8},{default:p(()=>[d(l(ae),{disabled:i.recorder.actionCount.value===0,onClick:c[3]||(c[3]=h=>f.$emit("save-recording"))},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(Kn))]),_:1})]),default:p(()=>[q(" "+F(i.t.saveRecording),1)]),_:1},8,["disabled"])]),_:1})]),i.recorder.isRecording.value?(_(),z("div",ea,[d(l(qe),{type:i.recorder.isPaused.value?"warning":"error",round:""},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(ct))]),_:1})]),default:p(()=>[q(" "+F(i.recorder.isPaused.value?i.t.recordingPaused:i.t.recording),1)]),_:1},8,["type"]),k("span",ta,F(l(Yr)(i.recorder.duration.value)),1)])):ke("",!0),k("div",na,[k("h3",null,F(i.t.operationSteps)+" ("+F(i.recorder.actionCount.value)+")",1),i.recorder.actionCount.value>0?(_(),z("div",ra,[(_(!0),z(Oe,null,We(i.recorder.actions.value,(h,y)=>(_(),z("div",{key:h.id,class:Et(["step-item",{active:i.currentPlaybackIndex===y}])},[k("span",aa,F(Number(y)+1),1),d(l(qe),{type:l(xt)(h.type),size:"small"},{default:p(()=>[q(F(h.type),1)]),_:2},1032,["type"]),k("span",oa,F(l(Vt)(h)),1),k("span",ia,F(l(Ht)(h.relativeTime)),1),d(l(Mt),{size:"tiny"},{default:p(()=>[d(l(ae),{onClick:g=>f.$emit("edit-action",h)},{default:p(()=>[d(l(oe),null,{default:p(()=>[d(l(Nt))]),_:1})]),_:1},8,["onClick"]),d(l(ae),{onClick:g=>f.$emit("delete-action",h.id)},{default:p(()=>[d(l(oe),null,{default:p(()=>[d(l(vt))]),_:1})]),_:1},8,["onClick"])]),_:2},1024)],2))),128))])):(_(),Se(l(tt),{key:1,description:i.t.noOperations},null,8,["description"]))])]))}}),la=ze(sa,[["__scopeId","data-v-6ac11da4"]]),ca={class:"playback-tab-layout"},ua={class:"recordings-section"},da={class:"section-header"},fa={class:"playback-controls-divider"},pa={class:"control-bar"},ha={class:"progress-text"},va={key:0,class:"error-message-compact"},ma={class:"playback-steps-section"},xa={key:0,class:"steps-list"},ya={class:"step-index"},ga={class:"step-details"},wa={class:"step-time"},ka=ie({__name:"PlaybackTab",props:{player:{},recordings:{},loading:{type:Boolean},isRecordingActive:{type:Boolean},t:{},commonT:{}},emits:["refresh-recordings","start-playback","load-recording","edit-recording","delete-recording"],setup(i,{emit:f}){const c=i,h=f,y=ce(()=>{if(c.recordings.length===0)return[];const O=new Map;c.recordings.forEach(D=>{const L=D.group||"default",X=O.get(L);X?X.push(D):O.set(L,[D])});const v=[];return O.forEach((D,L)=>{const X={key:`group-${L}`,label:L,isGroup:!0,children:D.map(B=>({key:`${B.group}/${B.name}`,label:B.name,recording:B}))};v.push(X)}),v}),g=ce(()=>y.value.map(O=>O.key));function M({option:O}){const v=O;if(v.isGroup){const D=v.children?.length||0;return pe("span",{class:"tree-group-label"},[pe("span",{class:"group-name"},v.label),pe("span",{class:"group-count"},`(${D})`)])}else{const D=v.recording;return pe("div",{class:"tree-recording-label"},[pe("div",{class:"recording-name"},D.name),pe("div",{class:"recording-meta"},[pe("span",{class:"meta-item"},Wr(D.size)),pe("span",{class:"meta-item"},Kr(D.modified_at))])])}}function C({option:O}){const v=O;if(v.isGroup||!v.recording)return null;const D=v.recording;return pe("div",{class:"tree-node-actions",onClick:L=>L.stopPropagation()},[pe(ae,{size:"tiny",quaternary:!0,onClick:()=>h("load-recording",D.group,D.name)},{icon:()=>pe(oe,null,{default:()=>pe(In)})}),pe(ae,{size:"tiny",quaternary:!0,onClick:()=>h("edit-recording",D.group,D.name)},{icon:()=>pe(oe,null,{default:()=>pe(Nt)})}),pe(ae,{size:"tiny",quaternary:!0,onClick:()=>h("delete-recording",D.group,D.name)},{icon:()=>pe(oe,null,{default:()=>pe(vt)})})])}function S({option:O}){const v=O;return v.isGroup?{}:{onClick:()=>{v.recording&&h("load-recording",v.recording.group,v.recording.name)}}}return(O,v)=>(_(),z("div",ca,[k("div",ua,[k("div",da,[k("h3",null,F(i.t.recordingList)+" ("+F(y.value.length>0?y.value.reduce((D,L)=>D+(L.children?.length||0),0):0)+")",1),d(l(ae),{size:"small",onClick:v[0]||(v[0]=D=>O.$emit("refresh-recordings")),loading:i.loading},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(pt))]),_:1})]),default:p(()=>[q(" "+F(i.commonT.refresh),1)]),_:1},8,["loading"])]),y.value.length>0?(_(),Se(l(qt),{key:0,data:y.value,"render-label":M,"render-suffix":C,"node-props":S,"block-line":"","expand-on-click":"","default-expanded-keys":g.value},null,8,["data","default-expanded-keys"])):(_(),Se(l(tt),{key:1,description:i.t.noRecordings},null,8,["description"]))]),k("div",fa,[k("div",pa,[d(l(je),{size:8},{default:p(()=>[d(l(ae),{type:"success",disabled:!i.player.canPlay.value||i.isRecordingActive,loading:i.player.isPlaying.value,onClick:v[1]||(v[1]=D=>O.$emit("start-playback"))},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(jn))]),_:1})]),default:p(()=>[q(" "+F(i.t.play),1)]),_:1},8,["disabled","loading"]),i.player.isPlaying.value?(_(),Se(l(ae),{key:0,onClick:v[2]||(v[2]=D=>i.player.pause())},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(On))]),_:1})]),default:p(()=>[q(" "+F(i.t.pause),1)]),_:1})):ke("",!0),d(l(ae),{disabled:!i.player.isPlaying.value&&!i.player.isPaused.value,onClick:v[3]||(v[3]=D=>i.player.stop())},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(ht))]),_:1})]),default:p(()=>[q(" "+F(i.t.stop),1)]),_:1},8,["disabled"]),d(l(ae),{disabled:!i.player.isPaused.value,onClick:v[4]||(v[4]=D=>i.player.stepNext())},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(Vn))]),_:1})]),default:p(()=>[q(" "+F(i.t.step),1)]),_:1},8,["disabled"])]),_:1}),i.player.recording.value?(_(),Se(l(je),{key:0,size:8,align:"center"},{default:p(()=>[k("span",ha,F(i.t.progress)+": "+F(i.player.progress.value.currentIndex+1)+" / "+F(i.player.progress.value.totalSteps),1),d(l(qe),{type:l(qr)(i.player.state.value),size:"small"},{default:p(()=>[q(F(l(Jr)(i.player.state.value)),1)]),_:1},8,["type"])]),_:1})):ke("",!0)]),i.player.error.value?(_(),z("div",va,[d(l(Jt),{type:"error",title:i.player.error.value,closable:""},null,8,["title"])])):ke("",!0)]),k("div",ma,[i.player.recording.value?(_(),z("div",xa,[(_(!0),z(Oe,null,We(i.player.recording.value.actions,(D,L)=>(_(),z("div",{key:D.id,class:Et(["step-item",{active:i.player.currentIndex.value===L,completed:i.player.currentIndex.value>L,pending:i.player.currentIndex.value<L}])},[k("span",ya,F(Number(L)+1),1),d(l(qe),{type:l(xt)(D.type),size:"small"},{default:p(()=>[q(F(D.type),1)]),_:2},1032,["type"]),k("span",ga,F(l(Vt)(D)),1),k("span",wa,F(l(Ht)(D.relativeTime)),1)],2))),128))])):(_(),Se(l(tt),{key:1,description:i.t.selectRecording},null,8,["description"]))])]))}}),ba=ze(ka,[["__scopeId","data-v-87bae0b8"]]);function Sa(i){return JSON.parse(JSON.stringify(i))}const Ca=ie({__name:"ActionEditDialog",props:yt({action:{},screenSize:{}},{show:{type:Boolean,required:!0},showModifiers:{}}),emits:yt(["save","cancel"],["update:show"]),setup(i,{emit:f}){const c=i,h=f,y=Ke(),g=ce(()=>({common:y.t.common,actions:y.t.actions})),M=Zt(i,"show"),C=V(null),S=ce(()=>c.action),O=ce(()=>{if(!S.value)return g.value.actions.editAction;const B=g.value.actions.actionTypes[S.value.type]||S.value.type;return`${g.value.actions.editAction} - ${B}`}),v=V({relativeTime:0,coords:{x:0,y:0,scaleX:0,scaleY:0},endCoords:{x:0,y:0,scaleX:0,scaleY:0},xpath:{selector:"",fallbackCoords:{x:0,y:0}},params:{}});Le(()=>c.action,B=>{B&&(v.value=Sa(B),v.value.coords||(v.value.coords={x:0,y:0,scaleX:0,scaleY:0}),v.value.endCoords||(v.value.endCoords={x:0,y:0,scaleX:0,scaleY:0}),v.value.xpath||(v.value.xpath={selector:"",fallbackCoords:{x:0,y:0}}),v.value.params||(v.value.params={}))},{immediate:!0});const D=ce(()=>({relativeTime:[{required:!0,type:"number",message:`${g.value.actions.relativeTime}不能为空`,trigger:"blur"},{type:"number",min:0,message:"不能为负数",trigger:"blur"}],"coords.x":[{required:!0,type:"number",message:`${g.value.actions.coordinateX}不能为空`,trigger:"blur"},{type:"number",min:0,message:"不能为负数",trigger:"blur"}],"coords.y":[{required:!0,type:"number",message:`${g.value.actions.coordinateY}不能为空`,trigger:"blur"},{type:"number",min:0,message:"不能为负数",trigger:"blur"}],"endCoords.x":[{required:!0,type:"number",message:`${g.value.actions.coordinateX}不能为空`,trigger:"blur"},{type:"number",min:0,message:"不能为负数",trigger:"blur"}],"endCoords.y":[{required:!0,type:"number",message:`${g.value.actions.coordinateY}不能为空`,trigger:"blur"},{type:"number",min:0,message:"不能为负数",trigger:"blur"}],"params.text":[{required:!0,message:`${g.value.actions.inputText}不能为空`,trigger:"blur"}],"params.duration":[{required:!0,type:"number",message:"时长不能为空",trigger:"blur"}],"params.command":[{required:!0,message:"命令不能为空",trigger:"blur"}]}));async function L(){if(!(!C.value||!S.value))try{await C.value.validate();const B={};if(v.value.relativeTime!==S.value.relativeTime&&(B.relativeTime=v.value.relativeTime),S.value.type==="tap"){if(v.value.coords.x!==S.value.coords.x||v.value.coords.y!==S.value.coords.y){const{width:w,height:J}=c.screenSize;if(!w||!J||w<=0||J<=0){console.error(`Invalid screen size: ${w}x${J}. Cannot update coordinates.`);return}B.coords={x:v.value.coords.x,y:v.value.coords.y,scaleX:v.value.coords.x/w,scaleY:v.value.coords.y/J},B.params={x:v.value.coords.x,y:v.value.coords.y}}const U=S.value.xpath?.selector||"",b=v.value.xpath?.selector||"";U!==b&&(b?B.xpath={selector:b,fallbackCoords:{x:v.value.coords.x,y:v.value.coords.y}}:B.xpath=void 0)}else if(S.value.type==="swipe")if(v.value.coords.x!==S.value.coords.x||v.value.coords.y!==S.value.coords.y||v.value.endCoords.x!==S.value.endCoords.x||v.value.endCoords.y!==S.value.endCoords.y){const{width:b,height:w}=c.screenSize;if(!b||!w||b<=0||w<=0){console.error(`Invalid screen size: ${b}x${w}. Cannot update coordinates.`);return}B.coords={x:v.value.coords.x,y:v.value.coords.y,scaleX:v.value.coords.x/b,scaleY:v.value.coords.y/w},B.endCoords={x:v.value.endCoords.x,y:v.value.endCoords.y,scaleX:v.value.endCoords.x/b,scaleY:v.value.endCoords.y/w},B.params={startX:v.value.coords.x,startY:v.value.coords.y,endX:v.value.endCoords.x,endY:v.value.endCoords.y,duration:v.value.params.duration||.5}}else v.value.params.duration!==S.value.params.duration&&(B.params={...S.value.params,duration:v.value.params.duration});else S.value.type==="input"?v.value.params.text!==S.value.params.text&&(B.params={text:v.value.params.text}):S.value.type==="sleep"&&v.value.params.duration!==S.value.params.duration&&(B.params={duration:v.value.params.duration});h("save",S.value.id,B),M.value=!1}catch(B){console.warn("表单验证失败:",B)}}function X(){M.value=!1,h("cancel")}return(B,U)=>(_(),Se(l(Bt),{show:M.value,"onUpdate:show":U[12]||(U[12]=b=>M.value=b),preset:"dialog",title:O.value,"positive-text":g.value.common.save,"negative-text":g.value.common.cancel,onPositiveClick:L,onNegativeClick:X},{default:p(()=>[S.value?(_(),Se(l(Lt),{key:0,ref_key:"formRef",ref:C,model:v.value,rules:D.value,"label-placement":"left","label-width":"120","require-mark-placement":"left"},{default:p(()=>[d(l(De),{label:g.value.actions.actionType},{default:p(()=>[d(l(qe),{type:l(xt)(S.value.type)},{default:p(()=>[q(F(g.value.actions.actionTypes[S.value.type]||S.value.type),1)]),_:1},8,["type"])]),_:1},8,["label"]),S.value.type==="tap"?(_(),z(Oe,{key:0},[d(l(De),{label:g.value.actions.coordinateX,path:"coords.x"},{default:p(()=>[d(l(Be),{value:v.value.coords.x,"onUpdate:value":U[0]||(U[0]=b=>v.value.coords.x=b),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),d(l(De),{label:g.value.actions.coordinateY,path:"coords.y"},{default:p(()=>[d(l(Be),{value:v.value.coords.y,"onUpdate:value":U[1]||(U[1]=b=>v.value.coords.y=b),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),d(l(De),{label:g.value.actions.xpathSelector,path:"xpath.selector"},{default:p(()=>[d(l(Ye),{value:v.value.xpath.selector,"onUpdate:value":U[2]||(U[2]=b=>v.value.xpath.selector=b),type:"textarea",placeholder:g.value.actions.xpathPlaceholder,autosize:{minRows:2,maxRows:4}},null,8,["value","placeholder"])]),_:1},8,["label"])],64)):ke("",!0),S.value.type==="swipe"?(_(),z(Oe,{key:1},[d(l(gt),{"title-placement":"left"},{default:p(()=>[q(F(g.value.actions.startPosition),1)]),_:1}),d(l(De),{label:g.value.actions.coordinateX,path:"coords.x"},{default:p(()=>[d(l(Be),{value:v.value.coords.x,"onUpdate:value":U[3]||(U[3]=b=>v.value.coords.x=b),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),d(l(De),{label:g.value.actions.coordinateY,path:"coords.y"},{default:p(()=>[d(l(Be),{value:v.value.coords.y,"onUpdate:value":U[4]||(U[4]=b=>v.value.coords.y=b),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),d(l(gt),{"title-placement":"left"},{default:p(()=>[q(F(g.value.actions.endPosition),1)]),_:1}),d(l(De),{label:g.value.actions.coordinateX,path:"endCoords.x"},{default:p(()=>[d(l(Be),{value:v.value.endCoords.x,"onUpdate:value":U[5]||(U[5]=b=>v.value.endCoords.x=b),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),d(l(De),{label:g.value.actions.coordinateY,path:"endCoords.y"},{default:p(()=>[d(l(Be),{value:v.value.endCoords.y,"onUpdate:value":U[6]||(U[6]=b=>v.value.endCoords.y=b),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),d(l(De),{label:g.value.actions.swipeDuration,path:"params.duration"},{default:p(()=>[d(l(Be),{value:v.value.params.duration,"onUpdate:value":U[7]||(U[7]=b=>v.value.params.duration=b),min:.1,max:10,step:.1,precision:1,style:{width:"100%"}},{suffix:p(()=>[q(F(g.value.actions.seconds),1)]),_:1},8,["value"])]),_:1},8,["label"])],64)):ke("",!0),S.value.type==="input"?(_(),Se(l(De),{key:2,label:g.value.actions.inputText,path:"params.text"},{default:p(()=>[d(l(Ye),{value:v.value.params.text,"onUpdate:value":U[8]||(U[8]=b=>v.value.params.text=b),type:"textarea",placeholder:g.value.actions.inputText,autosize:{minRows:2,maxRows:6}},null,8,["value","placeholder"])]),_:1},8,["label"])):ke("",!0),S.value.type==="sleep"?(_(),Se(l(De),{key:3,label:g.value.actions.sleepDuration,path:"params.duration"},{default:p(()=>[d(l(Be),{value:v.value.params.duration,"onUpdate:value":U[9]||(U[9]=b=>v.value.params.duration=b),min:0,step:100,precision:0,style:{width:"100%"}},{suffix:p(()=>[q(F(g.value.actions.milliseconds),1)]),_:1},8,["value"])]),_:1},8,["label"])):ke("",!0),S.value.type==="command"||S.value.type==="back"||S.value.type==="home"?(_(),Se(l(De),{key:4,label:g.value.actions.command,path:"params.command"},{default:p(()=>[d(l(Ye),{value:v.value.params.command,"onUpdate:value":U[10]||(U[10]=b=>v.value.params.command=b),disabled:S.value.type==="back"||S.value.type==="home",placeholder:S.value.type==="back"?"back":S.value.type==="home"?"home":""},null,8,["value","disabled","placeholder"])]),_:1},8,["label"])):ke("",!0),d(l(De),{label:g.value.actions.relativeTime,path:"relativeTime"},{default:p(()=>[d(l(Be),{value:v.value.relativeTime,"onUpdate:value":U[11]||(U[11]=b=>v.value.relativeTime=b),min:0,step:100,precision:0,style:{width:"100%"}},{suffix:p(()=>[q(F(g.value.actions.milliseconds),1)]),_:1},8,["value"])]),_:1},8,["label"])]),_:1},8,["model","rules"])):ke("",!0)]),_:1},8,["show","title","positive-text","negative-text"]))}}),_a=ze(Ca,[["__scopeId","data-v-519ab678"]]);function Pa(i,f,c=!0){const h=c?JSON.stringify(i,null,2):JSON.stringify(i),y=new Blob([h],{type:"application/json"});Aa(y,`${f}.json`)}function Aa(i,f){const c=URL.createObjectURL(i),h=document.createElement("a");h.href=c,h.download=f,h.click(),setTimeout(()=>{URL.revokeObjectURL(c)},100)}function Ta(i,f,c){const h=V(!1),y=V(!1),g=V([]),M=V(0),C=V(`Recording_${Date.now()}`),S=V({captureScreenshots:!1,screenshotQuality:.6,recordElementDetails:!0}),O=ce(()=>g.value.length===0?0:g.value[g.value.length-1]?.relativeTime||0),v=ce(()=>g.value.length);function D(T){h.value=!0,y.value=!1,g.value=[],M.value=Date.now(),T&&(C.value=T)}function L(){h.value=!1,y.value=!1}function X(){h.value&&(y.value=!0)}function B(){h.value&&(y.value=!1)}function U(){g.value=[],M.value=0}function b(T,W){const{width:Z,height:xe}=c.value;if(!Z||!xe||Z<=0||xe<=0)throw new Error(`Invalid screen size: ${Z}x${xe}. Recording requires valid screen dimensions.`);return{x:T,y:W,scaleX:T/Z,scaleY:W/xe}}function w(T,W,Z){if(!(!T||!T.xpath))return{selector:T.xpath,fallbackCoords:{x:W,y:Z}}}function J(T){if(!(!T||!S.value.recordElementDetails))return{text:T.text,resource_id:T.resource_id,class_name:T.class_name,content_desc:T.content_desc,bounds:T.bounds||[0,0,0,0],key:T.key}}async function de(){S.value.captureScreenshots}async function me(T,W,Z,xe,I){if(!h.value||y.value)return;const Y=Date.now(),ee={id:crypto.randomUUID(),timestamp:Y,relativeTime:Y-M.value,screenshot:await de()};let j;switch(T){case"tap":j={...ee,type:"tap",coords:Z,xpath:Z?w(I||null,Z.x,Z.y):void 0,element:J(I||null),params:W};break;case"swipe":j={...ee,type:"swipe",coords:Z,endCoords:xe,element:J(I||null),params:W};break;case"input":j={...ee,type:"input",element:J(I||null),params:W};break;case"sleep":j={...ee,type:"sleep",params:W};break;case"command":case"back":case"home":j={...ee,type:T,params:W};break;default:console.warn("未知操作类型，跳过录制");return}g.value.push(j)}async function ge(T,W,Z){const xe=b(T,W);await me("tap",{x:T,y:W},xe,void 0,Z)}async function he(T,W,Z,xe,I,Y){const ee=b(T,W),j=b(Z,xe);await me("swipe",{startX:T,startY:W,endX:Z,endY:xe,duration:I},ee,j,Y)}async function ve(T,W){await me("input",{text:T},void 0,void 0,W)}async function E(T){await me("sleep",{duration:T})}async function P(T,W){await me("command",{command:T,args:W})}function A(T){const W=g.value.findIndex(Z=>Z.id===T);W!==-1&&g.value.splice(W,1)}function G(T,W){const Z=g.value.findIndex(Y=>Y.id===T);if(Z===-1)return console.warn(`Action with id ${T} not found`),!1;const xe=g.value[Z],I={...xe,...W};if(I.type!==xe.type)throw new Error("Cannot change action type");if(I.id!==xe.id)throw new Error("Cannot change action id");if(I.timestamp!==xe.timestamp)throw new Error("Cannot change action timestamp");return g.value[Z]=I,!0}function te(T){return{version:"1.0",name:T||C.value,description:void 0,platform:i,deviceInfo:{serial:f,screenWidth:c.value.width,screenHeight:c.value.height},createdAt:M.value,updatedAt:Date.now(),duration:O.value,config:S.value,actions:g.value}}function ue(T){C.value=T.name,g.value=T.actions,M.value=T.createdAt,S.value=T.config}function Ce(){const T=te();Pa(T,`${T.name}.byteautoui`)}function se(T){if(!T||typeof T!="object")return!1;if(T.version!=="1.0")return console.error("不支持的文件版本:",T.version),!1;if(typeof T.name!="string")return console.error("缺少录制名称"),!1;if(!T.platform||!["android","ios","harmony"].includes(T.platform))return console.error("无效的平台:",T.platform),!1;if(!T.deviceInfo||typeof T.deviceInfo.screenWidth!="number"||typeof T.deviceInfo.screenHeight!="number")return console.error("缺少设备信息"),!1;if(!Array.isArray(T.actions))return console.error("缺少操作列表"),!1;for(let W=0;W<T.actions.length;W++){const Z=T.actions[W];if(!Z||typeof Z!="object")return console.error(`操作 ${W} 格式错误`),!1;if(!Z.type||typeof Z.timestamp!="number"||typeof Z.relativeTime!="number")return console.error(`操作 ${W} 缺少必需字段`),!1;if((Z.type==="tap"||Z.type==="swipe")&&!Z.coords)return console.error(`操作 ${W} (${Z.type}) 缺少坐标信息`),!1;if(Z.type==="swipe"&&!Z.endCoords)return console.error(`操作 ${W} (swipe) 缺少结束坐标`),!1}return!0}async function ne(){return new Promise((T,W)=>{const Z=document.createElement("input");Z.type="file",Z.accept=".byteautoui.json,.json",Z.onchange=async()=>{const xe=Z.files?.[0];if(!xe){W(new Error("未选择文件"));return}try{const I=await xe.text(),Y=JSON.parse(I);if(!se(Y)){W(new Error("文件格式验证失败，请检查是否为有效的录制文件"));return}ue(Y),T(Y)}catch(I){I instanceof SyntaxError?W(new Error("文件格式错误：无效的JSON")):W(I)}},Z.click()})}return{isRecording:h,isPaused:y,actions:g,recordingName:C,config:S,duration:O,actionCount:v,start:D,stop:L,pause:X,resume:B,clear:U,recordTap:ge,recordSwipe:he,recordInput:ve,recordSleep:E,recordCommand:P,deleteAction:A,updateAction:G,exportRecording:te,importRecording:ue,saveToFile:Ce,loadFromFile:ne}}function $a(i,f,c){const h=V("idle"),y=V(-1),g=V(null),M=V(null),C=V(1),S=ce(()=>({currentIndex:y.value,totalSteps:g.value?.actions.length||0,elapsedTime:0,state:h.value,error:M.value||void 0})),O=ce(()=>h.value==="playing"),v=ce(()=>h.value==="paused"),D=ce(()=>g.value!==null&&g.value.actions.length>0);function L(E){g.value=E,y.value=-1,h.value="idle",M.value=null}function X(){g.value=null,y.value=-1,h.value="idle",M.value=null}function B(E){return new Promise(P=>setTimeout(P,E/C.value))}function U(E){const{width:P,height:A}=c.value;if(!P||!A||P<=0||A<=0)throw new Error(`无法回放:屏幕尺寸无效(${P}x${A}),请确保设备已连接并加载了屏幕信息`);return{x:Math.round(E.scaleX*P),y:Math.round(E.scaleY*A)}}async function b(E){try{let P=function(ne){for(const T of ne){if(T.xpath===E)return T;if(T.children){const W=P(T.children);if(W)return W}}return null};const A=await zt(i,f),G=P(A.nodes);if(!G||!G.bounds)return null;const[te,ue,Ce,se]=G.bounds;return{x:Math.round((te+Ce)/2),y:Math.round((ue+se)/2)}}catch(P){return console.error("XPath查找失败:",P),null}}async function w(E){switch(E.type){case"tap":{let P,A;if(E.xpath){const G=await b(E.xpath.selector);if(G)P=G.x,A=G.y;else{if(console.warn("XPath查找失败，降级使用比例缩放坐标:",E.xpath.selector),!E.coords)throw new Error("Tap操作缺少坐标信息");const te=U(E.coords);P=te.x,A=te.y}}else{if(!E.coords)throw new Error("Tap操作缺少坐标信息");const G=U(E.coords);P=G.x,A=G.y}await ft(i,f,P,A);break}case"swipe":{if(!E.coords||!E.endCoords)throw new Error("Swipe操作缺少坐标信息");const P=U(E.coords),A=U(E.endCoords),G=E.params;await Te(i,f,"swipe",{startX:P.x,startY:P.y,endX:A.x,endY:A.y,duration:G.duration||.5});break}case"input":{const P=E.params;await Te(i,f,"sendKeys",{text:P.text});break}case"sleep":{const P=E.params;await B(P.duration);break}case"back":{await Te(i,f,"back",{});break}case"home":{await Te(i,f,"home",{});break}case"command":{const P=E.params;await Te(i,f,P.command,P.args||{});break}default:console.warn("未知操作类型")}}async function J(){if(!g.value||g.value.actions.length===0){M.value="没有可回放的录制";return}for(h.value==="paused"?h.value="playing":(y.value=0,h.value="playing",M.value=null);y.value<g.value.actions.length&&h.value==="playing";){const E=g.value.actions[y.value];try{if(await w(E),h.value!=="playing")break;if(y.value<g.value.actions.length-1){const A=g.value.actions[y.value+1].relativeTime-E.relativeTime;if(await B(A),h.value!=="playing")break}y.value++}catch(P){M.value=P instanceof Error?P.message:String(P),h.value="error",console.error(`回放失败在步骤 ${y.value}:`,P);break}}h.value==="playing"&&(h.value="idle",y.value=-1)}function de(){h.value==="playing"&&(h.value="paused")}function me(){h.value="stopped",y.value=-1,M.value=null}async function ge(){if(!g.value||y.value>=g.value.actions.length-1)return;h.value="paused",y.value++;const E=g.value.actions[y.value];try{await w(E)}catch(P){M.value=P instanceof Error?P.message:String(P),h.value="error",console.error(`单步执行失败在步骤 ${y.value}:`,P)}}function he(E){g.value&&E>=0&&E<g.value.actions.length&&(y.value=E,h.value="paused")}function ve(E){C.value=Math.max(.1,Math.min(5,E))}return{state:h,currentIndex:y,recording:g,error:M,speed:C,progress:S,isPlaying:O,isPaused:v,canPlay:D,load:L,unload:X,play:J,pause:de,stop:me,stepNext:ge,seekTo:he,setSpeed:ve}}const rt="";async function Fa(i){const f=await fetch(`${rt}/api/recordings/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!f.ok){const c=await f.text(),h=`保存录制"${i.name}"失败 (分组:${i.group}, HTTP ${f.status}): ${c}`;throw console.error(h,{request:i,status:f.status}),new Error(h)}}async function Da(){const i=await fetch(`${rt}/api/recordings/list`);if(!i.ok){const c=await i.text(),h=`获取录制列表失败 (HTTP ${i.status}): ${c}`;throw console.error(h,{status:i.status}),new Error(h)}return(await i.json()).recordings}async function Ft(i,f){const c=await fetch(`${rt}/api/recordings/load?group=${encodeURIComponent(i)}&name=${encodeURIComponent(f)}`);if(!c.ok){const y=await c.text(),g=`加载录制"${f}"失败 (分组:${i}, HTTP ${c.status}): ${y}`;throw console.error(g,{group:i,name:f,status:c.status}),new Error(g)}return(await c.json()).data}async function Ua(i,f){const c=await fetch(`${rt}/api/recordings/delete?group=${encodeURIComponent(i)}&name=${encodeURIComponent(f)}`,{method:"DELETE"});if(!c.ok){const h=await c.text(),y=`删除录制"${f}"失败 (分组:${i}, HTTP ${c.status}): ${h}`;throw console.error(y,{group:i,name:f,status:c.status}),new Error(y)}}const Ra={class:"actions-panel"},Ea=ie({__name:"ActionsPanel",props:{platform:{},serial:{}},setup(i,{expose:f}){const c=i,h=Je(),y=Qt(),g=nt(),M=Ke(),C=ce(()=>M.t.actions);function S(I,Y){h.error(`${I}: ${Y instanceof Error?Y.message:String(Y)}`)}const O=V("record"),v=V([]),D=V(!1),L=V(!1),X=V({group:"default",name:""}),B=V(!1),U=V(null),b=ce(()=>g.screenSize),w=Ta(c.platform,c.serial,b),J=$a(c.platform,c.serial,b);function de(){w.isRecording.value?w.stop():w.start()}function me(){w.isPaused.value?w.resume():w.pause()}function ge(){y.warning({title:"确认清空",content:"确定要清空所有录制步骤吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{w.clear(),h.success("已清空录制")}})}function he(){const I=new Date,Y=I.getFullYear(),ee=String(I.getMonth()+1).padStart(2,"0"),j=String(I.getDate()).padStart(2,"0"),R=String(I.getHours()).padStart(2,"0"),K=String(I.getMinutes()).padStart(2,"0"),le=String(I.getSeconds()).padStart(2,"0");return`Recording_${Y}${ee}${j}_${R}${K}${le}`}function ve(){X.value.name=he(),X.value.group="default",L.value=!0}async function E(){if(!X.value.name){h.warning("请输入录制名称");return}if(w.actionCount.value===0){h.warning("没有可保存的录制");return}try{const I=w.exportRecording(X.value.name);await Fa({group:X.value.group||"default",name:X.value.name,data:I}),h.success("录制已保存"),L.value=!1,X.value={group:"default",name:""},await te()}catch(I){S("保存失败",I)}}function P(I){w.deleteAction(I)}function A(I){U.value=I,B.value=!0}function G(I,Y){try{w.updateAction(I,Y)?h.success("操作已更新"):h.error("更新失败：操作不存在")}catch(ee){S("更新失败",ee)}}async function te(){D.value=!0;try{v.value=await Da()}catch(I){S("获取录制列表失败",I)}finally{D.value=!1}}async function ue(I,Y){try{const ee=await Ft(I,Y);J.load(ee),h.success(`已加载录制: ${Y}`)}catch(ee){S("加载录制失败",ee)}}async function Ce(I,Y){if(w.actionCount.value>0){y.warning({title:"确认覆盖",content:"当前有未保存的录制操作，加载新录制将会覆盖这些操作。是否继续？",positiveText:"继续加载",negativeText:"取消",onPositiveClick:async()=>{await se(I,Y)}});return}await se(I,Y)}async function se(I,Y){try{const ee=await Ft(I,Y);w.importRecording(ee),O.value="record",h.success(`已加载 "${Y}" 到录制器，可以编辑了`)}catch(ee){S("加载录制失败",ee)}}async function ne(I,Y){y.warning({title:"确认删除",content:`确定要删除录制 "${Y}" 吗？`,positiveText:"删除",negativeText:"取消",onPositiveClick:async()=>{try{await Ua(I,Y),h.success("已删除"),await te()}catch(ee){S("删除失败",ee)}}})}async function T(){try{await J.play()}catch(I){S("回放失败",I)}}async function W(I,Y,ee){await w.recordTap(I,Y,ee)}async function Z(I,Y,ee,j,R,K){await w.recordSwipe(I,Y,ee,j,R,K)}function xe(){return w.isRecording.value}return Ot(()=>{te()}),f({recordTap:W,recordSwipe:Z,getIsRecording:xe}),(I,Y)=>(_(),z("div",Ra,[d(l(en),{value:O.value,"onUpdate:value":Y[0]||(Y[0]=ee=>O.value=ee),type:"segment"},{default:p(()=>[d(l(wt),{name:"record",tab:C.value.recordTab},{default:p(()=>[d(la,{recorder:l(w),"current-playback-index":l(J).currentIndex.value,"is-playback-active":l(J).isPlaying.value,t:C.value,onToggleRecording:de,onTogglePause:me,onClearRecording:ge,onSaveRecording:ve,onEditAction:A,onDeleteAction:P},null,8,["recorder","current-playback-index","is-playback-active","t"])]),_:1},8,["tab"]),d(l(wt),{name:"playback",tab:C.value.playbackTab},{default:p(()=>[d(ba,{player:l(J),recordings:v.value,loading:D.value,"is-recording-active":l(w).isRecording.value,t:C.value,"common-t":l(M).t.common,onRefreshRecordings:te,onStartPlayback:T,onLoadRecording:ue,onEditRecording:Ce,onDeleteRecording:ne},null,8,["player","recordings","loading","is-recording-active","t","common-t"])]),_:1},8,["tab"])]),_:1},8,["value"]),d(l(Bt),{show:L.value,"onUpdate:show":Y[4]||(Y[4]=ee=>L.value=ee),preset:"dialog",title:"保存录制"},{action:p(()=>[d(l(je),{justify:"end"},{default:p(()=>[d(l(ae),{onClick:Y[3]||(Y[3]=ee=>L.value=!1)},{default:p(()=>[...Y[6]||(Y[6]=[q("取消",-1)])]),_:1}),d(l(ae),{type:"primary",onClick:E},{default:p(()=>[...Y[7]||(Y[7]=[q("保存",-1)])]),_:1})]),_:1})]),default:p(()=>[d(l(Lt),{model:X.value},{default:p(()=>[d(l(De),{label:"分组"},{default:p(()=>[d(l(Ye),{value:X.value.group,"onUpdate:value":Y[1]||(Y[1]=ee=>X.value.group=ee),placeholder:"default"},null,8,["value"])]),_:1}),d(l(De),{label:"名称"},{default:p(()=>[d(l(Ye),{value:X.value.name,"onUpdate:value":Y[2]||(Y[2]=ee=>X.value.name=ee),placeholder:"my-recording"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),d(_a,{show:B.value,"onUpdate:show":Y[5]||(Y[5]=ee=>B.value=ee),action:U.value,"screen-size":b.value,onSave:G},null,8,["show","action","screen-size"])]))}}),Ma=ze(Ea,[["__scopeId","data-v-a80a602c"]]),Ba={class:"package-panel"},La={class:"package-content"},Oa={class:"install-section"},za={class:"package-list-section"},Ia={key:0,class:"loading-state"},Na={class:"loading-text"},ja={key:1,class:"empty-state"},Ha={class:"empty-hint"},Va={key:2,class:"package-list"},Xa={class:"package-info"},Ga={class:"package-name"},Ya={class:"package-id"},Wa={key:0,class:"package-version"},Ka=ie({__name:"PackagePanel",props:{platform:{},serial:{}},setup(i){const f=i,c=Je(),h=Ke(),y=ce(()=>h.t.package),g=V([]),M=V(!1),C=V(""),S=V(""),O=ce(()=>{if(!C.value)return g.value;const b=C.value.toLowerCase();return g.value.filter(w=>w.name.toLowerCase().includes(b)||w.package.toLowerCase().includes(b))});async function v(){M.value=!0;try{const b=await Te(f.platform,f.serial,"appList",{});Array.isArray(b)?(g.value=b.map(w=>{const J=w.package||w.packageName||w.pkg||"";return{name:w.name||w.label||w.appName||J,package:J,version:w.version||w.versionName||w.ver||""}}).filter(w=>w.package),c.success(`已加载 ${g.value.length} 个应用`)):c.error("应用列表格式错误")}catch(b){c.error(`加载应用列表失败: ${b instanceof Error?b.message:String(b)}`)}finally{M.value=!1}}async function D(b){try{await Te(f.platform,f.serial,"appLaunch",{package:b}),c.success(y.value.appLaunched)}catch(w){c.error(`${y.value.launch} failed: ${w instanceof Error?w.message:String(w)}`)}}async function L(b){try{await Te(f.platform,f.serial,"uninstallApp",{package:b}),c.success(y.value.appUninstalled),await v()}catch(w){c.error(`${y.value.uninstall} failed: ${w instanceof Error?w.message:String(w)}`)}}async function X(b){try{await Te(f.platform,f.serial,"clearApp",{package:b}),c.success(y.value.dataCleared)}catch(w){c.error(`${y.value.clear} failed: ${w instanceof Error?w.message:String(w)}`)}}async function B(b){try{const J=`${window.location.origin}/api/${f.platform}/${f.serial}/backupApp?package=${encodeURIComponent(b)}`,de=document.createElement("a");de.href=J,de.download=`${b}.apk`,de.click(),c.success(`Downloading: ${b}.apk`)}catch(w){c.error(`Backup failed: ${w instanceof Error?w.message:String(w)}`)}}async function U(){if(S.value.trim())try{await Te(f.platform,f.serial,"installApp",{path:S.value}),c.success(`Installed: ${S.value}`),S.value="",await v()}catch(b){c.error(`Install failed: ${b instanceof Error?b.message:String(b)}`)}}return(b,w)=>{const J=Me("n-input"),de=Me("n-button"),me=Me("n-space"),ge=Me("n-icon"),he=Me("n-spin"),ve=Me("n-empty");return _(),z("div",Ba,[k("div",La,[d(me,{vertical:"",size:16},{default:p(()=>[k("div",Oa,[k("h4",null,F(y.value.currentApp),1),d(me,{size:8},{default:p(()=>[d(J,{value:S.value,"onUpdate:value":w[0]||(w[0]=E=>S.value=E),placeholder:"APK file path",style:{flex:"1"}},null,8,["value"]),d(de,{type:"primary",onClick:U,disabled:!S.value.trim()},{default:p(()=>[...w[2]||(w[2]=[q(" Install ",-1)])]),_:1},8,["disabled"])]),_:1})]),k("div",za,[d(me,{justify:"space-between",align:"center",style:{"margin-bottom":"12px"}},{default:p(()=>[k("h4",null,F(y.value.installedApps)+" ("+F(O.value.length)+")",1),d(me,{size:8},{default:p(()=>[d(J,{value:C.value,"onUpdate:value":w[1]||(w[1]=E=>C.value=E),placeholder:l(h).t.common.search+"...",clearable:"",style:{width:"200px"}},null,8,["value","placeholder"]),d(de,{onClick:v,loading:M.value},{icon:p(()=>[d(ge,null,{default:p(()=>[d(l(pt))]),_:1})]),default:p(()=>[q(" "+F(l(h).t.common.refresh),1)]),_:1},8,["loading"])]),_:1})]),_:1}),M.value?(_(),z("div",Ia,[d(he,{size:"large"}),k("div",Na,F(l(h).t.common.loading),1)])):O.value.length===0?(_(),z("div",ja,[d(ve,{description:y.value.noApps},null,8,["description"]),k("div",Ha,[k("p",null,'点击"'+F(l(h).t.common.refresh)+'"按钮加载已安装的应用列表',1),w[3]||(w[3]=k("p",{class:"empty-hint-small"},"如果一直无法加载，请检查设备连接状态",-1))])])):(_(),z("div",Va,[(_(!0),z(Oe,null,We(O.value,E=>(_(),z("div",{key:E.package,class:"package-item"},[k("div",Xa,[k("div",Ga,F(E.name||"未知应用"),1),k("div",Ya,F(E.package||"无包名"),1),E.version?(_(),z("div",Wa,"v"+F(E.version),1)):ke("",!0)]),d(me,{size:8},{default:p(()=>[d(de,{size:"small",onClick:P=>D(E.package)},{default:p(()=>[q(F(y.value.launch),1)]),_:1},8,["onClick"]),d(de,{size:"small",onClick:P=>B(E.package)},{icon:p(()=>[d(ge,null,{default:p(()=>[d(l(Pn))]),_:1})]),default:p(()=>[w[4]||(w[4]=q(" Backup ",-1))]),_:1},8,["onClick"]),d(de,{size:"small",onClick:P=>X(E.package)},{default:p(()=>[q(F(y.value.clear),1)]),_:1},8,["onClick"]),d(de,{size:"small",type:"error",onClick:P=>L(E.package)},{default:p(()=>[q(F(y.value.uninstall),1)]),_:1},8,["onClick"])]),_:2},1024)]))),128))]))])]),_:1})])])}}}),qa=ze(Ka,[["__scopeId","data-v-fff7dce7"]]),Ja={class:"device-page"},Za={class:"page-header"},Qa={class:"serial"},eo={class:"main-area"},to={class:"control-sidebar"},no={class:"control-group"},ro={class:"control-group"},ao={class:"control-group"},oo={key:0,class:"control-group"},io={class:"vertical-text"},so={class:"screen-content"},lo={class:"text-input-bar"},co={class:"screenshot-area"},uo={key:0,class:"property-details-panel"},fo={class:"xpath-selector-bar"},po={class:"xpath-select-wrapper"},ho={key:0,class:"xpath-display-bar"},vo={class:"xpath-text"},mo={key:0,class:"siblings-nav"},xo={class:"property-details-table"},yo={class:"property-cell label-cell"},go={class:"property-cell value-cell"},wo={class:"right-panel"},ko=ie({__name:"Device",props:{platform:{},serial:{}},setup(i){const f=i,c=ln(),h=Je(),y=nt(),g=tn(),M=Ke(),C=V(null),S=V("hierarchy"),O=V(!1),v=ce(()=>M.t.device),D=V(""),L=V(450),X=V(!1);function B(e){X.value=!0,e.preventDefault()}function U(e){if(!X.value)return;const o=e.clientX;o>=300&&o<=800&&(L.value=o,localStorage.setItem("screenPanelWidth",o.toString()))}function b(){X.value=!1}async function w(e,o={},m,x){try{await Te(f.platform,f.serial,e,o),h.success(m)}catch($){h.error(`${x}: ${$ instanceof Error?$.message:String($)}`)}}const J=()=>w("volumeUp",{},"Volume up","Volume control failed"),de=()=>w("volumeDown",{},"Volume down","Volume control failed"),me=()=>w("volumeMute",{},"Volume muted","Volume control failed"),ge=V(""),he=V("id"),ve=(e,o)=>{if(!o)return"";switch(e){case"id":return o.resource_id?`//*[@resource-id="${o.resource_id}"]`:"";case"content-desc":return o.content_desc?`//*[@content-desc="${o.content_desc}"]`:"";case"text":return o.text?`//*[@text="${o.text}"]`:"";case"class_and_text":return o.class_name&&o.text?`//${o.class_name}[@text="${o.text}"]`:"";case"class":return o.class_name?`//${o.class_name}`:"";default:return o.xpath||""}},E=ce(()=>{const e=R.value;if(!e)return[];const o=(x,$)=>{if(!$||!y.hierarchy?.nodes)return 0;let N=0;function H(Q){Q.forEach(fe=>{ve(x,fe)===$&&N++,fe.children&&H(fe.children)})}return H(y.hierarchy.nodes),N};return[{label:"id",value:"id",xpath:ve("id",e)},{label:"class_and_text",value:"class_and_text",xpath:ve("class_and_text",e)},{label:"class",value:"class",xpath:ve("class",e)},{label:"text",value:"text",xpath:ve("text",e)}].map(x=>({...x,count:x.xpath?o(x.value,x.xpath):0}))}),P=ce(()=>ve(he.value,R.value)),A=V([]),G=V(-1);function te(e){if(A.value=[],G.value=-1,!e||!y.hierarchy?.nodes)return;const o=ve(he.value,e);if(!o)return;const m=[];function x($){$.forEach(N=>{ve(he.value,N)===o&&m.push(N),N.children&&x(N.children)})}x(y.hierarchy.nodes),m.length>1&&(A.value=m,G.value=m.findIndex($=>$.key===e.key))}function ue(e){e>=0&&e<A.value.length&&y.selectNode(A.value[e])}function Ce({option:e}){return e.label}function se(e){return pe("div",{class:"xpath-option"},[pe("span",{class:"xpath-option-label"},e.label),pe("div",{class:"xpath-option-right"},[e.xpath?pe("span",{class:"xpath-option-preview"},e.xpath):null,e.count>0?pe("span",{class:"xpath-option-count"},e.count.toString()):null].filter(Boolean))])}async function ne(){if(!ge.value.trim()){h.warning("Please enter text");return}try{await Te(f.platform,f.serial,"sendKeys",{text:ge.value}),h.success(`Sent: ${ge.value}`),ge.value=""}catch(e){h.error(`Send text failed: ${e instanceof Error?e.message:String(e)}`)}}async function T(){try{await Te(f.platform,f.serial,"clearText",{}),h.success("Text cleared")}catch(e){h.error(`Clear text failed: ${e instanceof Error?e.message:String(e)}`)}}const W=()=>w("home",{},"Home","Home failed"),Z=()=>w("back",{},"Back","Back failed"),xe=()=>w("appSwitch",{},"App Switch","App Switch failed"),I=()=>w("wakeUp",{},"Wake Up","Wake Up failed"),Y=()=>w("terminate",{},"Terminated current app","Terminate failed"),ee=ce(()=>{switch(f.platform){case"android":return St;case"ios":return un;case"harmony":return Ct;default:return St}}),j=ce(()=>{const e=y.screenSize;return{width:e?.width||0,height:e?.height||0}}),R=ce(()=>y.selectedNode);Le(()=>[R.value,he.value],([e])=>{te(e)},{immediate:!0});function K(e){const o={};if(e.index!==void 0&&(o.index=String(e.index)),e.text&&(o.text=e.text),e.resource_id&&(o["resource-id"]=e.resource_id),e.class_name&&(o.class=e.class_name),e.package&&(o.package=e.package),e.content_desc&&(o["content-desc"]=e.content_desc),e.checkable!==void 0&&(o.checkable=String(e.checkable)),e.checked!==void 0&&(o.checked=String(e.checked)),e.clickable!==void 0&&(o.clickable=String(e.clickable)),e.enabled!==void 0&&(o.enabled=String(e.enabled)),e.focusable!==void 0&&(o.focusable=String(e.focusable)),e.focused!==void 0&&(o.focused=String(e.focused)),e.scrollable!==void 0&&(o.scrollable=String(e.scrollable)),e.long_clickable!==void 0&&(o["long-clickable"]=String(e.long_clickable)),e.password!==void 0&&(o.password=String(e.password)),e.selected!==void 0&&(o.selected=String(e.selected)),e.visible_to_user!==void 0&&(o["visible-to-user"]=String(e.visible_to_user)),e.bounds){const[m,x,$,N]=e.bounds;o.bounds=`[${m},${x}][${$},${N}]`}return o}const le=ce(()=>{if(!R.value)return[];const e=R.value,o=[];if(e.index!==void 0&&o.push({label:"index",value:e.index}),e.text&&o.push({label:"text",value:e.text}),e.resource_id&&o.push({label:"resource-id",value:e.resource_id}),e.class_name&&o.push({label:"class",value:e.class_name}),e.package&&o.push({label:"package",value:e.package}),e.content_desc&&o.push({label:"content-desc",value:e.content_desc}),e.checkable!==void 0&&o.push({label:"checkable",value:e.checkable}),e.checked!==void 0&&o.push({label:"checked",value:e.checked}),e.clickable!==void 0&&o.push({label:"clickable",value:e.clickable}),e.enabled!==void 0&&o.push({label:"enabled",value:e.enabled}),e.focusable!==void 0&&o.push({label:"focusable",value:e.focusable}),e.focused!==void 0&&o.push({label:"focused",value:e.focused}),e.scrollable!==void 0&&o.push({label:"scrollable",value:e.scrollable}),e.long_clickable!==void 0&&o.push({label:"long-clickable",value:e.long_clickable}),e.password!==void 0&&o.push({label:"password",value:e.password}),e.selected!==void 0&&o.push({label:"selected",value:e.selected}),e.visible_to_user!==void 0&&o.push({label:"visible-to-user",value:e.visible_to_user}),e.bounds){const[m,x,$,N]=e.bounds;o.push({label:"bounds",value:`[${m},${x}][${$},${N}]`})}return e.rect&&(o.push({label:"rect.x",value:e.rect.x}),o.push({label:"rect.y",value:e.rect.y}),o.push({label:"rect.width",value:e.rect.width}),o.push({label:"rect.height",value:e.rect.height})),e.xpath&&o.push({label:"xpath",value:e.xpath}),o.push({label:"raw",value:JSON.stringify(K(e),null,2)}),o});function re(e,o){}async function Ae(e,o,m){if(C.value)try{await C.value.recordTap(e,o,m)}catch(x){h.error(`录制点击失败: ${x instanceof Error?x.message:String(x)}`),console.error("Failed to record tap:",x)}}async function we(e,o,m,x,$,N){if(C.value)try{await C.value.recordSwipe(e,o,m,x,$,N)}catch(H){h.error(`录制滑动失败: ${H instanceof Error?H.message:String(H)}`),console.error("Failed to record swipe:",H)}}async function Re(){if(!R.value||!R.value.bounds){h.warning("请先选择一个元素");return}try{const[e,o,m,x]=R.value.bounds,$=Math.round((e+m)/2),N=Math.round((o+x)/2);await ft(f.platform,f.serial,$,N),h.success(`点击元素: (${$}, ${N})`),C.value?.getIsRecording?.()&&(await C.value.recordTap($,N,R.value),h.info("已录制点击操作"))}catch(e){h.error(`点击失败: ${e instanceof Error?e.message:String(e)}`)}}async function Ee(){await y.refreshHierarchy();try{const e=await Te(f.platform,f.serial,"currentApp",{});e&&typeof e=="object"&&"package"in e&&(D.value=e.package||"")}catch{}}function He(){navigator.clipboard.writeText(f.serial),h.success("Copied")}function Ve(e,o){c.push(`/${e}/${o}`)}function a(){const e=P.value;if(!e){h.warning("No XPath available");return}navigator.clipboard.writeText(e),h.success("XPath copied")}function u(e){(e.key==="r"||e.key==="R")&&!e.ctrlKey&&!e.metaKey&&(e.preventDefault(),Ee())}Ot(()=>{const e=localStorage.getItem("screenPanelWidth");e&&(L.value=parseInt(e,10)),document.addEventListener("mousemove",U),document.addEventListener("mouseup",b),y.setDevice(f.platform,f.serial),Ee(),document.addEventListener("keydown",u)}),dt(()=>{document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",b),document.removeEventListener("keydown",u)}),Le(()=>[f.platform,f.serial],()=>{y.setDevice(f.platform,f.serial),Ee()});const t=()=>w("swipeUp",{},"Swiped up","Swipe failed"),n=()=>w("swipeDown",{},"Swiped down","Swipe failed"),r=()=>w("swipeLeft",{},"Swiped left","Swipe failed"),s=()=>w("swipeRight",{},"Swiped right","Swipe failed");return(e,o)=>(_(),z("div",Ja,[k("header",Za,[d(l(je),{align:"center",size:12},{default:p(()=>[d(l(ae),{secondary:"",size:"small",onClick:o[0]||(o[0]=m=>O.value=!0)},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(_t))]),_:1})]),default:p(()=>[q(" "+F(v.value.selectDevice),1)]),_:1}),d(l(oe),{size:"20",color:"#18a058"},{default:p(()=>[(_(),Se(kt(ee.value)))]),_:1}),k("span",Qa,F(i.serial),1),d(l(ae),{text:"",size:"small",onClick:He},{icon:p(()=>[d(l(oe),{size:"14"},{default:p(()=>[d(l(At))]),_:1})]),_:1}),d(l(Mt),{size:"small"},{default:p(()=>[d(l(ae),{type:S.value==="hierarchy"?"primary":"default",secondary:S.value!=="hierarchy",onClick:o[1]||(o[1]=m=>S.value="hierarchy")},{default:p(()=>[q(F(v.value.hierarchy),1)]),_:1},8,["type","secondary"]),d(l(ae),{type:S.value==="actions"?"primary":"default",secondary:S.value!=="actions",onClick:o[2]||(o[2]=m=>S.value="actions")},{default:p(()=>[q(F(v.value.actions),1)]),_:1},8,["type","secondary"]),d(l(ae),{type:S.value==="package"?"primary":"default",secondary:S.value!=="package",onClick:o[3]||(o[3]=m=>S.value="package")},{default:p(()=>[q(F(v.value.package),1)]),_:1},8,["type","secondary"])]),_:1})]),_:1}),d(l(je),{align:"center",size:16},{default:p(()=>[d(l(Fe),{placement:"bottom"},{trigger:p(()=>[d(l(ae),{quaternary:"",circle:"",onClick:Ee,loading:l(y).loading},{icon:p(()=>[d(l(oe),{size:"20"},{default:p(()=>[d(l(pt))]),_:1})]),_:1},8,["loading"])]),default:p(()=>[q(" "+F(v.value.refresh),1)]),_:1}),d(l(ae),{quaternary:"",circle:"",onClick:l(g).toggleTheme},{icon:p(()=>[d(l(oe),{size:"20"},{default:p(()=>[(_(),Se(kt(l(g).isDark?l(Ct):l(Bn))))]),_:1})]),_:1},8,["onClick"]),d(l(Ut),{value:l(M).locale,"onUpdate:value":o[4]||(o[4]=m=>l(M).locale=m),size:"small"},{default:p(()=>[d(l(et),{value:"zh"},{default:p(()=>[...o[8]||(o[8]=[q("中文",-1)])]),_:1}),d(l(et),{value:"en"},{default:p(()=>[...o[9]||(o[9]=[q("English",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),k("div",eo,[k("div",{class:"screen-panel",style:nn({width:L.value+"px"})},[k("div",to,[k("div",no,[d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{quaternary:"",circle:"",size:"small",onClick:W},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(En))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.home),1)]),_:1}),d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{quaternary:"",circle:"",size:"small",onClick:Z},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(Pt))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.back),1)]),_:1}),d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{quaternary:"",circle:"",size:"small",onClick:xe},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(_t))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.apps),1)]),_:1}),d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{quaternary:"",circle:"",size:"small",onClick:I},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(Gn))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.wake),1)]),_:1}),d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{quaternary:"",circle:"",size:"small",onClick:Y},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(ht))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.stop),1)]),_:1})]),k("div",ro,[d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{quaternary:"",circle:"",size:"small",onClick:de},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(or))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.volumeDown),1)]),_:1}),d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{quaternary:"",circle:"",size:"small",onClick:me},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(sr))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.volumeMute),1)]),_:1}),d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{quaternary:"",circle:"",size:"small",onClick:J},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(rr))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.volumeUp),1)]),_:1})]),k("div",ao,[d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{circle:"",size:"small",onClick:t},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(yn))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.swipeUp),1)]),_:1}),d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{circle:"",size:"small",onClick:n},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(vn))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.swipeDown),1)]),_:1}),d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{circle:"",size:"small",onClick:r},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(Pt))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.swipeLeft),1)]),_:1}),d(l(Fe),{placement:"right"},{trigger:p(()=>[d(l(ae),{circle:"",size:"small",onClick:s},{icon:p(()=>[d(l(oe),{size:"18"},{default:p(()=>[d(l(It))]),_:1})]),_:1})]),default:p(()=>[q(" "+F(v.value.swipeRight),1)]),_:1})]),R.value?(_(),z("div",oo,[d(l(ae),{type:"primary",size:"small",onClick:Re,class:"vertical-text-btn"},{default:p(()=>[k("span",io,F(v.value.tapElement),1)]),_:1})])):ke("",!0)]),k("div",so,[k("div",lo,[d(l(Ye),{value:ge.value,"onUpdate:value":o[5]||(o[5]=m=>ge.value=m),size:"small",placeholder:"Enter text to send...",onKeydown:Rt(ne,["enter"]),style:{flex:"1"}},null,8,["value"]),d(l(Fe),null,{trigger:p(()=>[d(l(ae),{type:"primary",size:"small",onClick:ne,disabled:!ge.value.trim()},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(Qn))]),_:1})]),_:1},8,["disabled"])]),default:p(()=>[o[10]||(o[10]=q(" Send ",-1))]),_:1}),d(l(Fe),null,{trigger:p(()=>[d(l(ae),{quaternary:"",size:"small",onClick:T},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(vt))]),_:1})]),_:1})]),default:p(()=>[o[11]||(o[11]=q(" Clear ",-1))]),_:1})]),k("div",co,[d(l(rn),{show:l(y).loading,style:{width:"100%",height:"100%"}},{default:p(()=>[l(y).screenshotUrl?(_(),Se(Rr,{key:0,platform:i.platform,serial:i.serial,"screen-size":j.value,onTap:re,onRecordTap:Ae,onRecordSwipe:we},null,8,["platform","serial","screen-size"])):ke("",!0)]),_:1},8,["show"])])])],4),k("div",{class:"resize-handle",onMousedown:B},null,32),S.value==="hierarchy"?(_(),z("div",uo,[k("div",fo,[o[12]||(o[12]=k("span",{class:"xpath-label"},"XPath by",-1)),k("div",po,[d(l(an),{value:he.value,"onUpdate:value":o[6]||(o[6]=m=>he.value=m),options:E.value,"render-label":se,"render-tag":Ce,"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),d(l(ae),{size:"small",quaternary:"",circle:"",onClick:a,disabled:!P.value},{icon:p(()=>[d(l(oe),null,{default:p(()=>[d(l(At))]),_:1})]),_:1},8,["disabled"])]),P.value?(_(),z("div",ho,[k("div",vo,F(P.value),1),A.value.length>1?(_(),z("div",mo,[(_(!0),z(Oe,null,We(A.value,(m,x)=>(_(),Se(l(ae),{key:x,size:"small",type:x===G.value?"info":"default",secondary:x!==G.value,circle:"",onClick:$=>ue(x),class:"sibling-btn"},{default:p(()=>[q(F(x+1),1)]),_:2},1032,["type","secondary","onClick"]))),128))])):ke("",!0)])):ke("",!0),k("div",xo,[(_(!0),z(Oe,null,We(le.value,m=>(_(),z("div",{key:m.label,class:"property-row"},[k("div",yo,F(m.label),1),k("div",go,[d(l(oe),{class:"circle-icon"},{default:p(()=>[d(l(ct))]),_:1}),k("span",null,F(m.value),1)])]))),128)),le.value.length===0?(_(),Se(l(tt),{key:0,description:"No element selected"})):ke("",!0)])])):ke("",!0),k("div",wo,[S.value==="hierarchy"?(_(),Se(Gr,{key:0,platform:i.platform,serial:i.serial},null,8,["platform","serial"])):ke("",!0),on(d(Ma,{ref_key:"actionsPanelRef",ref:C,platform:i.platform,serial:i.serial},null,8,["platform","serial"]),[[sn,S.value==="actions"]]),S.value==="package"?(_(),Se(qa,{key:1,platform:i.platform,serial:i.serial},null,8,["platform","serial"])):ke("",!0)])]),d(dn,{show:O.value,"onUpdate:show":o[7]||(o[7]=m=>O.value=m),onSelect:Ve},null,8,["show"])]))}}),Co=ze(ko,[["__scopeId","data-v-fad54e77"]]);export{Co as default};
