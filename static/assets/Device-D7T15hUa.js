import{d as ce,c as N,o as D,k as ft,a as y,l as Jt,r as H,b as de,m as nt,n as Re,p as qt,q as qe,e as u,u as s,N as Mt,w as h,i as et,j as K,f as le,t as U,s as we,v as ut,x as be,y as Oe,z as Bt,F as He,A as Je,C as me,g as Ie,B as se,D as Ke,E as Rt,G as Ot,H as tt,I as Kt,J as ct,K as kt,L as Zt,M as ht,O as pt,P as Te,Q as ze,R as je,S as bt,T as Qt,U as zt,V as en,W as St,X as tn,Y as nn,Z as Ee,_ as rn,$ as an,a0 as on,a1 as sn,a2 as _t,h as ln}from"./index-BsjBVvrC.js";import{g as un,a as It,s as Fe,u as Ge,t as vt,_ as Le,c as Ct,R as dt,L as $t,S as Pt,b as cn,D as dn,d as fn}from"./i18n-CPy77qO9.js";const hn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},At=ce({name:"AppsOutline",render:function(d,l){return D(),N("svg",hn,l[0]||(l[0]=[ft('<rect x="64" y="64" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="216" y="64" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="368" y="64" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="64" y="216" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="216" y="216" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="368" y="216" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="64" y="368" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="216" y="368" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect><rect x="368" y="368" width="80" height="80" rx="40" ry="40" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></rect>',9)]))}}),pn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ft=ce({name:"ArrowBackOutline",render:function(d,l){return D(),N("svg",pn,l[0]||(l[0]=[y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M244 400L100 256l144-144"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M120 256h292"},null,-1)]))}}),vn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},mn=ce({name:"ArrowDownOutline",render:function(d,l){return D(),N("svg",vn,l[0]||(l[0]=[y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 268l144 144l144-144"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M256 392V100"},null,-1)]))}}),xn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Lt=ce({name:"ArrowForwardOutline",render:function(d,l){return D(),N("svg",xn,l[0]||(l[0]=[y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M268 112l144 144l-144 144"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M392 256H100"},null,-1)]))}}),yn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},gn=ce({name:"ArrowUpOutline",render:function(d,l){return D(),N("svg",yn,l[0]||(l[0]=[y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 244l144-144l144 144"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M256 120v292"},null,-1)]))}}),wn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},kn=ce({name:"CloseOutline",render:function(d,l){return D(),N("svg",wn,l[0]||(l[0]=[y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 144L144 368"},null,-1)]))}}),bn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Tt=ce({name:"CopyOutline",render:function(d,l){return D(),N("svg",bn,l[0]||(l[0]=[y("rect",{x:"128",y:"128",width:"336",height:"336",rx:"57",ry:"57",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{d:"M383.5 128l.5-24a56.16 56.16 0 0 0-56-56H112a64.19 64.19 0 0 0-64 64v216a56.16 56.16 0 0 0 56 56h24",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),Sn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Nt=ce({name:"CreateOutline",render:function(d,l){return D(),N("svg",Sn,l[0]||(l[0]=[y("path",{d:"M384 224v184a40 40 0 0 1-40 40H104a40 40 0 0 1-40-40V168a40 40 0 0 1 40-40h167.48",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{d:"M459.94 53.25a16.06 16.06 0 0 0-23.22-.56L424.35 65a8 8 0 0 0 0 11.31l11.34 11.32a8 8 0 0 0 11.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38z",fill:"currentColor"},null,-1),y("path",{d:"M399.34 90L218.82 270.2a9 9 0 0 0-2.31 3.93L208.16 299a3.91 3.91 0 0 0 4.86 4.86l24.85-8.35a9 9 0 0 0 3.93-2.31L422 112.66a9 9 0 0 0 0-12.66l-9.95-10a9 9 0 0 0-12.71 0z",fill:"currentColor"},null,-1)]))}}),_n={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Cn=ce({name:"DocumentOutline",render:function(d,l){return D(),N("svg",_n,l[0]||(l[0]=[y("path",{d:"M416 221.25V416a48 48 0 0 1-48 48H144a48 48 0 0 1-48-48V96a48 48 0 0 1 48-48h98.75a32 32 0 0 1 22.62 9.37l141.26 141.26a32 32 0 0 1 9.37 22.62z",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{d:"M256 56v120a32 32 0 0 0 32 32h120",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),$n={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Pn=ce({name:"DownloadOutline",render:function(d,l){return D(),N("svg",$n,l[0]||(l[0]=[y("path",{d:"M336 176h40a40 40 0 0 1 40 40v208a40 40 0 0 1-40 40H136a40 40 0 0 1-40-40V216a40 40 0 0 1 40-40h40",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M176 272l80 80l80-80"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 48v288"},null,-1)]))}}),An={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Fn=ce({name:"EyeOutline",render:function(d,l){return D(),N("svg",An,l[0]||(l[0]=[y("path",{d:"M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 0 0-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 0 0 0-17.47C428.89 172.28 347.8 112 255.66 112z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("circle",{cx:"256",cy:"256",r:"80",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1)]))}}),Tn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Un=ce({name:"FingerPrintOutline",render:function(d,l){return D(),N("svg",Tn,l[0]||(l[0]=[y("path",{d:"M390.42 75.28a10.45 10.45 0 0 1-5.32-1.44C340.72 50.08 302.35 40 256.35 40c-45.77 0-89.23 11.28-128.76 33.84C122 77 115.11 74.8 111.87 69a12.4 12.4 0 0 1 4.63-16.32A281.81 281.81 0 0 1 256.35 16c49.23 0 92.23 11.28 139.39 36.48a12 12 0 0 1 4.85 16.08a11.3 11.3 0 0 1-10.17 6.72zm-330.79 126a11.73 11.73 0 0 1-6.7-2.16a12.26 12.26 0 0 1-2.78-16.8c22.89-33.6 52-60 86.69-78.48c72.58-38.84 165.51-39.12 238.32-.24c34.68 18.48 63.8 44.64 86.69 78a12.29 12.29 0 0 1-2.78 16.8a11.26 11.26 0 0 1-16.18-2.88c-20.8-30.24-47.15-54-78.36-70.56c-66.34-35.28-151.18-35.28-217.29.24c-31.44 16.8-57.79 40.8-78.59 71a10 10 0 0 1-9.02 5.08zM204.1 491a10.66 10.66 0 0 1-8.09-3.6C175.9 466.48 165 453 149.55 424c-16-29.52-24.27-65.52-24.27-104.16c0-71.28 58.71-129.36 130.84-129.36S387 248.56 387 319.84a11.56 11.56 0 1 1-23.11 0c0-58.08-48.32-105.36-107.72-105.36S148.4 261.76 148.4 319.84c0 34.56 7.39 66.48 21.49 92.4c14.8 27.6 25 39.36 42.77 58.08a12.67 12.67 0 0 1 0 17a12.44 12.44 0 0 1-8.56 3.68zm165.75-44.4c-27.51 0-51.78-7.2-71.66-21.36a129.1 129.1 0 0 1-55-105.36a11.57 11.57 0 1 1 23.12 0a104.28 104.28 0 0 0 44.84 85.44c16.41 11.52 35.6 17 58.72 17a147.41 147.41 0 0 0 24-2.4c6.24-1.2 12.25 3.12 13.4 9.84a11.92 11.92 0 0 1-9.47 13.92a152.28 152.28 0 0 1-27.95 2.88zM323.38 496a13 13 0 0 1-3-.48c-36.76-10.56-60.8-24.72-86-50.4c-32.37-33.36-50.16-77.76-50.16-125.28c0-38.88 31.9-70.56 71.19-70.56s71.2 31.68 71.2 70.56c0 25.68 21.5 46.56 48.08 46.56s48.08-20.88 48.08-46.56c0-90.48-75.13-163.92-167.59-163.92c-65.65 0-125.75 37.92-152.79 96.72c-9 19.44-13.64 42.24-13.64 67.2c0 18.72 1.61 48.24 15.48 86.64c2.32 6.24-.69 13.2-6.7 15.36a11.34 11.34 0 0 1-14.79-7a276.39 276.39 0 0 1-16.88-95c0-28.8 5.32-55 15.72-77.76c30.75-67 98.94-110.4 173.6-110.4c105.18 0 190.71 84.24 190.71 187.92c0 38.88-31.9 70.56-71.2 70.56s-71.2-31.68-71.2-70.56c.01-25.68-21.49-46.6-48.07-46.6s-48.08 20.88-48.08 46.56c0 41 15.26 79.44 43.23 108.24c22 22.56 43 35 75.59 44.4c6.24 1.68 9.71 8.4 8.09 14.64a11.39 11.39 0 0 1-10.87 9.16z",fill:"currentColor"},null,-1)]))}}),Dn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},En=ce({name:"FolderOutline",render:function(d,l){return D(),N("svg",Dn,l[0]||(l[0]=[y("path",{d:"M440 432H72a40 40 0 0 1-40-40V120a40 40 0 0 1 40-40h75.89a40 40 0 0 1 22.19 6.72l27.84 18.56a40 40 0 0 0 22.19 6.72H440a40 40 0 0 1 40 40v240a40 40 0 0 1-40 40z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 192h448"},null,-1)]))}}),Mn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Bn=ce({name:"HomeOutline",render:function(d,l){return D(),N("svg",Mn,l[0]||(l[0]=[y("path",{d:"M80 212v236a16 16 0 0 0 16 16h96V328a24 24 0 0 1 24-24h80a24 24 0 0 1 24 24v136h96a16 16 0 0 0 16-16V212",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{d:"M480 256L266.89 52c-5-5.28-16.69-5.34-21.78 0L32 256",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 179V64h-48v69"},null,-1)]))}}),Rn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},On=ce({name:"MoonOutline",render:function(d,l){return D(),N("svg",Rn,l[0]||(l[0]=[y("path",{d:"M160 136c0-30.62 4.51-61.61 16-88C99.57 81.27 48 159.32 48 248c0 119.29 96.71 216 216 216c88.68 0 166.73-51.57 200-128c-26.39 11.49-57.38 16-88 16c-119.29 0-216-96.71-216-216z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),zn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},In=ce({name:"PauseOutline",render:function(d,l){return D(),N("svg",zn,l[0]||(l[0]=[y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M176 96h16v320h-16z"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M320 96h16v320h-16z"},null,-1)]))}}),Ln={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Nn=ce({name:"PlayCircleOutline",render:function(d,l){return D(),N("svg",Ln,l[0]||(l[0]=[y("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),y("path",{d:"M216.32 334.44l114.45-69.14a10.89 10.89 0 0 0 0-18.6l-114.45-69.14a10.78 10.78 0 0 0-16.32 9.31v138.26a10.78 10.78 0 0 0 16.32 9.31z",fill:"currentColor"},null,-1)]))}}),jn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Hn=ce({name:"PlayOutline",render:function(d,l){return D(),N("svg",jn,l[0]||(l[0]=[y("path",{d:"M112 111v290c0 17.44 17 28.52 31 20.16l247.9-148.37c12.12-7.25 12.12-26.33 0-33.58L143 90.84c-14-8.36-31 2.72-31 20.16z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1)]))}}),Vn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Xn=ce({name:"PlaySkipForwardOutline",render:function(d,l){return D(),N("svg",Vn,l[0]||(l[0]=[y("path",{d:"M112 111v290c0 17.44 17 28.52 31 20.16l247.9-148.37c12.12-7.25 12.12-26.33 0-33.58L143 90.84c-14-8.36-31 2.72-31 20.16z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32",d:"M400 80v352"},null,-1)]))}}),Gn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Wn=ce({name:"PowerOutline",render:function(d,l){return D(),N("svg",Gn,l[0]||(l[0]=[y("path",{d:"M378 108a191.41 191.41 0 0 1 70 148c0 106-86 192-192 192S64 362 64 256a192 192 0 0 1 69-148",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 64v192"},null,-1)]))}}),Yn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},mt=ce({name:"RefreshOutline",render:function(d,l){return D(),N("svg",Yn,l[0]||(l[0]=[y("path",{d:"M320 146s24.36-12-64-12a160 160 0 1 0 160 160",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 58l80 80l-80 80"},null,-1)]))}}),Jn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},qn=ce({name:"SaveOutline",render:function(d,l){return D(),N("svg",Jn,l[0]||(l[0]=[y("path",{d:"M380.93 57.37A32 32 0 0 0 358.3 48H94.22A46.21 46.21 0 0 0 48 94.22v323.56A46.21 46.21 0 0 0 94.22 464h323.56A46.36 46.36 0 0 0 464 417.78V153.7a32 32 0 0 0-9.37-22.63zM256 416a64 64 0 1 1 64-64a63.92 63.92 0 0 1-64 64zm48-224H112a16 16 0 0 1-16-16v-64a16 16 0 0 1 16-16h192a16 16 0 0 1 16 16v64a16 16 0 0 1-16 16z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),Kn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Zn=ce({name:"SearchOutline",render:function(d,l){return D(),N("svg",Kn,l[0]||(l[0]=[y("path",{d:"M221.09 64a157.09 157.09 0 1 0 157.09 157.09A157.1 157.1 0 0 0 221.09 64z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32",d:"M338.29 338.29L448 448"},null,-1)]))}}),Qn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},er=ce({name:"SendOutline",render:function(d,l){return D(),N("svg",Qn,l[0]||(l[0]=[y("path",{d:"M470.3 271.15L43.16 447.31a7.83 7.83 0 0 1-11.16-7V327a8 8 0 0 1 6.51-7.86l247.62-47c17.36-3.29 17.36-28.15 0-31.44l-247.63-47a8 8 0 0 1-6.5-7.85V72.59c0-5.74 5.88-10.26 11.16-8L470.3 241.76a16 16 0 0 1 0 29.39z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),tr={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},nr=ce({name:"SettingsOutline",render:function(d,l){return D(),N("svg",tr,l[0]||(l[0]=[y("path",{d:"M262.29 192.31a64 64 0 1 0 57.4 57.4a64.13 64.13 0 0 0-57.4-57.4zM416.39 256a154.34 154.34 0 0 1-1.53 20.79l45.21 35.46a10.81 10.81 0 0 1 2.45 13.75l-42.77 74a10.81 10.81 0 0 1-13.14 4.59l-44.9-18.08a16.11 16.11 0 0 0-15.17 1.75A164.48 164.48 0 0 1 325 400.8a15.94 15.94 0 0 0-8.82 12.14l-6.73 47.89a11.08 11.08 0 0 1-10.68 9.17h-85.54a11.11 11.11 0 0 1-10.69-8.87l-6.72-47.82a16.07 16.07 0 0 0-9-12.22a155.3 155.3 0 0 1-21.46-12.57a16 16 0 0 0-15.11-1.71l-44.89 18.07a10.81 10.81 0 0 1-13.14-4.58l-42.77-74a10.8 10.8 0 0 1 2.45-13.75l38.21-30a16.05 16.05 0 0 0 6-14.08c-.36-4.17-.58-8.33-.58-12.5s.21-8.27.58-12.35a16 16 0 0 0-6.07-13.94l-38.19-30A10.81 10.81 0 0 1 49.48 186l42.77-74a10.81 10.81 0 0 1 13.14-4.59l44.9 18.08a16.11 16.11 0 0 0 15.17-1.75A164.48 164.48 0 0 1 187 111.2a15.94 15.94 0 0 0 8.82-12.14l6.73-47.89A11.08 11.08 0 0 1 213.23 42h85.54a11.11 11.11 0 0 1 10.69 8.87l6.72 47.82a16.07 16.07 0 0 0 9 12.22a155.3 155.3 0 0 1 21.46 12.57a16 16 0 0 0 15.11 1.71l44.89-18.07a10.81 10.81 0 0 1 13.14 4.58l42.77 74a10.8 10.8 0 0 1-2.45 13.75l-38.21 30a16.05 16.05 0 0 0-6.05 14.08c.33 4.14.55 8.3.55 12.47z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),rr={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},xt=ce({name:"StopCircleOutline",render:function(d,l){return D(),N("svg",rr,l[0]||(l[0]=[y("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),y("path",{d:"M310.4 336H201.6a25.62 25.62 0 0 1-25.6-25.6V201.6a25.62 25.62 0 0 1 25.6-25.6h108.8a25.62 25.62 0 0 1 25.6 25.6v108.8a25.62 25.62 0 0 1-25.6 25.6z",fill:"currentColor"},null,-1)]))}}),ar={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},yt=ce({name:"TrashOutline",render:function(d,l){return D(),N("svg",ar,l[0]||(l[0]=[ft('<path d="M112 112l20 320c.95 18.49 14.4 32 32 32h184c17.67 0 30.87-13.51 32-32l20-320" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32" d="M80 112h352" fill="currentColor"></path><path d="M192 112V72h0a23.93 23.93 0 0 1 24-24h80a23.93 23.93 0 0 1 24 24h0v40" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M256 176v224"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M184 176l8 224"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M328 176l-8 224"></path>',6)]))}}),or={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ir=ce({name:"VolumeHighOutline",render:function(d,l){return D(),N("svg",or,l[0]||(l[0]=[y("path",{d:"M126 192H56a8 8 0 0 0-8 8v112a8 8 0 0 0 8 8h69.65a15.93 15.93 0 0 1 10.14 3.54l91.47 74.89A8 8 0 0 0 240 392V120a8 8 0 0 0-12.74-6.43l-91.47 74.89A15 15 0 0 1 126 192z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{d:"M320 320c9.74-19.38 16-40.84 16-64c0-23.48-6-44.42-16-64",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{d:"M368 368c19.48-33.92 32-64.06 32-112s-12-77.74-32-112",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{d:"M416 416c30-46 48-91.43 48-160s-18-113-48-160",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),sr={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},lr=ce({name:"VolumeLowOutline",render:function(d,l){return D(),N("svg",sr,l[0]||(l[0]=[y("path",{d:"M189.65 192H120a8 8 0 0 0-8 8v112a8 8 0 0 0 8 8h69.65a16 16 0 0 1 10.14 3.63l91.47 75a8 8 0 0 0 12.74-6.46V119.83a8 8 0 0 0-12.74-6.44l-91.47 75a16 16 0 0 1-10.14 3.61z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{d:"M384 320c9.74-19.41 16-40.81 16-64c0-23.51-6-44.4-16-64",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),ur={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},cr=ce({name:"VolumeMuteOutline",render:function(d,l){return D(),N("svg",ur,l[0]||(l[0]=[ft('<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32" d="M416 432L64 80"></path><path d="M224 136.92v33.8a4 4 0 0 0 1.17 2.82l24 24a4 4 0 0 0 6.83-2.82v-74.15a24.53 24.53 0 0 0-12.67-21.72a23.91 23.91 0 0 0-25.55 1.83a8.27 8.27 0 0 0-.66.51l-31.94 26.15a4 4 0 0 0-.29 5.92l17.05 17.06a4 4 0 0 0 5.37.26z" fill="currentColor"></path><path d="M224 375.08l-78.07-63.92a32 32 0 0 0-20.28-7.16H64v-96h50.72a4 4 0 0 0 2.82-6.83l-24-24a4 4 0 0 0-2.82-1.17H56a24 24 0 0 0-24 24v112a24 24 0 0 0 24 24h69.76l91.36 74.8a8.27 8.27 0 0 0 .66.51a23.93 23.93 0 0 0 25.85 1.69A24.49 24.49 0 0 0 256 391.45v-50.17a4 4 0 0 0-1.17-2.82l-24-24a4 4 0 0 0-6.83 2.82zM125.82 336z" fill="currentColor"></path><path d="M352 256c0-24.56-5.81-47.88-17.75-71.27a16 16 0 0 0-28.5 14.54C315.34 218.06 320 236.62 320 256q0 4-.31 8.13a8 8 0 0 0 2.32 6.25l19.66 19.67a4 4 0 0 0 6.75-2A146.89 146.89 0 0 0 352 256z" fill="currentColor"></path><path d="M416 256c0-51.19-13.08-83.89-34.18-120.06a16 16 0 0 0-27.64 16.12C373.07 184.44 384 211.83 384 256c0 23.83-3.29 42.88-9.37 60.65a8 8 0 0 0 1.9 8.26l16.77 16.76a4 4 0 0 0 6.52-1.27C410.09 315.88 416 289.91 416 256z" fill="currentColor"></path><path d="M480 256c0-74.26-20.19-121.11-50.51-168.61a16 16 0 1 0-27 17.22C429.82 147.38 448 189.5 448 256c0 47.45-8.9 82.12-23.59 113a4 4 0 0 0 .77 4.55L443 391.39a4 4 0 0 0 6.4-1C470.88 348.22 480 307 480 256z" fill="currentColor"></path>',6)]))}});function dr(a,d){const l=[];let v=a;for(;v;){const g=fr(v,d);l.unshift(g),v=jt(v,d)}return"/"+l.join("/")}function fr(a,d){if(a.resource_id)return`*[@resource-id="${a.resource_id}"]`;if(a.text&&a.text.trim())return`*[@text="${a.text}"]`;if(a.label&&a.label.trim())return`*[@label="${a.label}"]`;const l=a.class_name||"*",v=jt(a,d);if(v){const g=v.children?.filter(x=>x.class_name===a.class_name)||[];if(g.length>1){const x=g.findIndex(E=>E.key===a.key);return`${l}[${x+1}]`}}return l}function jt(a,d){for(const l of d)if(l.children?.some(v=>v.key===a.key))return l}function hr(a){const d=[];function l(v){d.push(v),v.children?.forEach(l)}return a.forEach(l),d}const rt=Jt("device",()=>{const a=H("android"),d=H(""),l=H(null),v=H(null),g=H(null),x=H(!1),E=H(null),F=H(0),$=de(()=>l.value?{width:l.value.width,height:l.value.height}:{width:0,height:0}),O=de(()=>d.value?(F.value,un(a.value,d.value)):"");function w(C,A){a.value=C,d.value=A,l.value=null,v.value=null,E.value=null}async function _(){if(d.value){x.value=!0,E.value=null;try{l.value=await It(a.value,d.value),F.value++}catch(C){E.value=C instanceof Error?C.message:String(C)}finally{x.value=!1}}}function S(C){if(C&&l.value){const A=hr(l.value.nodes);C.xpath=dr(C,A)}v.value=C}function j(){F.value++}function I(C){g.value=C}function B(C){C.hierarchy&&(l.value=C.hierarchy),C.screenshot&&F.value++}return{platform:a,serial:d,hierarchy:l,selectedNode:v,hoveredNode:g,loading:x,error:E,screenSize:$,screenshotUrl:O,setDevice:w,refreshHierarchy:_,selectNode:S,refreshScreenshot:j,setHoveredNode:I,updateFromRemote:B}});class gt{name;style;constructor(d,l){this.name=d,this.style=l}}class pr extends gt{x;y;width;height;constructor(d,l,v,g,x){super("rect",x),this.x=d,this.y=l,this.width=v,this.height=g}draw(d){d.beginPath(),d.rect(this.x,this.y,this.width,this.height),this.style==="select"?(d.fillStyle="rgba(255, 255, 0, 0.3)",d.strokeStyle="#FFD700",d.lineWidth=3):this.style==="hover"&&(d.fillStyle="rgba(0, 150, 255, 0.2)",d.strokeStyle="#0096FF",d.lineWidth=2),d.fill(),d.stroke()}}class vr extends gt{x;y;canvasWidth;canvasHeight;constructor(d,l,v,g){super("crosshair","crosshair"),this.x=d,this.y=l,this.canvasWidth=v,this.canvasHeight=g}draw(d){d.beginPath(),d.strokeStyle="#FF0000",d.lineWidth=1,d.setLineDash([5,5]),d.moveTo(0,this.y),d.lineTo(this.canvasWidth,this.y),d.moveTo(this.x,0),d.lineTo(this.x,this.canvasHeight),d.stroke(),d.setLineDash([])}}class mr extends gt{points;constructor(d){super("track","hover"),this.points=d}draw(d){if(this.points.length<2)return;d.beginPath(),d.strokeStyle="rgba(0, 150, 255, 0.8)",d.lineWidth=3,d.lineCap="round",d.lineJoin="round";const l=this.points[0];l&&d.moveTo(l.x,l.y);for(let v=1;v<this.points.length;v++){const g=this.points[v];g&&d.lineTo(g.x,g.y)}d.stroke()}}function xr(){const a=H(null),d=de(()=>a.value?.getContext("2d")||null),l=H([]);function v(_){return _.every(S=>Number.isFinite(S)&&S>=0&&S<=1)}function g(){if(!d.value||!a.value)return;const _=a.value;d.value.clearRect(0,0,_.width,_.height),l.value.forEach(S=>{d.value&&S.draw(d.value)})}function x(_,S){if(!a.value)return;const[j,I,B,C]=_,A=a.value.width,Z=a.value.height,Q=v(_),ve=Q?j*A:j,_e=Q?I*Z:I,Pe=Q?B*A:B,fe=Q?C*Z:C,L=Math.min(ve,Pe),P=Math.min(_e,fe),z=Math.abs(Pe-ve),V=Math.abs(fe-_e);l.value.push(new pr(L,P,z,V,S)),g()}function E(_,S){a.value&&(l.value.push(new vr(_,S,a.value.width,a.value.height)),g())}function F(_){l.value.push(new mr(_)),g()}function $(){l.value=[],g()}function O(_){l.value=l.value.filter(S=>S.style!==_),g()}function w(_,S){a.value&&(a.value.width=_,a.value.height=S,g())}return{canvasRef:a,addRect:x,addCrosshair:E,addTrack:F,clearShapes:$,clearShapesByType:O,resizeCanvas:w,redraw:g}}function yr(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function gr(a){if(Object.prototype.hasOwnProperty.call(a,"__esModule"))return a;var d=a.default;if(typeof d=="function"){var l=function v(){var g=!1;try{g=this instanceof v}catch{}return g?Reflect.construct(d,arguments,this.constructor):d.apply(this,arguments)};l.prototype=d.prototype}else l={};return Object.defineProperty(l,"__esModule",{value:!0}),Object.keys(a).forEach(function(v){var g=Object.getOwnPropertyDescriptor(a,v);Object.defineProperty(l,v,g.get?g:{enumerable:!0,get:function(){return a[v]}})}),l}var Qe={exports:{}};const wr={},kr=Object.freeze(Object.defineProperty({__proto__:null,default:wr},Symbol.toStringTag,{value:"Module"})),br=gr(kr);var Sr=Qe.exports,Ut;function _r(){return Ut||(Ut=1,(function(a,d){(function(l,v){a.exports=v(br)})(Sr,(function(l){function v(n,c){(c==null||c>n.length)&&(c=n.length);for(var e=0,t=Array(c);e<c;e++)t[e]=n[e];return t}function g(n){if(Array.isArray(n))return n}function x(n){if(Array.isArray(n))return v(n)}function E(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function F(n,c){if(!(n instanceof c))throw new TypeError("Cannot call a class as a function")}function $(n,c){for(var e=0;e<c.length;e++){var t=c[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,P(t.key),t)}}function O(n,c,e){return c&&$(n.prototype,c),e&&$(n,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function w(n,c){var e=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=V(n))||c){e&&(n=e);var t=0,r=function(){};return{s:r,n:function(){return t>=n.length?{done:!0}:{done:!1,value:n[t++]}},e:function(k){throw k},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,f=!0,m=!1;return{s:function(){e=e.call(n)},n:function(){var k=e.next();return f=k.done,k},e:function(k){m=!0,o=k},f:function(){try{f||e.return==null||e.return()}finally{if(m)throw o}}}}function _(n){var c=B();return function(){var e,t=j(n);if(c){var r=j(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return ve(this,e)}}function S(n,c,e){return(c=P(c))in n?Object.defineProperty(n,c,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[c]=e,n}function j(n){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(c){return c.__proto__||Object.getPrototypeOf(c)},j(n)}function I(n,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(c&&c.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),c&&_e(n,c)}function B(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(B=function(){return!!n})()}function C(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function A(n,c){var e=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(e!=null){var t,r,o,f,m=[],k=!0,b=!1;try{if(o=(e=e.call(n)).next,c!==0)for(;!(k=(t=o.call(e)).done)&&(m.push(t.value),m.length!==c);k=!0);}catch(i){b=!0,r=i}finally{try{if(!k&&e.return!=null&&(f=e.return(),Object(f)!==f))return}finally{if(b)throw r}}return m}}function Z(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ve(n,c){if(c&&(typeof c=="object"||typeof c=="function"))return c;if(c!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E(n)}function _e(n,c){return _e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_e(n,c)}function Pe(n,c){return g(n)||A(n,c)||V(n,c)||Z()}function fe(n){return x(n)||C(n)||V(n)||Q()}function L(n,c){if(typeof n!="object"||!n)return n;var e=n[Symbol.toPrimitive];if(e!==void 0){var t=e.call(n,c);if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function P(n){var c=L(n,"string");return typeof c=="symbol"?c:c+""}function z(n){"@babel/helpers - typeof";return z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},z(n)}function V(n,c){if(n){if(typeof n=="string")return v(n,c);var e={}.toString.call(n).slice(8,-1);return e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set"?Array.from(n):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?v(n,c):void 0}}var Y,ee;function Ce(n,c){Y=n,ee=c}function pe(n){if(Y){for(var c=arguments.length,e=new Array(c>1?c-1:0),t=1;t<c;t++)e[t-1]=arguments[t];Y.apply(void 0,[n].concat(e))}}function oe(n){if(ee){for(var c=arguments.length,e=new Array(c>1?c-1:0),t=1;t<c;t++)e[t-1]=arguments[t];ee.apply(void 0,[n].concat(e))}}var M=(function(){function n(c){F(this,n),this.listener={},this.type=c|""}return O(n,[{key:"on",value:function(e,t){return this.listener[e]||(this.listener[e]=[]),this.listener[e].push(t),!0}},{key:"off",value:function(e,t){if(this.listener[e]){var r=this.listener[e].indexOf(t);return r>-1&&this.listener[e].splice(r,1),!0}return!1}},{key:"offAll",value:function(){this.listener={}}},{key:"dispatch",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return this.listener[e]?(this.listener[e].map(function(f){f.apply(null,r)}),!0):!1}}]),n})(),q=(function(){function n(){F(this,n)}return O(n,null,[{key:"init",value:function(){n.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hev1:[],hvcC:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var e;for(e in n.types)n.types.hasOwnProperty(e)&&(n.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);n.HDLR_TYPES={video:t,audio:r};var o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),f=new Uint8Array([0,0,0,0,0,0,0,0]);n.STTS=n.STSC=n.STCO=f,n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),n.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var m=new Uint8Array([105,115,111,109]),k=new Uint8Array([97,118,99,49]),b=new Uint8Array([0,0,0,1]);n.FTYP=n.box(n.types.ftyp,m,b,m,k),n.DINF=n.box(n.types.dinf,n.box(n.types.dref,o))}},{key:"box",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];for(var f=8,m=r.length,k=m,b;m--;)f+=r[m].byteLength;for(b=new Uint8Array(f),b[0]=f>>24&255,b[1]=f>>16&255,b[2]=f>>8&255,b[3]=f&255,b.set(e,4),m=0,f=8;m<k;++m)b.set(r[m],f),f+=r[m].byteLength;return b}},{key:"hdlr",value:function(e){return n.box(n.types.hdlr,n.HDLR_TYPES[e])}},{key:"mdat",value:function(e){return n.box(n.types.mdat,e)}},{key:"mdhd",value:function(e,t){return n.box(n.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,85,196,0,0]))}},{key:"mdia",value:function(e){return n.box(n.types.mdia,n.mdhd(e.timescale,e.duration),n.hdlr(e.type),n.minf(e))}},{key:"mfhd",value:function(e){return n.box(n.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}},{key:"minf",value:function(e){return e.type==="audio"?n.box(n.types.minf,n.box(n.types.smhd,n.SMHD),n.DINF,n.stbl(e)):n.box(n.types.minf,n.box(n.types.vmhd,n.VMHD),n.DINF,n.stbl(e))}},{key:"moof",value:function(e,t,r){return n.box(n.types.moof,n.mfhd(e),n.traf(r,t))}},{key:"moov",value:function(e,t,r){for(var o=e.length,f=[];o--;)f[o]=n.trak(e[o]);return n.box.apply(null,[n.types.moov,n.mvhd(r,t)].concat(f).concat(n.mvex(e)))}},{key:"mvex",value:function(e){for(var t=e.length,r=[];t--;)r[t]=n.trex(e[t]);return n.box.apply(null,[n.types.mvex].concat(r))}},{key:"mvhd",value:function(e,t){var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,e>>24&255,e>>16&255,e>>8&255,e&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return n.box(n.types.mvhd,r)}},{key:"sdtp",value:function(e){var t=e.samples||[],r=new Uint8Array(4+t.length),o,f;for(f=0;f<t.length;f++)o=t[f].flags,r[f+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return n.box(n.types.sdtp,r)}},{key:"stbl",value:function(e){return n.box(n.types.stbl,n.stsd(e),n.box(n.types.stts,n.STTS),n.box(n.types.stsc,n.STSC),n.box(n.types.stsz,n.STSZ),n.box(n.types.stco,n.STCO))}},{key:"avc1",value:function(e){var t=[],r=[],o,f,m;for(o=0;o<e.sps.length;o++)f=e.sps[o],m=f.byteLength,t.push(m>>>8&255),t.push(m&255),t=t.concat(Array.prototype.slice.call(f));for(o=0;o<e.pps.length;o++)f=e.pps[o],m=f.byteLength,r.push(m>>>8&255),r.push(m&255),r=r.concat(Array.prototype.slice.call(f));var k=n.box(n.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),b=e.width,i=e.height;return n.box(n.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,b>>8&255,b&255,i>>8&255,i&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,98,105,110,101,108,112,114,111,46,114,117,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),k,n.box(n.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"hev1",value:function(e){for(var t=[],r=[],o=[],f,m,k=0;k<(((b=e.vps)===null||b===void 0?void 0:b.length)||0);k++){var b;f=e.vps[k],m=f.byteLength,t.push(m>>>8&255,m&255),t=t.concat(Array.prototype.slice.call(f))}for(var i=0;i<(((p=e.sps)===null||p===void 0?void 0:p.length)||0);i++){var p;f=e.sps[i],m=f.byteLength,r.push(m>>>8&255,m&255),r=r.concat(Array.prototype.slice.call(f))}for(var T=0;T<(((R=e.pps)===null||R===void 0?void 0:R.length)||0);T++){var R;f=e.pps[T],m=f.byteLength,o.push(m>>>8&255,m&255),o=o.concat(Array.prototype.slice.call(f))}var re=e.hvcC,he=re.profile_space,xe=re.tier_flag,ke=re.profile_idc,$e=re.profile_compatibility_flags,Se=re.constraint_indicator_flags,We=re.level_idc,Ve=re.chroma_format_idc,Ye=n.box(n.types.hvcC,new Uint8Array([1,he<<6|xe<<5|ke,$e>>24&255,$e>>16&255,$e>>8&255,$e&255].concat(fe(Se),[We,240,0,252,252|Ve,248,248,0,0,3,3,32,0,1],fe(t),[33,0,1],fe(r),[34,0,1],fe(o)))),Xe=e.width,ge=e.height;return n.box(n.types.hev1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Xe>>8&255,Xe&255,ge>>8&255,ge&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,98,105,110,101,108,112,114,111,46,114,117,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),Ye,n.box(n.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(e){var t=e.config.byteLength,r=new Uint8Array(26+t+3);return r.set([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5,t]),r.set(e.config,26),r.set([6,1,2],26+t),r}},{key:"mp4a",value:function(e){var t=e.audiosamplerate;return n.box(n.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]),n.box(n.types.esds,n.esds(e)))}},{key:"stsd",value:function(e){return e.type==="audio"?n.box(n.types.stsd,n.STSD,n.mp4a(e)):e.codec.startsWith("hvc1")?n.box(n.types.stsd,n.STSD,n.hev1(e)):n.box(n.types.stsd,n.STSD,n.avc1(e))}},{key:"tkhd",value:function(e){var t=e.id,r=e.duration,o=e.width,f=e.height,m=e.volume;return n.box(n.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,r&255,0,0,0,0,0,0,0,0,0,0,0,0,m>>0&255,m%1*10>>0&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>8&255,o&255,0,0,f>>8&255,f&255,0,0]))}},{key:"traf",value:function(e,t){var r=n.sdtp(e),o=e.id;return n.box(n.types.traf,n.box(n.types.tfhd,new Uint8Array([0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255])),n.box(n.types.tfdt,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255])),n.trun(e,r.length+16+16+8+16+8+8),r)}},{key:"trak",value:function(e){return e.duration=e.duration||4294967295,n.box(n.types.trak,n.tkhd(e),n.mdia(e))}},{key:"trex",value:function(e){var t=e.id;return n.box(n.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(e,t){var r=e.samples||[],o=r.length,f=12+16*o,m=new Uint8Array(f),k,b,i,p,T,R;for(t+=8+f,m.set([0,0,15,1,o>>>24&255,o>>>16&255,o>>>8&255,o&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),k=0;k<o;k++)b=r[k],i=b.duration,p=b.size,T=b.flags,R=b.cts,m.set([i>>>24&255,i>>>16&255,i>>>8&255,i&255,p>>>24&255,p>>>16&255,p>>>8&255,p&255,T.isLeading<<2|T.dependsOn,T.isDependedOn<<6|T.hasRedundancy<<4|T.paddingValue<<1|T.isNonSync,T.degradPrio&61440,T.degradPrio&15,R>>>24&255,R>>>16&255,R>>>8&255,R&255],12+16*k);return n.box(n.types.trun,m)}},{key:"initSegment",value:function(e,t,r){n.types||n.init();var o=n.moov(e,t,r),f;return f=new Uint8Array(n.FTYP.byteLength+o.byteLength),f.set(n.FTYP),f.set(o,n.FTYP.byteLength),f}}]),n})(),te=(function(){function n(){F(this,n)}return O(n,null,[{key:"samplingRateMap",get:function(){return[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]}},{key:"getHeaderLength",value:function(e){return e[1]&1?7:9}},{key:"getFrameLength",value:function(e){return(e[3]&3)<<11|e[4]<<3|(e[5]&224)>>>5}},{key:"isAACPattern",value:function(e){return e[0]===255&&(e[1]&240)===240&&(e[1]&6)===0}},{key:"extractAAC",value:function(e){var t=0,r=e.byteLength,o=[],f,m;if(!n.isAACPattern(e))return oe("Invalid ADTS audio format"),{valid:!1};f=n.getHeaderLength(e);for(var k=e.subarray(0,f);t<r;)m=n.getFrameLength(e),o.push(e.subarray(f,m)),e=e.slice(m),t+=m;return{valid:!0,header:k,slices:o}}}]),n})(),ye=1,X=(function(n){I(e,n);var c=_(e);function e(){return F(this,e),c.apply(this,arguments)}return O(e,[{key:"flush",value:function(){this.mp4track.len=0,this.mp4track.samples=[]}},{key:"isReady",value:function(){return!this.readyToDecode||!this.samples.length?null:!0}}],[{key:"getTrackID",value:function(){return ye++}}]),e})(M),J=(function(n){I(e,n);var c=_(e);function e(t,r,o){var f;return F(this,e),f=c.call(this,"AACRemuxer"),f.frameDuration=o,f.readyToDecode=!1,f.header=null,f.nextDts=0,f.dts=0,f.mp4track={id:X.getTrackID(),type:"audio",channelCount:0,len:0,fragmented:!0,timescale:t,duration:r,samples:[],config:"",codec:""},f.samples=[],f}return O(e,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.header=null,this.mp4track.codec="",this.mp4track.channelCount="",this.mp4track.config="",this.mp4track.timescale=this.timescale,this.nextDts=0,this.dts=0}},{key:"feed",value:function(r,o){var f=te.extractAAC(r),m=f.valid,k=f.header,b=f.slices;return this.header||(this.header=k),m&&b.length>0?(this.remux(this.getAudioFrames(b,o)),!0):(oe("Failed to extract audio data from:",r),this.dispatch("outOfData"),!1)}},{key:"getAudioFrames",value:function(r,o){var f=[],m=0,k=0,b=w(r),i;try{for(b.s();!(i=b.n()).done;){var p=i.value;f.push({units:p})}}catch(T){b.e(T)}finally{b.f()}return m=o?o/f.length|0:this.frameDuration,k=o?o-m*f.length:0,f.map(function(T){T.duration=m,k>0&&(T.duration++,k--)}),f}},{key:"remux",value:function(r){if(r.length>0)for(var o=0;o<r.length;o++){var f=r[o],m=f.units,k=m.byteLength;this.samples.push({units:m,size:k,duration:f.duration}),this.mp4track.len+=k,this.readyToDecode||this.setAACConfig()}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var r=new Uint8Array(this.mp4track.len),o=0,f=this.mp4track.samples,m,k;for(this.dts=this.nextDts;this.samples.length;){var b=this.samples.shift();if(b.units,k=b.duration,k<=0){pe("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(k)),this.mp4track.len-=b.size;continue}this.nextDts+=k,m={size:b.size,duration:k,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},r.set(b.units,o),o+=b.size,f.push(m)}return f.length?new Uint8Array(r.buffer,0,this.mp4track.len):null}},{key:"setAACConfig",value:function(){var r,o,f,m=new Uint8Array(2);this.header&&(r=((this.header[2]&192)>>>6)+1,o=(this.header[2]&60)>>>2,f=(this.header[2]&1)<<2,f|=(this.header[3]&192)>>>6,m[0]=r<<3,m[0]|=(o&14)>>1,m[1]|=(o&1)<<7,m[1]|=f<<3,this.mp4track.codec="mp4a.40."+r,this.mp4track.channelCount=f,this.mp4track.config=m,this.readyToDecode=!0)}}]),e})(X),ae=(function(){function n(c){F(this,n),this.data=c,this.index=0,this.bitLength=c.byteLength*8}return O(n,[{key:"setData",value:function(e){this.data=e,this.index=0,this.bitLength=e.byteLength*8}},{key:"bitsAvailable",get:function(){return this.bitLength-this.index}},{key:"skipBits",value:function(e){if(this.bitsAvailable<e)return!1;this.index+=e}},{key:"readBits",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this.getBits(e,this.index,t);return r}},{key:"getBits",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(this.bitsAvailable<e)return 0;var o=t%8,f=this.data[t/8|0]&255>>>o,m=8-o;if(m>=e)return r&&(this.index+=e),f>>m-e;r&&(this.index+=m);var k=e-m;return f<<k|this.getBits(k,t+m,r)}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitLength-this.index;++e)if(this.getBits(1,this.index+e,!1)!==0)return this.index+=e,e;return e}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return this.readBits(1)===1}},{key:"readUByte",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return this.readBits(e*8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}}]),n})(),Ae=(function(){function n(){F(this,n)}return O(n,null,[{key:"extractNALu",value:function(e){for(var t=0,r=e.byteLength,o=[],f=0,m=0;t<r;){var k=e[t++];if(k===0)m++;else if(k===1&&m>=2){var b=m+1;f!==t-b&&o.push(e.subarray(f,t-b)),f=t,m=0}else m=0}var i=null;return f<r&&(i=e.subarray(f,r)),[o,i]}},{key:"skipScalingList",value:function(e,t){for(var r=8,o=8,f,m=0;m<t;m++)o!==0&&(f=e.readEG(),o=(r+f+256)%256),r=o===0?r:o}},{key:"readSPS",value:function(e){var t=new ae(e),r=0,o=0,f=0,m=0,k=1,b,i,p,T,R,re,he=0;t.readUByte();for(var xe=[],ke=1,$e=e.byteLength,Se=ke;Se<$e;Se++)Se+2<$e&&t.readBits(24,!1)===3?(xe.push(t.readBits(8)),xe.push(t.readBits(8)),Se+=2,t.readBits(8)):xe.push(t.readBits(8));if(t.setData(new Uint8Array(xe)),b=t.readUByte(),t.readBits(5),t.skipBits(3),t.readUByte(),t.skipUEG(),b===100||b===110||b===122||b===244||b===44||b===83||b===86||b===118||b===128){var We=t.readUEG();if(We===3&&t.skipBits(1),t.skipUEG(),t.skipUEG(),t.skipBits(1),t.readBoolean()){re=We!==3?8:12;for(var Ve=0;Ve<re;++Ve)t.readBoolean()&&(Ve<6?n.skipScalingList(t,16):n.skipScalingList(t,64))}}t.skipUEG();var Ye=t.readUEG();if(Ye===0)t.readUEG();else if(Ye===1){t.skipBits(1),t.skipEG(),t.skipEG(),i=t.readUEG();for(var Xe=0;Xe<i;++Xe)t.skipEG()}if(t.skipUEG(),t.skipBits(1),p=t.readUEG(),T=t.readUEG(),R=t.readBits(1),R===0&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(r=t.readUEG(),o=t.readUEG(),f=t.readUEG(),m=t.readUEG()),t.readBoolean()){if(t.readBoolean()){var ge,ot=t.readUByte();switch(ot){case 1:ge=[1,1];break;case 2:ge=[12,11];break;case 3:ge=[10,11];break;case 4:ge=[16,11];break;case 5:ge=[40,33];break;case 6:ge=[24,11];break;case 7:ge=[20,11];break;case 8:ge=[32,11];break;case 9:ge=[80,33];break;case 10:ge=[18,11];break;case 11:ge=[15,11];break;case 12:ge=[64,33];break;case 13:ge=[160,99];break;case 14:ge=[4,3];break;case 15:ge=[3,2];break;case 16:ge=[2,1];break;case 255:{ge=[t.readUByte()<<8|t.readUByte(),t.readUByte()<<8|t.readUByte()];break}}ge&&ge[0]>0&&ge[1]>0&&(k=ge[0]/ge[1])}if(t.readBoolean()&&t.skipBits(1),t.readBoolean()&&(t.skipBits(4),t.readBoolean()&&t.skipBits(24)),t.readBoolean()&&(t.skipUEG(),t.skipUEG()),t.readBoolean()){var it=t.readUInt(),st=t.readUInt(),Ze=t.readBoolean(),lt=st/(2*it);Ze&&(he=lt)}}return{fps:he>0?he:void 0,width:Math.ceil(((p+1)*16-r*2-o*2)*k),height:(2-R)*(T+1)*16-(R?2:4)*(f+m)}}}]),n})(),Me=(function(){function n(c){F(this,n),this.payload=c,this.nri=(this.payload[0]&96)>>5,this.nalUnitType=this.payload[0]&31,this._sliceType=null,this._isFirstSlice=!1}return O(n,[{key:"toString",value:function(){return"".concat(n.TYPES[this.type()]||"UNKNOWN",": NRI: ").concat(this.getNri())}},{key:"getNri",value:function(){return this.nri}},{key:"type",value:function(){return this.nalUnitType}},{key:"isKeyframe",get:function(){return this.nalUnitType===n.IDR}},{key:"isVCL",get:function(){return this.nalUnitType==n.IDR||this.nalUnitType==n.NDR}},{key:"parseHeader",value:function(){var e=new ae(this.getPayload());e.readUByte(),this._isFirstSlice=e.readUEG()===0,this._sliceType=e.readUEG()}},{key:"isFirstSlice",get:function(){return this._isFirstSlice||this.parseHeader(),this._isFirstSlice}},{key:"sliceType",get:function(){return this._sliceType||this.parseHeader(),this._sliceType}},{key:"getPayload",value:function(){return this.payload}},{key:"getPayloadSize",value:function(){return this.payload.byteLength}},{key:"getSize",value:function(){return 4+this.getPayloadSize()}},{key:"getData",value:function(){var e=new Uint8Array(this.getSize()),t=new DataView(e.buffer);return t.setUint32(0,this.getSize()-4),e.set(this.getPayload(),4),e}}],[{key:"NDR",get:function(){return 1}},{key:"IDR",get:function(){return 5}},{key:"SEI",get:function(){return 6}},{key:"SPS",get:function(){return 7}},{key:"PPS",get:function(){return 8}},{key:"AUD",get:function(){return 9}},{key:"TYPES",get:function(){var e;return e={},S(e,n.IDR,"IDR"),S(e,n.SEI,"SEI"),S(e,n.SPS,"SPS"),S(e,n.PPS,"PPS"),S(e,n.NDR,"NDR"),S(e,n.AUD,"AUD"),e}}]),n})();function Be(n,c){var e=new Uint8Array((n.byteLength|0)+(c.byteLength|0));return e.set(n,0),e.set(c,n.byteLength|0),e}function G(n){var c,e,t,r="";return c=Math.floor(n),e=parseInt(c/3600,10)%24,t=parseInt(c/60,10)%60,c=c<0?0:c%60,e>0&&(r+=(e<10?"0"+e:e)+":"),r+=(t<10?"0"+t:t)+":"+(c<10?"0"+c:c),r}var W=(function(n){I(e,n);var c=_(e);function e(t,r,o){var f;return F(this,e),f=c.call(this,"H264Remuxer"),f.frameDuration=o,f.readyToDecode=!1,f.nextDts=0,f.dts=0,f.mp4track={id:X.getTrackID(),type:"video",len:0,fragmented:!0,sps:"",pps:"",fps:30,width:0,height:0,timescale:t,duration:r,samples:[]},f.samples=[],f.remainingData=new Uint8Array,f.kfCounter=0,f.pendingUnits={},f}return O(e,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.mp4track.sps="",this.mp4track.pps="",this.nextDts=0,this.dts=0,this.remainingData=new Uint8Array,this.kfCounter=0,this.pendingUnits={}}},{key:"feed",value:function(r,o,f){var m=[],k;r=Be(this.remainingData,r);var b=Ae.extractNALu(r),i=Pe(b,2);return m=i[0],k=i[1],this.remainingData=k||new Uint8Array,m.length>0?(this.remux(this.getVideoFrames(m,o,f)),!0):(oe("Failed to extract any NAL units from video data:",k),this.dispatch("outOfData"),!1)}},{key:"getVideoFrames",value:function(r,o,f){var m=this,k=[],b=[],i=0,p=0,T=!1,R=!1;this.pendingUnits.units&&(k=this.pendingUnits.units,R=this.pendingUnits.vcl,T=this.pendingUnits.keyFrame,this.pendingUnits={});var re=w(r),he;try{for(re.s();!(he=re.n()).done;){var xe=he.value,ke=new Me(xe);k.length&&R&&(ke.isFirstSlice||!ke.isVCL)&&(b.push({units:k,keyFrame:T}),k=[],T=!1,R=!1),k.push(ke),T=T||ke.isKeyframe,R=R||ke.isVCL}}catch(Se){re.e(Se)}finally{re.f()}if(k.length)if(!o)this.pendingUnits={units:k,keyFrame:T,vcl:R};else if(R)b.push({units:k,keyFrame:T});else{var $e=b.length-1;$e>=0&&(b[$e].units=b[$e].units.concat(k))}return i=o?o/b.length|0:this.frameDuration,p=o?o-i*b.length:0,b.map(function(Se){Se.duration=i,Se.compositionTimeOffset=f,p>0&&(Se.duration++,p--),m.kfCounter++,Se.keyFrame&&m.dispatch("keyframePosition",m.kfCounter*i/1e3)}),pe("jmuxer: No. of H264 frames of the last chunk: ".concat(b.length)),b}},{key:"remux",value:function(r){var o=w(r),f;try{for(o.s();!(f=o.n()).done;){var m=f.value,k=[],b=0,i=w(m.units),p;try{for(i.s();!(p=i.n()).done;){var T=p.value;this.parseNAL(T)&&(k.push(T),b+=T.getSize())}}catch(R){i.e(R)}finally{i.f()}k.length>0&&this.readyToDecode&&(this.mp4track.len+=b,this.samples.push({units:k,size:b,keyFrame:m.keyFrame,duration:m.duration,compositionTimeOffset:m.compositionTimeOffset}))}}catch(R){o.e(R)}finally{o.f()}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var r=new Uint8Array(this.mp4track.len),o=0,f=this.mp4track.samples,m,k;for(this.dts=this.nextDts;this.samples.length;){var b=this.samples.shift(),i=b.units;if(k=b.duration,k<=0){pe("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(k)),this.mp4track.len-=b.size;continue}this.nextDts+=k,m={size:b.size,duration:k,cts:b.compositionTimeOffset||0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,isNonSync:b.keyFrame?0:1,dependsOn:b.keyFrame?2:1}};var p=w(i),T;try{for(p.s();!(T=p.n()).done;){var R=T.value;r.set(R.getData(),o),o+=R.getSize()}}catch(re){p.e(re)}finally{p.f()}f.push(m)}return f.length?new Uint8Array(r.buffer,0,this.mp4track.len):null}},{key:"parseSPS",value:function(r){var o=Ae.readSPS(new Uint8Array(r));this.mp4track.fps=o.fps||this.mp4track.fps,this.mp4track.width=o.width,this.mp4track.height=o.height,this.mp4track.sps=[new Uint8Array(r)],this.mp4track.codec="avc1.";for(var f=new DataView(r.buffer,r.byteOffset+1,4),m=0;m<3;++m){var k=f.getUint8(m).toString(16);k.length<2&&(k="0"+k),this.mp4track.codec+=k}}},{key:"parsePPS",value:function(r){this.mp4track.pps=[new Uint8Array(r)]}},{key:"parseNAL",value:function(r){if(!r)return!1;if(r.isVCL)return!0;var o=!1;switch(r.type()){case Me.PPS:this.mp4track.pps||this.parsePPS(r.getPayload()),o=!0;break;case Me.SPS:this.mp4track.sps||this.parseSPS(r.getPayload()),o=!0;break;case Me.AUD:pe("AUD - ignoing");break;case Me.SEI:pe("SEI - ignoing");break}return!this.readyToDecode&&this.mp4track.pps&&this.mp4track.sps&&(this.readyToDecode=!0),o}}]),e})(X),ne=(function(){function n(){F(this,n)}return O(n,null,[{key:"extractNALu",value:function(e){for(var t=0,r=e.byteLength,o=[],f=0,m=0;t<r;){var k=e[t++];if(k===0)m++;else if(k===1&&m>=2){var b=m+1;f!==t-b&&o.push(e.subarray(f,t-b)),f=t,m=0}else m=0}var i=null;return f<r&&(i=e.subarray(f,r)),[o,i]}},{key:"removeEmulationPreventionBytes",value:function(e){for(var t=[],r=0,o=0;o<e.length;o++){var f=e[o];if(r===2&&f===3){r=0;continue}t.push(f),f===0?r++:r=0}return new Uint8Array(t)}},{key:"readSPS",value:function(e){var t=new ae(e);t.readUByte(),t.readUByte(),t.readBits(4),t.readBits(3),t.readBits(1);for(var r=t.readBits(2),o=t.readBits(1),f=t.readBits(5),m=t.readUInt(),k=new Uint8Array(6),b=0;b<6;b++)k[b]=t.readUByte();var i=t.readUByte();t.readUEG();var p=t.readUEG();p===3&&t.readBits(1);var T=t.readUEG(),R=t.readUEG(),re=t.readBoolean(),he=0,xe=0,ke=0,$e=0;re&&(he=t.readUEG(),xe=t.readUEG(),ke=t.readUEG(),$e=t.readUEG());var Se=null,We=t.readBoolean();if(We){var Ve=t.readBoolean();if(Ve){var Ye=t.readUByte();Ye===255&&(t.readUShort(),t.readUShort())}var Xe=t.readBoolean();Xe&&t.readBoolean();var ge=t.readBoolean();if(ge){t.readBits(3),t.readBoolean();var ot=t.readBoolean();ot&&(t.readUByte(),t.readUByte(),t.readUByte())}var it=t.readBoolean();it&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean();var st=t.readBoolean();if(st){var Ze=t.readUInt(),lt=t.readUInt();t.readBoolean(),Ze&&(Se=lt/(2*Ze))}}var Xt=p===1||p===2?2:1,Gt=p===1?2:1,Wt=T-Xt*(xe+he),Yt=R-Gt*(ke+$e);return{width:Wt,height:Yt,profile_space:r,tier_flag:o,profile_idc:f,profile_compatibility_flags:m,constraint_indicator_flags:k,level_idc:i,chroma_format_idc:p,fps:Se}}}]),n})(),ie=(function(){function n(c){F(this,n),this.payload=c,this.nalUnitType=(c[0]&126)>>1,this.nuhLayerId=(c[0]&1)<<5|(c[1]&248)>>3,this.nuhTemporalIdPlus1=c[1]&7,this._isFirstSlice=null,this._sliceType=null}return O(n,[{key:"toString",value:function(){return"".concat(n.TYPES[this.type()]||"UNKNOWN ("+this.type()+")",": Layer: ").concat(this.nuhLayerId,", Temporal Id: ").concat(this.nuhTemporalIdPlus1)}},{key:"type",value:function(){return this.nalUnitType}},{key:"isKeyframe",get:function(){return[n.IDR_W_RADL,n.IDR_N_LP,n.CRA].includes(this.nalUnitType)}},{key:"isVCL",get:function(){return this.nalUnitType<=31}},{key:"parseHeader",value:function(){var e=new ae(this.getPayload());e.readUByte(),e.readUByte(),this._isFirstSlice=e.readBoolean(),this.isKeyframe&&e.readBits(1),e.readUEG(),this._sliceType=e.readUEG()}},{key:"isFirstSlice",get:function(){return this._isFirstSlice||this.parseHeader(),this._isFirstSlice}},{key:"sliceType",get:function(){return this._sliceType||this.parseHeader(),this._sliceType}},{key:"getPayload",value:function(){return this.payload}},{key:"getPayloadSize",value:function(){return this.payload.byteLength}},{key:"getSize",value:function(){return 4+this.getPayloadSize()}},{key:"getData",value:function(){var e=new Uint8Array(this.getSize()),t=new DataView(e.buffer);return t.setUint32(0,this.getSize()-4),e.set(this.getPayload(),4),e}}],[{key:"TRAIL_N",get:function(){return 0}},{key:"TRAIL_R",get:function(){return 1}},{key:"IDR_W_RADL",get:function(){return 19}},{key:"IDR_N_LP",get:function(){return 20}},{key:"CRA",get:function(){return 21}},{key:"VPS",get:function(){return 32}},{key:"SPS",get:function(){return 33}},{key:"PPS",get:function(){return 34}},{key:"AUD",get:function(){return 35}},{key:"SEI",get:function(){return 39}},{key:"SEI2",get:function(){return 40}},{key:"TYPES",get:function(){var e;return e={},S(e,n.TRAIL_N,"TRAIL_N"),S(e,n.TRAIL_R,"TRAIL_R"),S(e,n.IDR_W_RADL,"IDR"),S(e,n.IDR_N_LP,"IDR2"),S(e,n.CRA,"CRA"),S(e,n.VPS,"VPS"),S(e,n.SPS,"SPS"),S(e,n.PPS,"PPS"),S(e,n.AUD,"AUD"),S(e,n.SEI,"SEI"),S(e,n.SEI2,"SEI2"),e}}]),n})(),ue=(function(n){I(e,n);var c=_(e);function e(t,r,o){var f;return F(this,e),f=c.call(this,"H264Remuxer"),f.frameDuration=o,f.readyToDecode=!1,f.nextDts=0,f.dts=0,f.mp4track={id:X.getTrackID(),type:"video",len:0,fragmented:!0,vps:"",sps:"",pps:"",hvcC:{},fps:30,width:0,height:0,timescale:t,duration:r,samples:[]},f.samples=[],f.remainingData=new Uint8Array,f.kfCounter=0,f.pendingUnits={},f}return O(e,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.mp4track.vps="",this.mp4track.sps="",this.mp4track.pps="",this.mp4track.hvcC={},this.nextDts=0,this.dts=0,this.remainingData=new Uint8Array,this.kfCounter=0,this.pendingUnits={}}},{key:"feed",value:function(r,o,f){var m=[],k;r=Be(this.remainingData,r);var b=ne.extractNALu(r),i=Pe(b,2);return m=i[0],k=i[1],this.remainingData=k||new Uint8Array,m.length>0?(this.remux(this.getVideoFrames(m,o,f)),!0):(oe("Failed to extract any NAL units from video data:",k),this.dispatch("outOfData"),!1)}},{key:"getVideoFrames",value:function(r,o,f){var m=this,k=[],b=[],i=0,p=0,T=!1,R=!1;this.pendingUnits.units&&(k=this.pendingUnits.units,R=this.pendingUnits.vcl,T=this.pendingUnits.keyFrame,this.pendingUnits={});var re=w(r),he;try{for(re.s();!(he=re.n()).done;){var xe=he.value,ke=new ie(xe);k.length&&R&&(ke.isFirstSlice||!ke.isVCL)&&(b.push({units:k,keyFrame:T}),k=[],T=!1,R=!1),k.push(ke),T=T||ke.isKeyframe,R=R||ke.isVCL}}catch(Se){re.e(Se)}finally{re.f()}if(k.length)if(!o)this.pendingUnits={units:k,keyFrame:T,vcl:R};else if(R)b.push({units:k,keyFrame:T});else{var $e=b.length-1;$e>=0&&(b[$e].units=b[$e].units.concat(k))}return i=o?o/b.length|0:this.frameDuration,p=o?o-i*b.length:0,b.map(function(Se){Se.duration=i,Se.compositionTimeOffset=f,p>0&&(Se.duration++,p--),m.kfCounter++,Se.keyFrame&&m.dispatch("keyframePosition",m.kfCounter*i/1e3)}),pe("jmuxer: No. of H265 frames of the last chunk: ".concat(b.length)),b}},{key:"remux",value:function(r){var o=w(r),f;try{for(o.s();!(f=o.n()).done;){var m=f.value,k=[],b=0,i=w(m.units),p;try{for(i.s();!(p=i.n()).done;){var T=p.value;this.parseNAL(T)&&(k.push(T),b+=T.getSize())}}catch(R){i.e(R)}finally{i.f()}k.length>0&&this.readyToDecode&&(this.mp4track.len+=b,this.samples.push({units:k,size:b,keyFrame:m.keyFrame,duration:m.duration,compositionTimeOffset:m.compositionTimeOffset}))}}catch(R){o.e(R)}finally{o.f()}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var r=new Uint8Array(this.mp4track.len),o=0,f=this.mp4track.samples,m,k;for(this.dts=this.nextDts;this.samples.length;){var b=this.samples.shift(),i=b.units;if(k=b.duration,k<=0){pe("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(k)),this.mp4track.len-=b.size;continue}this.nextDts+=k,m={size:b.size,duration:k,cts:b.compositionTimeOffset||0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,isNonSync:b.keyFrame?0:1,dependsOn:b.keyFrame?2:1}};var p=w(i),T;try{for(p.s();!(T=p.n()).done;){var R=T.value;r.set(R.getData(),o),o+=R.getSize()}}catch(re){p.e(re)}finally{p.f()}f.push(m)}return f.length?new Uint8Array(r.buffer,0,this.mp4track.len):null}},{key:"parseSPS",value:function(r){this.mp4track.sps=[new Uint8Array(r)],r=ne.removeEmulationPreventionBytes(r);var o=ne.readSPS(new Uint8Array(r));this.mp4track.fps=o.fps||this.mp4track.fps,this.mp4track.width=o.width,this.mp4track.height=o.height,this.mp4track.codec="hvc1.".concat(o.profile_idc,".").concat(o.profile_compatibility_flags.toString(16))+".L".concat(o.level_idc).concat(o.tier_flag?"H":"L")+".".concat(o.constraint_indicator_flags.map(function(f){return f.toString(16)}).join(".").toUpperCase()),this.mp4track.hvcC={profile_space:o.profile_space,tier_flag:o.tier_flag,profile_idc:o.profile_idc,profile_compatibility_flags:o.profile_compatibility_flags,constraint_indicator_flags:o.constraint_indicator_flags,level_idc:o.level_idc,chroma_format_idc:o.chroma_format_idc}}},{key:"parsePPS",value:function(r){this.mp4track.pps=[r]}},{key:"parseVPS",value:function(r){this.mp4track.vps=[r]}},{key:"parseNAL",value:function(r){if(!r)return!1;if(r.isVCL)return!0;var o=!1;switch(r.type()){case ie.VPS:this.mp4track.vps||this.parseVPS(r.getPayload()),o=!0;break;case ie.SPS:this.mp4track.sps||this.parseSPS(r.getPayload()),o=!0;break;case ie.PPS:this.mp4track.pps||this.parsePPS(r.getPayload()),o=!0;break;case ie.AUD:pe("AUD - ignoing");break;case ie.SEI:case ie.SEI2:pe("SEI - ignoing");break}return!this.readyToDecode&&this.mp4track.vps&&this.mp4track.sps&&this.mp4track.pps&&(this.readyToDecode=!0),o}}]),e})(X),De=(function(n){I(e,n);var c=_(e);function e(t,r,o,f){var m;return F(this,e),m=c.call(this,"remuxer"),m.videoCodec=o,m.frameDuration=f,m.initialized=!1,m.tracks={},m.seq=1,m.env=t,m.timescale=1e3,m.mediaDuration=r?4294967295:0,m}return O(e,[{key:"addTrack",value:function(r){var o=this;if((r==="video"||r==="both")&&(this.videoCodec=="H265"?this.tracks.video=new ue(this.timescale,this.mediaDuration,this.frameDuration):this.tracks.video=new W(this.timescale,this.mediaDuration,this.frameDuration),this.tracks.video.on("outOfData",function(){o.dispatch("missingVideoFrames")}),this.tracks.video.on("keyframePosition",function(m){o.dispatch("keyframePosition",m)})),r==="audio"||r==="both"){var f=new J(this.timescale,this.mediaDuration,this.frameDuration);this.tracks.audio=f,this.tracks.video.on("outOfData",function(){o.dispatch("missingAudioFrames")})}}},{key:"reset",value:function(){for(var r in this.tracks)this.tracks[r].resetTrack();this.initialized=!1}},{key:"destroy",value:function(){this.tracks={},this.offAll()}},{key:"flush",value:function(){if(!this.initialized){if(!this.isReady())return;this.dispatch("ready"),this.initSegment(),this.initialized=!0}for(var r in this.tracks){var o=this.tracks[r],f=o.getPayload();if(f&&f.byteLength){var m=q.moof(this.seq,o.dts,o.mp4track),k=q.mdat(f),b=Be(m,k),i={type:r,payload:b,dts:o.dts};r==="video"&&(i.fps=o.mp4track.fps),this.dispatch("buffer",i);var p=G(o.dts/this.timescale);pe("put segment (".concat(r,"): dts: ").concat(o.dts," frames: ").concat(o.mp4track.samples.length," second: ").concat(p)),o.flush(),this.seq++}}}},{key:"initSegment",value:function(){var r=[];for(var o in this.tracks){var f=this.tracks[o];if(this.env=="browser"){var m={type:o,payload:q.initSegment([f.mp4track],this.mediaDuration,this.timescale)};this.dispatch("buffer",m)}else r.push(f.mp4track)}if(this.env=="node"){var k={type:"all",payload:q.initSegment(r,this.mediaDuration,this.timescale)};this.dispatch("buffer",k)}pe("Initial segment generated.")}},{key:"isReady",value:function(){for(var r in this.tracks)if(!this.tracks[r].readyToDecode||!this.tracks[r].samples.length)return!1;return!0}},{key:"feed",value:function(r){var o=!1;if(r.video&&this.tracks.video&&(o|=this.tracks.video.feed(r.video,r.duration,r.compositionTimeOffset)),r.audio&&this.tracks.audio&&(o|=this.tracks.audio.feed(r.audio,r.duration)),!o){oe("Input object must have video and/or audio property. Make sure it is a valid typed array");return}this.flush()}}]),e})(M),Ue=(function(n){I(e,n);var c=_(e);function e(t,r){var o;return F(this,e),o=c.call(this,"buffer"),o.type=r,o.queue=new Uint8Array,o.cleaning=!1,o.pendingCleaning=0,o.cleanOffset=30,o.cleanRanges=[],o.sourceBuffer=t,o.sourceBuffer.addEventListener("updateend",function(){if(o.pendingCleaning>0&&(o.initCleanup(o.pendingCleaning),o.pendingCleaning=0),o.cleaning=!1,o.cleanRanges.length){o.doCleanup();return}}),o.sourceBuffer.addEventListener("error",function(){o.dispatch("error",{type:o.type,name:"buffer",error:"buffer error"})}),o}return O(e,[{key:"destroy",value:function(){this.queue=null,this.sourceBuffer=null,this.offAll()}},{key:"doCleanup",value:function(){if(!this.cleanRanges.length){this.cleaning=!1;return}var r=this.cleanRanges.shift();pe("".concat(this.type," remove range [").concat(r[0]," - ").concat(r[1],")")),this.cleaning=!0,this.sourceBuffer.remove(r[0],r[1])}},{key:"initCleanup",value:function(r){try{if(this.sourceBuffer.updating){this.pendingCleaning=r;return}if(this.sourceBuffer.buffered&&this.sourceBuffer.buffered.length&&!this.cleaning){for(var o=0;o<this.sourceBuffer.buffered.length;++o){var f=this.sourceBuffer.buffered.start(o),m=this.sourceBuffer.buffered.end(o);r-f>this.cleanOffset&&(m=r-this.cleanOffset,f<m&&this.cleanRanges.push([f,m]))}this.doCleanup()}}catch(k){oe("Error occured while cleaning ".concat(this.type," buffer - ").concat(k.name,": ").concat(k.message))}}},{key:"doAppend",value:function(){if(this.queue.length&&!(!this.sourceBuffer||this.sourceBuffer.updating))try{this.sourceBuffer.appendBuffer(this.queue),this.queue=new Uint8Array}catch(o){var r="unexpectedError";o.name==="QuotaExceededError"?(pe("".concat(this.type," buffer quota full")),r="QuotaExceeded"):(oe("Error occured while appending ".concat(this.type," buffer - ").concat(o.name,": ").concat(o.message)),r="InvalidStateError"),this.dispatch("error",{type:this.type,name:r,error:"buffer error"})}}},{key:"feed",value:function(r){this.queue=Be(this.queue,r)}}]),e})(M),Ne=(function(n){I(e,n);var c=_(e);function e(t){var r;F(this,e),r=c.call(this,"jmuxer"),r.isReset=!1;var o={node:"",mode:"both",videoCodec:"H264",flushingTime:500,maxDelay:500,clearBuffer:!0,fps:30,readFpsFromTrack:!1,debug:!1,onReady:function(){},onData:function(){},onError:function(){},onUnsupportedCodec:function(){},onMissingVideoFrames:function(){},onMissingAudioFrames:function(){},onKeyframePosition:function(){},onLoggerLog:console.log,onLoggerErr:console.error};return r.options=Object.assign({},o,t),r.env=(typeof process>"u"?"undefined":z(process))==="object"&&typeof window>"u"?"node":"browser",r.options.debug&&Ce(r.options.onLoggerLog,r.options.onLoggerErr),r.options.fps||(r.options.fps=30),r.frameDuration=1e3/r.options.fps|0,r.remuxController=new De(r.env,t.live,r.options.videoCodec,r.frameDuration),r.remuxController.addTrack(r.options.mode),r.initData(),r.remuxController.on("buffer",r.onBuffer.bind(E(r))),r.env=="browser"&&(r.remuxController.on("ready",r.createBuffer.bind(E(r))),r.initBrowser()),r.remuxController.on("missingVideoFrames",function(){typeof r.options.onMissingVideoFrames=="function"&&r.options.onMissingVideoFrames.call(null)}),r.remuxController.on("missingAudioFrames",function(){typeof r.options.onMissingAudioFrames=="function"&&r.options.onMissingAudioFrames.call(null)}),r.clearBuffer&&r.remuxController.on("keyframePosition",function(f){r.kfPosition.push(f)}),typeof r.options.onKeyframePosition=="function"&&r.remuxController.on("keyframePosition",function(f){r.options.onKeyframePosition.call(null,f)}),r}return O(e,[{key:"initData",value:function(){this.lastCleaningTime=Date.now(),this.kfPosition=[],this.pendingUnits={},this.remainingData=new Uint8Array,this.startInterval()}},{key:"initBrowser",value:function(){typeof this.options.node=="string"&&this.options.node==""&&oe("no video element were found to render, provide a valid video element"),this.node=typeof this.options.node=="string"?document.getElementById(this.options.node):this.options.node,this.mseReady=!1,this.setupMSE()}},{key:"createStream",value:function(){var r=this.feed.bind(this),o=this.destroy.bind(this);return this.stream=new l.Duplex({writableObjectMode:!0,read:function(m){},write:function(m,k,b){r(m),b()},final:function(m){o(),m()}}),this.stream}},{key:"setupMSE",value:function(){if(window.MediaSource=window.MediaSource||window.WebKitMediaSource||window.ManagedMediaSource,!window.MediaSource)throw"Oops! Browser does not support Media Source Extension or Managed Media Source (IOS 17+).";if(this.isMSESupported=!!window.MediaSource,this.mediaSource=new window.MediaSource,this.url=URL.createObjectURL(this.mediaSource),window.MediaSource===window.ManagedMediaSource)try{this.node.removeAttribute("src"),this.node.disableRemotePlayback=!0;var r=document.createElement("source");r.type="video/mp4",r.src=this.url,this.node.appendChild(r),this.node.load()}catch{this.node.src=this.url}else this.node.src=this.url;this.mseEnded=!1,this.mediaSource.addEventListener("sourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("sourceclose",this.onMSEClose.bind(this)),this.mediaSource.addEventListener("webkitsourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("webkitsourceclose",this.onMSEClose.bind(this))}},{key:"endMSE",value:function(){if(!this.mseEnded)try{this.mseEnded=!0,this.mediaSource.endOfStream()}catch{oe("mediasource is not available to end")}}},{key:"feed",value:function(r){!r||!this.remuxController||(r.duration=r.duration?parseInt(r.duration):0,this.remuxController.feed(r))}},{key:"destroy",value:function(){if(this.stopInterval(),this.stream&&(this.remuxController.flush(),this.stream.push(null),this.stream=null),this.remuxController&&(this.remuxController.destroy(),this.remuxController=null),this.bufferControllers){for(var r in this.bufferControllers)this.bufferControllers[r].destroy();this.bufferControllers=null,this.endMSE()}this.node=!1,this.mseReady=!1,this.videoStarted=!1,this.mediaSource=null}},{key:"reset",value:function(){if(this.stopInterval(),this.isReset=!0,this.node.pause(),this.remuxController&&this.remuxController.reset(),this.bufferControllers){for(var r in this.bufferControllers)this.bufferControllers[r].destroy();this.bufferControllers=null,this.endMSE()}this.initData(),this.env=="browser"&&this.initBrowser(),pe("JMuxer was reset")}},{key:"createBuffer",value:function(){if(!(!this.mseReady||!this.remuxController||!this.remuxController.isReady()||this.bufferControllers)){this.bufferControllers={};for(var r in this.remuxController.tracks){var o=this.remuxController.tracks[r];if(!e.isSupported("".concat(r,'/mp4; codecs="').concat(o.mp4track.codec,'"')))return oe("Browser does not support codec: ".concat(r,'/mp4; codecs="').concat(o.mp4track.codec,'"')),typeof this.options.onUnsupportedCodec=="function"&&this.options.onUnsupportedCodec.call(null,o.mp4track.codec),!1;var f=this.mediaSource.addSourceBuffer("".concat(r,'/mp4; codecs="').concat(o.mp4track.codec,'"'));this.bufferControllers[r]=new Ue(f,r),this.bufferControllers[r].on("error",this.onBufferError.bind(this))}}}},{key:"startInterval",value:function(){var r=this;this.interval=setInterval(function(){r.options.flushingTime?r.applyAndClearBuffer():r.bufferControllers&&r.cancelDelay()},this.options.flushingTime||1e3)}},{key:"stopInterval",value:function(){this.interval&&clearInterval(this.interval)}},{key:"cancelDelay",value:function(){if(this.node.buffered&&this.node.buffered.length>0&&!this.node.seeking){var r=this.node.buffered.end(0);r-this.node.currentTime>this.options.maxDelay/1e3&&(pe("delay"),this.node.paused&&this.node.play().catch(oe),this.node.currentTime=r-.001)}}},{key:"releaseBuffer",value:function(){for(var r in this.bufferControllers)this.bufferControllers[r].doAppend()}},{key:"applyAndClearBuffer",value:function(){this.bufferControllers&&(this.releaseBuffer(),this.clearBuffer())}},{key:"getSafeClearOffsetOfBuffer",value:function(r){for(var o=this.options.mode==="audio"&&r||0,f,m=0;m<this.kfPosition.length&&!(this.kfPosition[m]>=r);m++)f=this.kfPosition[m];return f&&(this.kfPosition=this.kfPosition.filter(function(k){return k<f&&(o=k),k>=f})),o}},{key:"clearBuffer",value:function(){if(this.options.clearBuffer&&Date.now()-this.lastCleaningTime>1e4){for(var r in this.bufferControllers){var o=this.getSafeClearOffsetOfBuffer(this.node.currentTime);this.bufferControllers[r].initCleanup(o)}this.lastCleaningTime=Date.now()}}},{key:"onBuffer",value:function(r){this.options.readFpsFromTrack&&typeof r.fps<"u"&&this.options.fps!=r.fps&&(this.options.fps=r.fps,this.frameDuration=Math.ceil(1e3/r.fps),pe("JMuxer changed FPS to ".concat(r.fps," from track data"))),this.env=="browser"?this.bufferControllers&&this.bufferControllers[r.type]&&this.bufferControllers[r.type].feed(r.payload):this.stream&&this.stream.push(r.payload),this.options.onData&&this.options.onData(r.payload),this.options.flushingTime===0&&this.applyAndClearBuffer()}},{key:"onMSEOpen",value:function(){this.mseReady=!0,URL.revokeObjectURL(this.url),typeof this.options.onReady=="function"&&this.options.onReady.call(null,this.isReset)}},{key:"onMSEClose",value:function(){this.mseReady=!1,this.videoStarted=!1}},{key:"onBufferError",value:function(r){if(r.name=="QuotaExceeded"){pe("JMuxer cleaning ".concat(r.type," buffer due to QuotaExceeded error")),this.bufferControllers[r.type].initCleanup(this.node.currentTime);return}else r.name=="InvalidStateError"?(pe("JMuxer is reseting due to InvalidStateError"),this.reset()):this.endMSE();typeof this.options.onError=="function"&&this.options.onError.call(null,r)}}],[{key:"isSupported",value:function(r){return window.MediaSource&&window.MediaSource.isTypeSupported(r)}}]),e})(M);return Ne}))})(Qe)),Qe.exports}var Cr=_r();const $r=yr(Cr);function Pr(a){const{platform:d,serial:l,videoRef:v}=a,g=H(!1),x=H(!1),E=H(null);let F=null,$=null,O=null;const w=3e3;function _(){if(!v.value){const B="Video element not ready";return E.value=B,console.error("[Scrcpy]",B),!1}try{return console.log("[Scrcpy] Initializing JMuxer for video element:",v.value),$=new $r({node:v.value,mode:"video",flushingTime:0,fps:30,debug:!1}),console.log("[Scrcpy] JMuxer initialized successfully"),!0}catch(B){const C=`JMuxer init failed: ${B instanceof Error?B.message:String(B)}`;return E.value=C,console.error("[Scrcpy]",C,B),!1}}function S(){if(F&&F.readyState===WebSocket.OPEN){console.warn("[Scrcpy] WebSocket already connected");return}if(!v.value){console.warn("[Scrcpy] Video element not available, cannot connect");return}if(!(!$&&!_()))try{const C=`${location.protocol==="https:"?"wss:":"ws:"}//${location.host}/ws/${d.value}/scrcpy/${l.value}`;console.log(`[Scrcpy] Connecting to ${C}`),F=new WebSocket(C),F.binaryType="arraybuffer",F.onopen=()=>{g.value=!0,x.value=!1,E.value=null,console.log("[Scrcpy] Connected"),O&&(clearTimeout(O),O=null)},F.onmessage=A=>{if(A.data instanceof ArrayBuffer){if($&&A.data.byteLength>0)try{$.feed({video:new Uint8Array(A.data)})}catch(Z){console.error("[Scrcpy] JMuxer feed error:",Z)}}else try{const Z=JSON.parse(A.data);console.log("[Scrcpy] Control message:",Z)}catch{console.warn("[Scrcpy] Invalid message:",A.data)}},F.onerror=A=>{const Z="WebSocket connection error";console.error("[Scrcpy]",Z,A),console.error("[Scrcpy] WebSocket URL was:",C),console.error("[Scrcpy] WebSocket readyState:",F?.readyState),E.value=Z},F.onclose=()=>{g.value=!1,console.log("[Scrcpy] Disconnected"),!x.value&&v.value&&(x.value=!0,console.log(`[Scrcpy] Reconnecting in ${w}ms...`),O=setTimeout(()=>{S()},w))}}catch(B){E.value=`WebSocket init failed: ${B instanceof Error?B.message:String(B)}`,console.error("[Scrcpy] Connection error:",B)}}function j(){if(x.value=!1,O&&(clearTimeout(O),O=null),F&&(F.close(),F=null),$){try{$.destroy()}catch(B){console.warn("[Scrcpy] JMuxer destroy error:",B)}$=null}g.value=!1,E.value=null,console.log("[Scrcpy] Disconnected and cleaned up")}function I(B,C,A,Z,Q){if(!F||F.readyState!==WebSocket.OPEN){console.warn("[Scrcpy] WebSocket not connected");return}const ve=C/Z,_e=A/Q,fe=JSON.stringify({type:B==="down"?"touchDown":B==="move"?"touchMove":"touchUp",xP:ve,yP:_e});F.send(fe)}return nt(()=>{j()}),{connected:g,reconnecting:x,error:E,connect:S,disconnect:j,sendTouch:I}}const Ar=30;function Fr(a){const{platform:d,serial:l,enabled:v}=a,g=H(!1),x=H(null),E=H(0),F=[],$=de(()=>g.value?`/api/${d.value}/${l.value}/mjpeg?t=${Date.now()}`:null);function O(){const S=performance.now();for(F.push(S);F.length>Ar;)F.shift();if(F.length>=2){const j=S-F[0];j>0&&(E.value=Math.round((F.length-1)/(j/1e3)))}}async function w(){if(g.value){console.log("[iOS MJPEG] Stream already started");return}try{console.log("[iOS MJPEG] Starting WDA MJPEG stream..."),await Fe(d.value,l.value,"start_mjpeg_stream",{}),g.value=!0,x.value=null,F.length=0,E.value=0,console.log("[iOS MJPEG] Stream started:",$.value)}catch(S){const j=`Failed to start iOS MJPEG stream: ${S instanceof Error?S.message:String(S)}`;x.value=j,console.error("[iOS MJPEG]",j,S)}}async function _(){if(g.value)try{console.log("[iOS MJPEG] Stopping MJPEG stream..."),await Fe(d.value,l.value,"stop_mjpeg_stream",{}),g.value=!1,E.value=0,F.length=0,console.log("[iOS MJPEG] Stream stopped")}catch(S){const j=`Failed to stop iOS MJPEG stream: ${S instanceof Error?S.message:String(S)}`;x.value=j,console.error("[iOS MJPEG]",j,S)}}return Re(v,async S=>{S?await w():await _()},{immediate:!0}),nt(()=>{g.value&&_()}),{streamUrl:$,isStreaming:g,error:x,fps:E,updateFps:O,startStream:w,stopStream:_}}const Tr={class:"screen-panel",ref:"containerRef"},Ur={class:"mode-selector"},Dr={class:"info-display"},Er={key:0,class:"fps-badge"},Mr={class:"canvas-container"},Br={class:"canvas-wrapper"},Rr=["src"],Or=ce({__name:"ScreenPanel",props:{platform:{},serial:{},screenSize:{}},emits:["tap","recordTap","recordSwipe"],setup(a,{expose:d,emit:l}){const v=a,{platform:g,serial:x}=qt(v),E=l,F=qe(),$=rt(),O=Ge(),w=de(()=>O.t.screen),_=H("default"),S=H({x:0,y:0}),j=H(!1),I=H([]),B=de(()=>g.value==="android"&&_.value==="pointer"),C=de(()=>g.value==="ios"&&_.value==="pointer"),A=H(null),Z=H(null),{canvasRef:Q,addRect:ve,addTrack:_e,clearShapes:Pe,clearShapesByType:fe,resizeCanvas:L}=xr(),P=Pr({platform:g,serial:x,videoRef:Z}),z=Fr({platform:g,serial:x,enabled:C});Re(()=>z.error.value,(G,W)=>{G&&G!==W&&F.error(G)});const V=de(()=>C.value&&z.fps.value>0),Y=de(()=>C.value&&z.streamUrl.value?z.streamUrl.value:$.screenshotUrl),ee=de(()=>({width:v.screenSize?.width||$.screenSize?.width||0,height:v.screenSize?.height||$.screenSize?.height||0})),Ce=de(()=>{const G=ee.value.width,W=ee.value.height;return!G||!W?{x:0,y:0}:{x:Math.round(S.value.x/G*100),y:Math.round(S.value.y/W*100)}});function pe(){if(!A.value)return;const G=A.value.naturalWidth,W=A.value.naturalHeight;L(G,W),C.value&&z.updateFps()}function oe(){F.error("")}function M(){if(!Z.value)return;const G=Z.value.videoWidth||ee.value.width,W=Z.value.videoHeight||ee.value.height;L(G,W),P&&!P.connected.value&&P.connect()}Re(()=>_.value,G=>{G==="pointer"&&($.selectNode(null),fe("select"),fe("hover"))}),Re(()=>B.value,async(G,W)=>{if(W===void 0&&!G){console.log("[ScreenPanel] Initial state: Screenshot mode");return}G?(console.log("[ScreenPanel] Switching to Scrcpy mode, waiting for video element..."),await ut(),console.log("[ScreenPanel] Video element ready, connecting..."),P.connect()):(console.log("[ScreenPanel] Switching to Screenshot mode, disconnecting..."),P.disconnect())}),Re(Z,G=>{G&&B.value&&G.addEventListener("loadedmetadata",M)},{immediate:!0}),nt(()=>{P.disconnect()});function q(G){const W=A.value||Z.value;if(!W)return null;const ne=W.getBoundingClientRect(),{width:ie,height:ue}=ee.value;if(!ie||!ue)return null;const De=ie/ne.width,Ue=ue/ne.height,Ne=Math.round((G.clientX-ne.left)*De),n=Math.round((G.clientY-ne.top)*Ue);return{x:Ne,y:n}}function te(G){if(!Q.value)return null;const W=Q.value.getBoundingClientRect(),ne=Q.value.width/W.width,ie=Q.value.height/W.height,ue=(G.clientX-W.left)*ne,De=(G.clientY-W.top)*ie;return{x:ue,y:De}}function ye(G){if(!Q.value)return null;const{width:W,height:ne}=ee.value;if(!W||!ne)return null;const ie=W/Q.value.width,ue=ne/Q.value.height,De=Math.round(G.x*ie),Ue=Math.round(G.y*ue);return{x:De,y:Ue}}function X(G,W){if(!$.hierarchy?.nodes)return null;const{width:ne,height:ie}=ee.value;if(!ne||!ie)return null;const ue=G/ne,De=W/ie,Ue=[];function Ne(e){e.forEach(t=>{t.children&&Ne(t.children),Ue.push(t)})}Ne($.hierarchy.nodes);let n=null,c=1/0;for(const e of Ue){if(!e.bounds)continue;const[t,r,o,f]=e.bounds,m=o<=1&&f<=1,k=m?t:t/ne,b=m?r:r/ie,i=m?o:o/ne,p=m?f:f/ie;if(ue>=k&&ue<=i&&De>=b&&De<=p){const T=(i-k)*(p-b);T<c&&(c=T,n=e)}}return n}function J(G){const W=q(G),ne=te(G);if(!(!W||!ne)){if(S.value=W,fe("hover"),_.value==="default"){const ie=X(W.x,W.y);ie&&ie.bounds&&ve(ie.bounds,"hover")}else if(_.value==="pointer"&&j.value&&(I.value.push(ne),fe("hover"),_e(I.value),B.value)){const{width:ie,height:ue}=ee.value;ie&&ue&&P.sendTouch("move",W.x,W.y,ie,ue)}}}function ae(G){const W=q(G);if(W&&(j.value=!0,I.value=[],_.value==="pointer")){const ne=te(G);if(ne&&I.value.push(ne),B.value){const{width:ie,height:ue}=ee.value;ie&&ue&&P.sendTouch("down",W.x,W.y,ie,ue)}}}function Ae(){if(I.value.length<2)return null;const G=I.value[0],W=I.value[I.value.length-1],ne=ye(G),ie=ye(W);if(!ne||!ie)return null;const ue=Math.max(.2,Math.min(1,I.value.length/60));return{startX:ne.x,startY:ne.y,endX:ie.x,endY:ie.y,duration:ue}}async function Me(G){const W=q(G);if(W){if(j.value=!1,_.value==="default"){const ne=X(W.x,W.y);ne&&($.selectNode(ne),fe("select"),ne.bounds&&ve(ne.bounds,"select"))}else if(_.value==="pointer")try{E("tap",W.x,W.y);const ne=null,ie=I.value.length>5;if(B.value){const{width:ue,height:De}=ee.value;ue&&De&&P.sendTouch("up",W.x,W.y,ue,De);const Ue=ie?Ae():null;Ue?E("recordSwipe",Ue.startX,Ue.startY,Ue.endX,Ue.endY,Ue.duration,ne):E("recordTap",W.x,W.y,ne)}else{const ue=ie?Ae():null;ue?(await Fe(v.platform,v.serial,"swipe",{startX:ue.startX,startY:ue.startY,endX:ue.endX,endY:ue.endY,duration:ue.duration}),E("recordSwipe",ue.startX,ue.startY,ue.endX,ue.endY,ue.duration,ne),F.success(`: (${ue.startX}, ${ue.startY})  (${ue.endX}, ${ue.endY})`)):(await vt(v.platform,v.serial,W.x,W.y),E("recordTap",W.x,W.y,ne),F.success(`: (${W.x}, ${W.y})`))}}catch(ne){F.error(`: ${ne instanceof Error?ne.message:String(ne)}`)}I.value=[],fe("hover")}}function Be(){if(j.value&&_.value==="pointer"&&B.value){const G=I.value[I.value.length-1];if(G){const W=ye(G),{width:ne,height:ie}=ee.value;W&&ne&&ie&&P.sendTouch("up",W.x,W.y,ne,ie)}}j.value=!1,I.value=[],fe("hover")}return Re(()=>$.selectedNode,G=>{fe("select"),G&&G.bounds&&ve(G.bounds,"select")}),d({clearShapes:Pe,resizeCanvas:L}),(G,W)=>(D(),N("div",Tr,[y("div",Ur,[u(s(Mt),{value:_.value,"onUpdate:value":W[0]||(W[0]=ne=>_.value=ne),size:"small"},{default:h(()=>[u(s(et),{value:"default"},{default:h(()=>[u(s(le),null,{default:h(()=>[u(s(Fn))]),_:1}),K(" "+U(w.value.viewMode),1)]),_:1}),u(s(et),{value:"pointer"},{default:h(()=>[u(s(le),null,{default:h(()=>[u(s(Un))]),_:1}),K(" "+U(w.value.pointerMode),1)]),_:1})]),_:1},8,["value"]),y("div",Dr,[V.value?(D(),N("span",Er,U(s(z).fps.value)+" FPS",1)):we("",!0),y("span",null,U(ee.value.width)+"x"+U(ee.value.height),1),y("span",null,U(S.value.x)+", "+U(S.value.y),1),y("span",null,U(Ce.value.x)+"%, "+U(Ce.value.y)+"%",1)])]),y("div",Mr,[y("div",Br,[B.value?(D(),N("video",{key:1,ref_key:"videoRef",ref:Z,class:"screen-video",autoplay:"",muted:""},null,512)):(D(),N("img",{key:0,ref_key:"imageRef",ref:A,src:Y.value,class:"screen-image",onLoad:pe,onError:oe},null,40,Rr)),y("canvas",{ref_key:"drawingCanvas",ref:Q,class:"drawing-canvas",onMousemove:J,onMousedown:ae,onMouseup:Me,onMouseleave:Be},null,544)])])],512))}}),zr=Le(Or,[["__scopeId","data-v-cb334810"]]),Ir={class:"hierarchy-panel"},Lr={class:"hierarchy-search-bar"},Nr={key:0,class:"search-results-info"},jr={key:1,class:"search-results-list"},Hr=["onClick"],Vr={class:"result-index"},Xr={class:"result-content"},Gr={class:"result-primary"},Wr={class:"result-secondary"},Yr={key:0,class:"result-tag"},Jr={key:1,class:"result-tag"},qr={key:2,class:"result-tag"},Kr=ce({__name:"HierarchyPanel",props:{platform:{},serial:{}},setup(a){const d=a,l=qe(),v=rt(),g=Ge(),x=de(()=>g.t.hierarchy),E=H(""),F=H([]),$=H(!1),O=H(d.platform==="ios"?"label":"text"),w=de(()=>d.platform==="ios"?[{label:x.value.searchType.label,value:"label"},{label:x.value.searchType.xpath,value:"xpath"},{label:x.value.searchType.className,value:"className"}]:[{label:x.value.searchType.text,value:"text"},{label:x.value.searchType.xpath,value:"xpath"},{label:x.value.searchType.id,value:"id"},{label:x.value.searchType.className,value:"className"}]);Re(()=>d.platform,P=>{if(P==="ios"){O.value!=="label"&&O.value!=="xpath"&&O.value!=="className"&&(O.value="label");return}O.value==="label"&&(O.value="text")},{immediate:!0});const _=H(new Map),S=H([]),j=H([]);function I(P,z=""){return P.map((V,Y)=>{const ee=z?`${z}-${Y}`:`${Y}`;_.value.set(ee,V);const Ce=V.children&&V.children.length>0;return{key:ee,label:`${Y} ${V.class_name||"Node"}`,prefix:()=>me(le,null,{default:()=>me(Ce?En:Cn)}),children:Ce?I(V.children,ee):void 0,isLeaf:!Ce,raw:V}})}function B({option:P}){const z=P.raw,V=(P.label||"").split(" ")[0],Y=z.class_name||"Node",ee=[me("span",{class:"tree-node-index"},`${V} `),me("span",{class:"tree-node-class"},Y)];if(z.resource_id){const Ce=z.resource_id.split("/").pop()||z.resource_id;ee.push(me("span",{class:"tree-node-highlight"},` id=${Ce}`))}return z.text&&ee.push(me("span",{class:"tree-node-highlight"},` text=${z.text}`)),z.label&&ee.push(me("span",{class:"tree-node-highlight"},` label=${z.label}`)),me("span",{},ee)}const C=de(()=>v.hierarchy?.nodes?(_.value.clear(),I(v.hierarchy.nodes)):[]);async function A(){if(!E.value.trim()){l.warning(x.value.searchPlaceholder);return}$.value=!0;try{await v.refreshHierarchy();const P=E.value.trim(),z=v.hierarchy?{width:v.hierarchy.width,height:v.hierarchy.height}:void 0,V=await Fe(d.platform,d.serial,"findElements",{by:O.value,value:P});if(V&&typeof V=="object"&&"value"in V){const Y=V;F.value=Y.value.map(ee=>Ct(ee,z)),Y.count===0?l.warning(x.value.noResults):Y.count===1?ve(F.value[0]):l.success(g.format(x.value.foundResults,{count:Y.count}))}else Array.isArray(V)?(F.value=V.map(Y=>Ct(Y,z)),V.length===1?ve(F.value[0]):l.success(g.format(x.value.foundResults,{count:V.length}))):(F.value=[],l.warning(x.value.noResults))}catch(P){l.error(`${x.value.searchPlaceholder}: ${P instanceof Error?P.message:String(P)}`),F.value=[]}finally{$.value=!1}}function Z(P,z,V=""){if(!P||P.length!==4)return null;for(let Y=0;Y<z.length;Y++){const ee=z[Y],Ce=V?`${V}-${Y}`:`${Y}`,pe=ee?.raw;if(pe?.bounds){const oe=pe.bounds;if(oe[0]===P[0]&&oe[1]===P[1]&&oe[2]===P[2]&&oe[3]===P[3])return Ce}if(ee&&ee.children){const oe=Z(P,ee.children,Ce);if(oe)return oe}}return null}function Q(P){const z=P.split("-"),V=[];for(let Y=1;Y<z.length;Y++)V.push(z.slice(0,Y).join("-"));return V}async function ve(P){await ut();const z=Z(P.bounds,C.value);if(z){const V=Q(z),Y=new Set([...j.value,...V]);j.value=Array.from(Y),S.value=[z];const ee=_.value.get(z);ee&&v.selectNode(ee),l.success("")}else v.selectNode(P),l.warning("")}function _e(){E.value="",F.value=[]}function Pe(P,z){const V=z[0];if(V&&V.raw){const Y=V.raw;v.selectNode(Y)}}function fe(P){j.value=P}const L=({option:P})=>({onDblclick(){if(!P.isLeaf){const z=P.key;j.value.includes(z)?j.value=j.value.filter(V=>V!==z):j.value=[...j.value,z]}}});return Re(()=>v.selectedNode,async P=>{if(!P){S.value=[];return}await ut();const z=Z(P.bounds,C.value);if(z){const V=Q(z),Y=new Set([...j.value,...V]);j.value=Array.from(Y),S.value=[z]}},{deep:!0}),(P,z)=>{const V=Oe("n-select"),Y=Oe("n-button"),ee=Oe("n-input"),Ce=Oe("n-tree"),pe=Oe("n-empty");return D(),N("div",Ir,[y("div",Lr,[u(V,{value:O.value,"onUpdate:value":z[0]||(z[0]=oe=>O.value=oe),options:w.value,size:"small",style:{width:"160px","flex-shrink":"0"}},null,8,["value","options"]),u(ee,{value:E.value,"onUpdate:value":z[1]||(z[1]=oe=>E.value=oe),placeholder:x.value.searchPlaceholder,clearable:"",onKeydown:Bt(A,["enter"]),style:{flex:"1"}},{suffix:h(()=>[u(Y,{text:"",onClick:A,loading:$.value,disabled:!E.value.trim()},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(Zn))]),_:1})]),_:1},8,["loading","disabled"])]),_:1},8,["value","placeholder"])]),F.value.length>0?(D(),N("div",Nr,[y("span",null,U(s(g).format(x.value.foundResults,{count:F.value.length})),1),u(Y,{text:"",size:"small",onClick:_e},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(kn))]),_:1})]),default:h(()=>[K(" "+U(s(g).t.common.clear),1)]),_:1})])):we("",!0),F.value.length>0?(D(),N("div",jr,[(D(!0),N(He,null,Je(F.value,(oe,M)=>(D(),N("div",{key:M,class:"search-result-item",onClick:q=>ve(oe)},[y("div",Vr,U(M+1),1),y("div",Xr,[y("div",Gr,U(oe.text||oe.label||oe.resource_id||oe.class_name||`${x.value.noElement} ${M+1}`),1),y("div",Wr,[oe.resource_id?(D(),N("span",Yr,U(oe.resource_id),1)):we("",!0),oe.label?(D(),N("span",Jr,U(oe.label),1)):we("",!0),oe.class_name?(D(),N("span",qr,U(oe.class_name),1)):we("",!0)])]),u(s(le),{size:"16",color:"var(--md-primary)"},{default:h(()=>[u(s(Lt))]),_:1})],8,Hr))),128))])):we("",!0),C.value.length>0?(D(),be(Ce,{key:2,data:C.value,"selected-keys":S.value,"expanded-keys":j.value,"node-props":L,"render-label":B,selectable:"","block-line":"","onUpdate:selectedKeys":Pe,"onUpdate:expandedKeys":fe},null,8,["data","selected-keys","expanded-keys"])):(D(),be(pe,{key:3,description:x.value.noElement},null,8,["description"]))])}}}),Zr=Le(Kr,[["__scopeId","data-v-14702f1c"]]);function Qr(a){const d=Math.floor(a/1e3),l=Math.floor(d/60),v=d%60;return`${l.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`}function Ht(a){return a<1e3?`${a}ms`:`${(a/1e3).toFixed(1)}s`}function ea(a){return a<1024?`${a}B`:a<1024*1024?`${(a/1024).toFixed(1)}KB`:`${(a/(1024*1024)).toFixed(1)}MB`}function ta(a){const d=new Date(a*1e3),v=new Date().getTime()-d.getTime(),g=Math.floor(v/(1e3*60*60*24));return g===0?d.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):g===1?" "+d.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):g<7?`${g}`:d.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}function Dt(a){return a?a.text?`: "${a.text}"`:a.label?`label: "${a.label}"`:a.content_desc?`: "${a.content_desc}"`:a.resource_id?`ID: ${a.resource_id.split("/").pop()}`:a.class_name?`: ${a.class_name.split(".").pop()}`:null:null}function Vt(a){switch(a.type){case"tap":{const d=Dt(a.element);return d||(a.xpath?`XPath (${Math.round(a.coords.x)}, ${Math.round(a.coords.y)})`:` (${Math.round(a.coords.x)}, ${Math.round(a.coords.y)})`)}case"swipe":{const d=Dt(a.element);return d?`${d}  (${Math.round(a.endCoords.x)}, ${Math.round(a.endCoords.y)})`:`(${Math.round(a.coords.x)}, ${Math.round(a.coords.y)})  (${Math.round(a.endCoords.x)}, ${Math.round(a.endCoords.y)})`}case"input":return`"${a.params.text}"`;case"sleep":return`${a.params.duration}ms`;case"command":return a.params.command;default:return JSON.stringify(a.params)}}function wt(a){switch(a){case"tap":return"primary";case"swipe":return"success";case"input":return"warning";case"sleep":return"default";case"command":case"back":case"home":return"error";default:return"default"}}function na(a){switch(a){case"idle":return"default";case"playing":return"success";case"paused":return"warning";case"completed":return"primary";case"error":return"error";default:return"default"}}function ra(a){switch(a){case"idle":return"";case"playing":return"";case"paused":return"";case"completed":return"";case"error":return"";default:return a}}const aa={class:"tab-content"},oa={class:"control-bar"},ia={key:0,class:"recording-indicator"},sa={class:"duration"},la={class:"steps-section"},ua={key:0,class:"steps-list"},ca={class:"step-index"},da={class:"step-details"},fa={class:"step-time"},ha=ce({__name:"RecordTab",props:{recorder:{},currentPlaybackIndex:{},isPlaybackActive:{type:Boolean},t:{}},emits:["toggle-recording","toggle-pause","clear-recording","save-recording","edit-action","delete-action"],setup(a){return(d,l)=>(D(),N("div",aa,[y("div",oa,[u(s(Ie),{size:8},{default:h(()=>[u(s(se),{type:a.recorder.isRecording.value?"error":"primary",disabled:a.isPlaybackActive,onClick:l[0]||(l[0]=v=>d.$emit("toggle-recording"))},{icon:h(()=>[u(s(le),null,{default:h(()=>[a.recorder.isRecording.value?(D(),be(s(xt),{key:1})):(D(),be(s(dt),{key:0}))]),_:1})]),default:h(()=>[K(" "+U(a.recorder.isRecording.value?a.t.stopRecording:a.t.startRecording),1)]),_:1},8,["type","disabled"]),a.recorder.isRecording.value?(D(),be(s(se),{key:0,type:a.recorder.isPaused.value?"default":"warning",onClick:l[1]||(l[1]=v=>d.$emit("toggle-pause"))},{default:h(()=>[K(U(a.recorder.isPaused.value?a.t.continueRecording:a.t.pauseRecording),1)]),_:1},8,["type"])):we("",!0),u(s(se),{disabled:a.recorder.actionCount.value===0,onClick:l[2]||(l[2]=v=>d.$emit("clear-recording"))},{default:h(()=>[K(U(a.t.clearRecording)+" ("+U(a.recorder.actionCount.value)+") ",1)]),_:1},8,["disabled"])]),_:1}),u(s(Ie),{size:8},{default:h(()=>[u(s(se),{disabled:a.recorder.actionCount.value===0,onClick:l[3]||(l[3]=v=>d.$emit("save-recording"))},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(qn))]),_:1})]),default:h(()=>[K(" "+U(a.t.saveRecording),1)]),_:1},8,["disabled"])]),_:1})]),a.recorder.isRecording.value?(D(),N("div",ia,[u(s(Ke),{type:a.recorder.isPaused.value?"warning":"error",round:""},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(dt))]),_:1})]),default:h(()=>[K(" "+U(a.recorder.isPaused.value?a.t.recordingPaused:a.t.recording),1)]),_:1},8,["type"]),y("span",sa,U(s(Qr)(a.recorder.duration.value)),1)])):we("",!0),y("div",la,[y("h3",null,U(a.t.operationSteps)+" ("+U(a.recorder.actionCount.value)+")",1),a.recorder.actionCount.value>0?(D(),N("div",ua,[(D(!0),N(He,null,Je(a.recorder.actions.value,(v,g)=>(D(),N("div",{key:v.id,class:Rt(["step-item",{active:a.currentPlaybackIndex===g}])},[y("span",ca,U(Number(g)+1),1),u(s(Ke),{type:s(wt)(v.type),size:"small"},{default:h(()=>[K(U(v.type),1)]),_:2},1032,["type"]),y("span",da,U(s(Vt)(v)),1),y("span",fa,U(s(Ht)(v.relativeTime)),1),u(s(Ot),{size:"tiny"},{default:h(()=>[u(s(se),{onClick:x=>d.$emit("edit-action",v)},{default:h(()=>[u(s(le),null,{default:h(()=>[u(s(Nt))]),_:1})]),_:1},8,["onClick"]),u(s(se),{onClick:x=>d.$emit("delete-action",v.id)},{default:h(()=>[u(s(le),null,{default:h(()=>[u(s(yt))]),_:1})]),_:1},8,["onClick"])]),_:2},1024)],2))),128))])):(D(),be(s(tt),{key:1,description:a.t.noOperations},null,8,["description"]))])]))}}),pa=Le(ha,[["__scopeId","data-v-6ac11da4"]]),va={class:"playback-tab-layout"},ma={class:"recordings-section"},xa={class:"section-header"},ya={class:"playback-controls-divider"},ga={class:"control-bar"},wa={class:"progress-text"},ka={key:0,class:"error-message-compact"},ba={class:"playback-steps-section"},Sa={key:0,class:"steps-list"},_a={class:"step-index"},Ca={class:"step-details"},$a={class:"step-time"},Pa=ce({__name:"PlaybackTab",props:{player:{},recordings:{},loading:{type:Boolean},isRecordingActive:{type:Boolean},t:{},commonT:{}},emits:["refresh-recordings","start-playback","load-recording","edit-recording","delete-recording"],setup(a,{emit:d}){const l=a,v=d,g=de(()=>{if(l.recordings.length===0)return[];const O=new Map;l.recordings.forEach(_=>{const S=_.group||"default",j=O.get(S);j?j.push(_):O.set(S,[_])});const w=[];return O.forEach((_,S)=>{const j={key:`group-${S}`,label:S,isGroup:!0,children:_.map(I=>({key:`${I.group}/${I.name}`,label:I.name,recording:I}))};w.push(j)}),w}),x=de(()=>g.value.map(O=>O.key));function E({option:O}){const w=O;if(w.isGroup){const _=w.children?.length||0;return me("span",{class:"tree-group-label"},[me("span",{class:"group-name"},w.label),me("span",{class:"group-count"},`(${_})`)])}else{const _=w.recording;return me("div",{class:"tree-recording-label"},[me("div",{class:"recording-name"},_.name),me("div",{class:"recording-meta"},[me("span",{class:"meta-item"},ea(_.size)),me("span",{class:"meta-item"},ta(_.modified_at))])])}}function F({option:O}){const w=O;if(w.isGroup||!w.recording)return null;const _=w.recording;return me("div",{class:"tree-node-actions",onClick:S=>S.stopPropagation()},[me(se,{size:"tiny",quaternary:!0,onClick:()=>v("load-recording",_.group,_.name)},{icon:()=>me(le,null,{default:()=>me(Nn)})}),me(se,{size:"tiny",quaternary:!0,onClick:()=>v("edit-recording",_.group,_.name)},{icon:()=>me(le,null,{default:()=>me(Nt)})}),me(se,{size:"tiny",quaternary:!0,onClick:()=>v("delete-recording",_.group,_.name)},{icon:()=>me(le,null,{default:()=>me(yt)})})])}function $({option:O}){const w=O;return w.isGroup?{}:{onClick:()=>{w.recording&&v("load-recording",w.recording.group,w.recording.name)}}}return(O,w)=>(D(),N("div",va,[y("div",ma,[y("div",xa,[y("h3",null,U(a.t.recordingList)+" ("+U(g.value.length>0?g.value.reduce((_,S)=>_+(S.children?.length||0),0):0)+")",1),u(s(se),{size:"small",onClick:w[0]||(w[0]=_=>O.$emit("refresh-recordings")),loading:a.loading},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(mt))]),_:1})]),default:h(()=>[K(" "+U(a.commonT.refresh),1)]),_:1},8,["loading"])]),g.value.length>0?(D(),be(s(Kt),{key:0,data:g.value,"render-label":E,"render-suffix":F,"node-props":$,"block-line":"","expand-on-click":"","default-expanded-keys":x.value},null,8,["data","default-expanded-keys"])):(D(),be(s(tt),{key:1,description:a.t.noRecordings},null,8,["description"]))]),y("div",ya,[y("div",ga,[u(s(Ie),{size:8},{default:h(()=>[u(s(se),{type:"success",disabled:!a.player.canPlay.value||a.isRecordingActive,loading:a.player.isPlaying.value,onClick:w[1]||(w[1]=_=>O.$emit("start-playback"))},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(Hn))]),_:1})]),default:h(()=>[K(" "+U(a.t.play),1)]),_:1},8,["disabled","loading"]),a.player.isPlaying.value?(D(),be(s(se),{key:0,onClick:w[2]||(w[2]=_=>a.player.pause())},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(In))]),_:1})]),default:h(()=>[K(" "+U(a.t.pause),1)]),_:1})):we("",!0),u(s(se),{disabled:!a.player.isPlaying.value&&!a.player.isPaused.value,onClick:w[3]||(w[3]=_=>a.player.stop())},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(xt))]),_:1})]),default:h(()=>[K(" "+U(a.t.stop),1)]),_:1},8,["disabled"]),u(s(se),{disabled:!a.player.isPaused.value,onClick:w[4]||(w[4]=_=>a.player.stepNext())},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(Xn))]),_:1})]),default:h(()=>[K(" "+U(a.t.step),1)]),_:1},8,["disabled"])]),_:1}),a.player.recording.value?(D(),be(s(Ie),{key:0,size:8,align:"center"},{default:h(()=>[y("span",wa,U(a.t.progress)+": "+U(a.player.progress.value.currentIndex+1)+" / "+U(a.player.progress.value.totalSteps),1),u(s(Ke),{type:s(na)(a.player.state.value),size:"small"},{default:h(()=>[K(U(s(ra)(a.player.state.value)),1)]),_:1},8,["type"])]),_:1})):we("",!0)]),a.player.error.value?(D(),N("div",ka,[u(s(ct),{type:"error",title:a.player.error.value,closable:""},null,8,["title"])])):we("",!0)]),y("div",ba,[a.player.recording.value?(D(),N("div",Sa,[(D(!0),N(He,null,Je(a.player.recording.value.actions,(_,S)=>(D(),N("div",{key:_.id,class:Rt(["step-item",{active:a.player.currentIndex.value===S,completed:a.player.currentIndex.value>S,pending:a.player.currentIndex.value<S}])},[y("span",_a,U(Number(S)+1),1),u(s(Ke),{type:s(wt)(_.type),size:"small"},{default:h(()=>[K(U(_.type),1)]),_:2},1032,["type"]),y("span",Ca,U(s(Vt)(_)),1),y("span",$a,U(s(Ht)(_.relativeTime)),1)],2))),128))])):(D(),be(s(tt),{key:1,description:a.t.selectRecording},null,8,["description"]))])]))}}),Aa=Le(Pa,[["__scopeId","data-v-87bae0b8"]]);function Fa(a){return JSON.parse(JSON.stringify(a))}const Ta=ce({__name:"ActionEditDialog",props:kt({action:{},screenSize:{}},{show:{type:Boolean,required:!0},showModifiers:{}}),emits:kt(["save","cancel"],["update:show"]),setup(a,{emit:d}){const l=a,v=d,g=Ge(),x=de(()=>({common:g.t.common,actions:g.t.actions})),E=Zt(a,"show"),F=H(null),$=de(()=>l.action),O=de(()=>{if(!$.value)return x.value.actions.editAction;const I=x.value.actions.actionTypes[$.value.type]||$.value.type;return`${x.value.actions.editAction} - ${I}`}),w=H({relativeTime:0,coords:{x:0,y:0,scaleX:0,scaleY:0},endCoords:{x:0,y:0,scaleX:0,scaleY:0},xpath:{selector:"",fallbackCoords:{x:0,y:0}},params:{}});Re(()=>l.action,I=>{I&&(w.value=Fa(I),w.value.coords||(w.value.coords={x:0,y:0,scaleX:0,scaleY:0}),w.value.endCoords||(w.value.endCoords={x:0,y:0,scaleX:0,scaleY:0}),w.value.xpath||(w.value.xpath={selector:"",fallbackCoords:{x:0,y:0}}),w.value.params||(w.value.params={}))},{immediate:!0});const _=de(()=>({relativeTime:[{required:!0,type:"number",message:`${x.value.actions.relativeTime}`,trigger:"blur"},{type:"number",min:0,message:"",trigger:"blur"}],"coords.x":[{required:!0,type:"number",message:`${x.value.actions.coordinateX}`,trigger:"blur"},{type:"number",min:0,message:"",trigger:"blur"}],"coords.y":[{required:!0,type:"number",message:`${x.value.actions.coordinateY}`,trigger:"blur"},{type:"number",min:0,message:"",trigger:"blur"}],"endCoords.x":[{required:!0,type:"number",message:`${x.value.actions.coordinateX}`,trigger:"blur"},{type:"number",min:0,message:"",trigger:"blur"}],"endCoords.y":[{required:!0,type:"number",message:`${x.value.actions.coordinateY}`,trigger:"blur"},{type:"number",min:0,message:"",trigger:"blur"}],"params.text":[{required:!0,message:`${x.value.actions.inputText}`,trigger:"blur"}],"params.duration":[{required:!0,type:"number",message:"",trigger:"blur"}],"params.command":[{required:!0,message:"",trigger:"blur"}]}));async function S(){if(!(!F.value||!$.value))try{await F.value.validate();const I={};if(w.value.relativeTime!==$.value.relativeTime&&(I.relativeTime=w.value.relativeTime),$.value.type==="tap"){if(w.value.coords.x!==$.value.coords.x||w.value.coords.y!==$.value.coords.y){const{width:A,height:Z}=l.screenSize;if(!A||!Z||A<=0||Z<=0){console.error(`Invalid screen size: ${A}x${Z}. Cannot update coordinates.`);return}I.coords={x:w.value.coords.x,y:w.value.coords.y,scaleX:w.value.coords.x/A,scaleY:w.value.coords.y/Z},I.params={x:w.value.coords.x,y:w.value.coords.y}}const B=$.value.xpath?.selector||"",C=w.value.xpath?.selector||"";B!==C&&(C?I.xpath={selector:C,fallbackCoords:{x:w.value.coords.x,y:w.value.coords.y}}:I.xpath=void 0)}else if($.value.type==="swipe")if(w.value.coords.x!==$.value.coords.x||w.value.coords.y!==$.value.coords.y||w.value.endCoords.x!==$.value.endCoords.x||w.value.endCoords.y!==$.value.endCoords.y){const{width:C,height:A}=l.screenSize;if(!C||!A||C<=0||A<=0){console.error(`Invalid screen size: ${C}x${A}. Cannot update coordinates.`);return}I.coords={x:w.value.coords.x,y:w.value.coords.y,scaleX:w.value.coords.x/C,scaleY:w.value.coords.y/A},I.endCoords={x:w.value.endCoords.x,y:w.value.endCoords.y,scaleX:w.value.endCoords.x/C,scaleY:w.value.endCoords.y/A},I.params={startX:w.value.coords.x,startY:w.value.coords.y,endX:w.value.endCoords.x,endY:w.value.endCoords.y,duration:w.value.params.duration||.5}}else w.value.params.duration!==$.value.params.duration&&(I.params={...$.value.params,duration:w.value.params.duration});else $.value.type==="input"?w.value.params.text!==$.value.params.text&&(I.params={text:w.value.params.text}):$.value.type==="sleep"&&w.value.params.duration!==$.value.params.duration&&(I.params={duration:w.value.params.duration});v("save",$.value.id,I),E.value=!1}catch(I){console.warn(":",I)}}function j(){E.value=!1,v("cancel")}return(I,B)=>(D(),be(s(ht),{show:E.value,"onUpdate:show":B[12]||(B[12]=C=>E.value=C),preset:"dialog",title:O.value,"positive-text":x.value.common.save,"negative-text":x.value.common.cancel,onPositiveClick:S,onNegativeClick:j},{default:h(()=>[$.value?(D(),be(s(pt),{key:0,ref_key:"formRef",ref:F,model:w.value,rules:_.value,"label-placement":"left","label-width":"120","require-mark-placement":"left"},{default:h(()=>[u(s(Te),{label:x.value.actions.actionType},{default:h(()=>[u(s(Ke),{type:s(wt)($.value.type)},{default:h(()=>[K(U(x.value.actions.actionTypes[$.value.type]||$.value.type),1)]),_:1},8,["type"])]),_:1},8,["label"]),$.value.type==="tap"?(D(),N(He,{key:0},[u(s(Te),{label:x.value.actions.coordinateX,path:"coords.x"},{default:h(()=>[u(s(ze),{value:w.value.coords.x,"onUpdate:value":B[0]||(B[0]=C=>w.value.coords.x=C),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),u(s(Te),{label:x.value.actions.coordinateY,path:"coords.y"},{default:h(()=>[u(s(ze),{value:w.value.coords.y,"onUpdate:value":B[1]||(B[1]=C=>w.value.coords.y=C),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),u(s(Te),{label:x.value.actions.xpathSelector,path:"xpath.selector"},{default:h(()=>[u(s(je),{value:w.value.xpath.selector,"onUpdate:value":B[2]||(B[2]=C=>w.value.xpath.selector=C),type:"textarea",placeholder:x.value.actions.xpathPlaceholder,autosize:{minRows:2,maxRows:4}},null,8,["value","placeholder"])]),_:1},8,["label"])],64)):we("",!0),$.value.type==="swipe"?(D(),N(He,{key:1},[u(s(bt),{"title-placement":"left"},{default:h(()=>[K(U(x.value.actions.startPosition),1)]),_:1}),u(s(Te),{label:x.value.actions.coordinateX,path:"coords.x"},{default:h(()=>[u(s(ze),{value:w.value.coords.x,"onUpdate:value":B[3]||(B[3]=C=>w.value.coords.x=C),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),u(s(Te),{label:x.value.actions.coordinateY,path:"coords.y"},{default:h(()=>[u(s(ze),{value:w.value.coords.y,"onUpdate:value":B[4]||(B[4]=C=>w.value.coords.y=C),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),u(s(bt),{"title-placement":"left"},{default:h(()=>[K(U(x.value.actions.endPosition),1)]),_:1}),u(s(Te),{label:x.value.actions.coordinateX,path:"endCoords.x"},{default:h(()=>[u(s(ze),{value:w.value.endCoords.x,"onUpdate:value":B[5]||(B[5]=C=>w.value.endCoords.x=C),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),u(s(Te),{label:x.value.actions.coordinateY,path:"endCoords.y"},{default:h(()=>[u(s(ze),{value:w.value.endCoords.y,"onUpdate:value":B[6]||(B[6]=C=>w.value.endCoords.y=C),min:0,precision:0,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),u(s(Te),{label:x.value.actions.swipeDuration,path:"params.duration"},{default:h(()=>[u(s(ze),{value:w.value.params.duration,"onUpdate:value":B[7]||(B[7]=C=>w.value.params.duration=C),min:.1,max:10,step:.1,precision:1,style:{width:"100%"}},{suffix:h(()=>[K(U(x.value.actions.seconds),1)]),_:1},8,["value"])]),_:1},8,["label"])],64)):we("",!0),$.value.type==="input"?(D(),be(s(Te),{key:2,label:x.value.actions.inputText,path:"params.text"},{default:h(()=>[u(s(je),{value:w.value.params.text,"onUpdate:value":B[8]||(B[8]=C=>w.value.params.text=C),type:"textarea",placeholder:x.value.actions.inputText,autosize:{minRows:2,maxRows:6}},null,8,["value","placeholder"])]),_:1},8,["label"])):we("",!0),$.value.type==="sleep"?(D(),be(s(Te),{key:3,label:x.value.actions.sleepDuration,path:"params.duration"},{default:h(()=>[u(s(ze),{value:w.value.params.duration,"onUpdate:value":B[9]||(B[9]=C=>w.value.params.duration=C),min:0,step:100,precision:0,style:{width:"100%"}},{suffix:h(()=>[K(U(x.value.actions.milliseconds),1)]),_:1},8,["value"])]),_:1},8,["label"])):we("",!0),$.value.type==="command"||$.value.type==="back"||$.value.type==="home"?(D(),be(s(Te),{key:4,label:x.value.actions.command,path:"params.command"},{default:h(()=>[u(s(je),{value:w.value.params.command,"onUpdate:value":B[10]||(B[10]=C=>w.value.params.command=C),disabled:$.value.type==="back"||$.value.type==="home",placeholder:$.value.type==="back"?"back":$.value.type==="home"?"home":""},null,8,["value","disabled","placeholder"])]),_:1},8,["label"])):we("",!0),u(s(Te),{label:x.value.actions.relativeTime,path:"relativeTime"},{default:h(()=>[u(s(ze),{value:w.value.relativeTime,"onUpdate:value":B[11]||(B[11]=C=>w.value.relativeTime=C),min:0,step:100,precision:0,style:{width:"100%"}},{suffix:h(()=>[K(U(x.value.actions.milliseconds),1)]),_:1},8,["value"])]),_:1},8,["label"])]),_:1},8,["model","rules"])):we("",!0)]),_:1},8,["show","title","positive-text","negative-text"]))}}),Ua=Le(Ta,[["__scopeId","data-v-519ab678"]]);function Da(a,d,l=!0){const v=l?JSON.stringify(a,null,2):JSON.stringify(a),g=new Blob([v],{type:"application/json"});Ea(g,`${d}.json`)}function Ea(a,d){const l=URL.createObjectURL(a),v=document.createElement("a");v.href=l,v.download=d,v.click(),setTimeout(()=>{URL.revokeObjectURL(l)},100)}function Ma(a,d,l){const v=H(!1),g=H(!1),x=H([]),E=H(0),F=H(`Recording_${Date.now()}`),$=H({captureScreenshots:!1,screenshotQuality:.6,recordElementDetails:!0}),O=de(()=>x.value.length===0?0:x.value[x.value.length-1]?.relativeTime||0),w=de(()=>x.value.length);function _(M){v.value=!0,g.value=!1,x.value=[],E.value=Date.now(),M&&(F.value=M)}function S(){v.value=!1,g.value=!1}function j(){v.value&&(g.value=!0)}function I(){v.value&&(g.value=!1)}function B(){x.value=[],E.value=0}function C(M,q){const{width:te,height:ye}=l.value;if(!te||!ye||te<=0||ye<=0)throw new Error(`Invalid screen size: ${te}x${ye}. Recording requires valid screen dimensions.`);return{x:M,y:q,scaleX:M/te,scaleY:q/ye}}function A(M,q,te){if(!(!M||!M.xpath))return{selector:M.xpath,fallbackCoords:{x:q,y:te}}}function Z(M){if(!(!M||!$.value.recordElementDetails))return{text:M.text,label:M.label,resource_id:M.resource_id,class_name:M.class_name,content_desc:M.content_desc,bounds:M.bounds||[0,0,0,0],key:M.key}}async function Q(){$.value.captureScreenshots}async function ve(M,q,te,ye,X){if(!v.value||g.value)return;const J=Date.now(),ae={id:crypto.randomUUID(),timestamp:J,relativeTime:J-E.value,screenshot:await Q()};let Ae;switch(M){case"tap":Ae={...ae,type:"tap",coords:te,xpath:te?A(X||null,te.x,te.y):void 0,element:Z(X||null),params:q};break;case"swipe":Ae={...ae,type:"swipe",coords:te,endCoords:ye,element:Z(X||null),params:q};break;case"input":Ae={...ae,type:"input",element:Z(X||null),params:q};break;case"sleep":Ae={...ae,type:"sleep",params:q};break;case"command":case"back":case"home":Ae={...ae,type:M,params:q};break;default:console.warn("");return}x.value.push(Ae)}async function _e(M,q,te){const ye=C(M,q);await ve("tap",{x:M,y:q},ye,void 0,te)}async function Pe(M,q,te,ye,X,J){const ae=C(M,q),Ae=C(te,ye);await ve("swipe",{startX:M,startY:q,endX:te,endY:ye,duration:X},ae,Ae,J)}async function fe(M,q){await ve("input",{text:M},void 0,void 0,q)}async function L(M){await ve("sleep",{duration:M})}async function P(M,q){await ve("command",{command:M,args:q})}function z(M){const q=x.value.findIndex(te=>te.id===M);q!==-1&&x.value.splice(q,1)}function V(M,q){const te=x.value.findIndex(J=>J.id===M);if(te===-1)return console.warn(`Action with id ${M} not found`),!1;const ye=x.value[te],X={...ye,...q};if(X.type!==ye.type)throw new Error("Cannot change action type");if(X.id!==ye.id)throw new Error("Cannot change action id");if(X.timestamp!==ye.timestamp)throw new Error("Cannot change action timestamp");return x.value[te]=X,!0}function Y(M){return{version:"1.0",name:M||F.value,description:void 0,platform:a,deviceInfo:{serial:d,screenWidth:l.value.width,screenHeight:l.value.height},createdAt:E.value,updatedAt:Date.now(),duration:O.value,config:$.value,actions:x.value}}function ee(M){F.value=M.name,x.value=M.actions,E.value=M.createdAt,$.value=M.config}function Ce(){const M=Y();Da(M,`${M.name}.byteautoui`)}function pe(M){if(!M||typeof M!="object")return!1;if(M.version!=="1.0")return console.error(":",M.version),!1;if(typeof M.name!="string")return console.error(""),!1;if(!M.platform||!["android","ios","harmony"].includes(M.platform))return console.error(":",M.platform),!1;if(!M.deviceInfo||typeof M.deviceInfo.screenWidth!="number"||typeof M.deviceInfo.screenHeight!="number")return console.error(""),!1;if(!Array.isArray(M.actions))return console.error(""),!1;for(let q=0;q<M.actions.length;q++){const te=M.actions[q];if(!te||typeof te!="object")return console.error(` ${q} `),!1;if(!te.type||typeof te.timestamp!="number"||typeof te.relativeTime!="number")return console.error(` ${q} `),!1;if((te.type==="tap"||te.type==="swipe")&&!te.coords)return console.error(` ${q} (${te.type}) `),!1;if(te.type==="swipe"&&!te.endCoords)return console.error(` ${q} (swipe) `),!1}return!0}async function oe(){return new Promise((M,q)=>{const te=document.createElement("input");te.type="file",te.accept=".byteautoui.json,.json",te.onchange=async()=>{const ye=te.files?.[0];if(!ye){q(new Error(""));return}try{const X=await ye.text(),J=JSON.parse(X);if(!pe(J)){q(new Error(""));return}ee(J),M(J)}catch(X){X instanceof SyntaxError?q(new Error("JSON")):q(X)}},te.click()})}return{isRecording:v,isPaused:g,actions:x,recordingName:F,config:$,duration:O,actionCount:w,start:_,stop:S,pause:j,resume:I,clear:B,recordTap:_e,recordSwipe:Pe,recordInput:fe,recordSleep:L,recordCommand:P,deleteAction:z,updateAction:V,exportRecording:Y,importRecording:ee,saveToFile:Ce,loadFromFile:oe}}function Ba(a,d,l){const v=H("idle"),g=H(-1),x=H(null),E=H(null),F=H(1),$=de(()=>({currentIndex:g.value,totalSteps:x.value?.actions.length||0,elapsedTime:0,state:v.value,error:E.value||void 0})),O=de(()=>v.value==="playing"),w=de(()=>v.value==="paused"),_=de(()=>x.value!==null&&x.value.actions.length>0);function S(L){x.value=L,g.value=-1,v.value="idle",E.value=null}function j(){x.value=null,g.value=-1,v.value="idle",E.value=null}function I(L){return new Promise(P=>setTimeout(P,L/F.value))}function B(L){const{width:P,height:z}=l.value;if(!P||!z||P<=0||z<=0)throw new Error(`:(${P}x${z}),`);return{x:Math.round(L.scaleX*P),y:Math.round(L.scaleY*z)}}async function C(L){try{let P=function(oe){for(const M of oe){if(M.xpath===L)return M;if(M.children){const q=P(M.children);if(q)return q}}return null};const z=await It(a,d),V=P(z.nodes);if(!V||!V.bounds)return null;const[Y,ee,Ce,pe]=V.bounds;return{x:Math.round((Y+Ce)/2),y:Math.round((ee+pe)/2)}}catch(P){return console.error("XPath:",P),null}}async function A(L){switch(L.type){case"tap":{let P,z;if(L.xpath){const V=await C(L.xpath.selector);if(V)P=V.x,z=V.y;else{if(console.warn("XPath:",L.xpath.selector),!L.coords)throw new Error("Tap");const Y=B(L.coords);P=Y.x,z=Y.y}}else{if(!L.coords)throw new Error("Tap");const V=B(L.coords);P=V.x,z=V.y}await vt(a,d,P,z);break}case"swipe":{if(!L.coords||!L.endCoords)throw new Error("Swipe");const P=B(L.coords),z=B(L.endCoords),V=L.params;await Fe(a,d,"swipe",{startX:P.x,startY:P.y,endX:z.x,endY:z.y,duration:V.duration||.5});break}case"input":{const P=L.params;await Fe(a,d,"sendKeys",{text:P.text});break}case"sleep":{const P=L.params;await I(P.duration);break}case"back":{await Fe(a,d,"back",{});break}case"home":{await Fe(a,d,"home",{});break}case"command":{const P=L.params;await Fe(a,d,P.command,P.args||{});break}default:console.warn("")}}async function Z(){if(!x.value||x.value.actions.length===0){E.value="";return}for(v.value==="paused"?v.value="playing":(g.value=0,v.value="playing",E.value=null);g.value<x.value.actions.length&&v.value==="playing";){const L=x.value.actions[g.value];try{if(await A(L),v.value!=="playing")break;if(g.value<x.value.actions.length-1){const z=x.value.actions[g.value+1].relativeTime-L.relativeTime;if(await I(z),v.value!=="playing")break}g.value++}catch(P){E.value=P instanceof Error?P.message:String(P),v.value="error",console.error(` ${g.value}:`,P);break}}v.value==="playing"&&(v.value="idle",g.value=-1)}function Q(){v.value==="playing"&&(v.value="paused")}function ve(){v.value="stopped",g.value=-1,E.value=null}async function _e(){if(!x.value||g.value>=x.value.actions.length-1)return;v.value="paused",g.value++;const L=x.value.actions[g.value];try{await A(L)}catch(P){E.value=P instanceof Error?P.message:String(P),v.value="error",console.error(` ${g.value}:`,P)}}function Pe(L){x.value&&L>=0&&L<x.value.actions.length&&(g.value=L,v.value="paused")}function fe(L){F.value=Math.max(.1,Math.min(5,L))}return{state:v,currentIndex:g,recording:x,error:E,speed:F,progress:$,isPlaying:O,isPaused:w,canPlay:_,load:S,unload:j,play:Z,pause:Q,stop:ve,stepNext:_e,seekTo:Pe,setSpeed:fe}}const at="";async function Ra(a){const d=await fetch(`${at}/api/recordings/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!d.ok){const l=await d.text(),v=`"${a.name}" (:${a.group}, HTTP ${d.status}): ${l}`;throw console.error(v,{request:a,status:d.status}),new Error(v)}}async function Oa(){const a=await fetch(`${at}/api/recordings/list`);if(!a.ok){const l=await a.text(),v=` (HTTP ${a.status}): ${l}`;throw console.error(v,{status:a.status}),new Error(v)}return(await a.json()).recordings}async function Et(a,d){const l=await fetch(`${at}/api/recordings/load?group=${encodeURIComponent(a)}&name=${encodeURIComponent(d)}`);if(!l.ok){const g=await l.text(),x=`"${d}" (:${a}, HTTP ${l.status}): ${g}`;throw console.error(x,{group:a,name:d,status:l.status}),new Error(x)}return(await l.json()).data}async function za(a,d){const l=await fetch(`${at}/api/recordings/delete?group=${encodeURIComponent(a)}&name=${encodeURIComponent(d)}`,{method:"DELETE"});if(!l.ok){const v=await l.text(),g=`"${d}" (:${a}, HTTP ${l.status}): ${v}`;throw console.error(g,{group:a,name:d,status:l.status}),new Error(g)}}const Ia={class:"actions-panel"},La=ce({__name:"ActionsPanel",props:{platform:{},serial:{}},setup(a,{expose:d}){const l=a,v=qe(),g=Qt(),x=rt(),E=Ge(),F=de(()=>E.t.actions);function $(X,J){v.error(`${X}: ${J instanceof Error?J.message:String(J)}`)}const O=H("record"),w=H([]),_=H(!1),S=H(!1),j=H({group:"default",name:""}),I=H(!1),B=H(null),C=de(()=>x.screenSize),A=Ma(l.platform,l.serial,C),Z=Ba(l.platform,l.serial,C);function Q(){A.isRecording.value?A.stop():A.start()}function ve(){A.isPaused.value?A.resume():A.pause()}function _e(){g.warning({title:"",content:"",positiveText:"",negativeText:"",onPositiveClick:()=>{A.clear(),v.success("")}})}function Pe(){const X=new Date,J=X.getFullYear(),ae=String(X.getMonth()+1).padStart(2,"0"),Ae=String(X.getDate()).padStart(2,"0"),Me=String(X.getHours()).padStart(2,"0"),Be=String(X.getMinutes()).padStart(2,"0"),G=String(X.getSeconds()).padStart(2,"0");return`Recording_${J}${ae}${Ae}_${Me}${Be}${G}`}function fe(){j.value.name=Pe(),j.value.group="default",S.value=!0}async function L(){if(!j.value.name){v.warning("");return}if(A.actionCount.value===0){v.warning("");return}try{const X=A.exportRecording(j.value.name);await Ra({group:j.value.group||"default",name:j.value.name,data:X}),v.success(""),S.value=!1,j.value={group:"default",name:""},await Y()}catch(X){$("",X)}}function P(X){A.deleteAction(X)}function z(X){B.value=X,I.value=!0}function V(X,J){try{A.updateAction(X,J)?v.success(""):v.error("")}catch(ae){$("",ae)}}async function Y(){_.value=!0;try{w.value=await Oa()}catch(X){$("",X)}finally{_.value=!1}}async function ee(X,J){try{const ae=await Et(X,J);Z.load(ae),v.success(`: ${J}`)}catch(ae){$("",ae)}}async function Ce(X,J){if(A.actionCount.value>0){g.warning({title:"",content:"",positiveText:"",negativeText:"",onPositiveClick:async()=>{await pe(X,J)}});return}await pe(X,J)}async function pe(X,J){try{const ae=await Et(X,J);A.importRecording(ae),O.value="record",v.success(` "${J}" `)}catch(ae){$("",ae)}}async function oe(X,J){g.warning({title:"",content:` "${J}" `,positiveText:"",negativeText:"",onPositiveClick:async()=>{try{await za(X,J),v.success(""),await Y()}catch(ae){$("",ae)}}})}async function M(){try{await Z.play()}catch(X){$("",X)}}async function q(X,J,ae){await A.recordTap(X,J,ae)}async function te(X,J,ae,Ae,Me,Be){await A.recordSwipe(X,J,ae,Ae,Me,Be)}function ye(){return A.isRecording.value}return zt(()=>{Y()}),d({recordTap:q,recordSwipe:te,getIsRecording:ye}),(X,J)=>(D(),N("div",Ia,[u(s(en),{value:O.value,"onUpdate:value":J[0]||(J[0]=ae=>O.value=ae),type:"segment"},{default:h(()=>[u(s(St),{name:"record",tab:F.value.recordTab},{default:h(()=>[u(pa,{recorder:s(A),"current-playback-index":s(Z).currentIndex.value,"is-playback-active":s(Z).isPlaying.value,t:F.value,onToggleRecording:Q,onTogglePause:ve,onClearRecording:_e,onSaveRecording:fe,onEditAction:z,onDeleteAction:P},null,8,["recorder","current-playback-index","is-playback-active","t"])]),_:1},8,["tab"]),u(s(St),{name:"playback",tab:F.value.playbackTab},{default:h(()=>[u(Aa,{player:s(Z),recordings:w.value,loading:_.value,"is-recording-active":s(A).isRecording.value,t:F.value,"common-t":s(E).t.common,onRefreshRecordings:Y,onStartPlayback:M,onLoadRecording:ee,onEditRecording:Ce,onDeleteRecording:oe},null,8,["player","recordings","loading","is-recording-active","t","common-t"])]),_:1},8,["tab"])]),_:1},8,["value"]),u(s(ht),{show:S.value,"onUpdate:show":J[4]||(J[4]=ae=>S.value=ae),preset:"dialog",title:""},{action:h(()=>[u(s(Ie),{justify:"end"},{default:h(()=>[u(s(se),{onClick:J[3]||(J[3]=ae=>S.value=!1)},{default:h(()=>[...J[6]||(J[6]=[K("",-1)])]),_:1}),u(s(se),{type:"primary",onClick:L},{default:h(()=>[...J[7]||(J[7]=[K("",-1)])]),_:1})]),_:1})]),default:h(()=>[u(s(pt),{model:j.value},{default:h(()=>[u(s(Te),{label:""},{default:h(()=>[u(s(je),{value:j.value.group,"onUpdate:value":J[1]||(J[1]=ae=>j.value.group=ae),placeholder:"default"},null,8,["value"])]),_:1}),u(s(Te),{label:""},{default:h(()=>[u(s(je),{value:j.value.name,"onUpdate:value":J[2]||(J[2]=ae=>j.value.name=ae),placeholder:"my-recording"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),u(Ua,{show:I.value,"onUpdate:show":J[5]||(J[5]=ae=>I.value=ae),action:B.value,"screen-size":C.value,onSave:V},null,8,["show","action","screen-size"])]))}}),Na=Le(La,[["__scopeId","data-v-a80a602c"]]),ja={class:"package-panel"},Ha={class:"package-content"},Va={class:"install-section"},Xa={class:"package-list-section"},Ga={key:0,class:"loading-state"},Wa={class:"loading-text"},Ya={key:1,class:"empty-state"},Ja={class:"empty-hint"},qa={key:2,class:"package-list"},Ka={class:"package-info"},Za={class:"package-name"},Qa={class:"package-id"},eo={key:0,class:"package-version"},to=ce({__name:"PackagePanel",props:{platform:{},serial:{}},setup(a){const d=a,l=qe(),v=Ge(),g=de(()=>v.t.package),x=H([]),E=H(!1),F=H(""),$=H(""),O=de(()=>{if(!F.value)return x.value;const C=F.value.toLowerCase();return x.value.filter(A=>A.name.toLowerCase().includes(C)||A.package.toLowerCase().includes(C))});async function w(){E.value=!0;try{const C=await Fe(d.platform,d.serial,"appList",{});Array.isArray(C)?(x.value=C.map(A=>{const Z=A.package||A.packageName||A.pkg||"";return{name:A.name||A.label||A.appName||Z,package:Z,version:A.version||A.versionName||A.ver||""}}).filter(A=>A.package),l.success(` ${x.value.length} `)):l.error("")}catch(C){l.error(`: ${C instanceof Error?C.message:String(C)}`)}finally{E.value=!1}}async function _(C){try{await Fe(d.platform,d.serial,"appLaunch",{package:C}),l.success(g.value.appLaunched)}catch(A){l.error(`${g.value.launch} failed: ${A instanceof Error?A.message:String(A)}`)}}async function S(C){try{await Fe(d.platform,d.serial,"uninstallApp",{package:C}),l.success(g.value.appUninstalled),await w()}catch(A){l.error(`${g.value.uninstall} failed: ${A instanceof Error?A.message:String(A)}`)}}async function j(C){try{await Fe(d.platform,d.serial,"clearApp",{package:C}),l.success(g.value.dataCleared)}catch(A){l.error(`${g.value.clear} failed: ${A instanceof Error?A.message:String(A)}`)}}async function I(C){try{const Z=`${window.location.origin}/api/${d.platform}/${d.serial}/backupApp?package=${encodeURIComponent(C)}`,Q=document.createElement("a");Q.href=Z,Q.download=`${C}.apk`,Q.click(),l.success(`Downloading: ${C}.apk`)}catch(A){l.error(`Backup failed: ${A instanceof Error?A.message:String(A)}`)}}async function B(){if($.value.trim())try{await Fe(d.platform,d.serial,"installApp",{path:$.value}),l.success(`Installed: ${$.value}`),$.value="",await w()}catch(C){l.error(`Install failed: ${C instanceof Error?C.message:String(C)}`)}}return(C,A)=>{const Z=Oe("n-input"),Q=Oe("n-button"),ve=Oe("n-space"),_e=Oe("n-icon"),Pe=Oe("n-spin"),fe=Oe("n-empty");return D(),N("div",ja,[y("div",Ha,[u(ve,{vertical:"",size:16},{default:h(()=>[y("div",Va,[y("h4",null,U(g.value.currentApp),1),u(ve,{size:8},{default:h(()=>[u(Z,{value:$.value,"onUpdate:value":A[0]||(A[0]=L=>$.value=L),placeholder:"APK file path",style:{flex:"1"}},null,8,["value"]),u(Q,{type:"primary",onClick:B,disabled:!$.value.trim()},{default:h(()=>[...A[2]||(A[2]=[K(" Install ",-1)])]),_:1},8,["disabled"])]),_:1})]),y("div",Xa,[u(ve,{justify:"space-between",align:"center",style:{"margin-bottom":"12px"}},{default:h(()=>[y("h4",null,U(g.value.installedApps)+" ("+U(O.value.length)+")",1),u(ve,{size:8},{default:h(()=>[u(Z,{value:F.value,"onUpdate:value":A[1]||(A[1]=L=>F.value=L),placeholder:s(v).t.common.search+"...",clearable:"",style:{width:"200px"}},null,8,["value","placeholder"]),u(Q,{onClick:w,loading:E.value},{icon:h(()=>[u(_e,null,{default:h(()=>[u(s(mt))]),_:1})]),default:h(()=>[K(" "+U(s(v).t.common.refresh),1)]),_:1},8,["loading"])]),_:1})]),_:1}),E.value?(D(),N("div",Ga,[u(Pe,{size:"large"}),y("div",Wa,U(s(v).t.common.loading),1)])):O.value.length===0?(D(),N("div",Ya,[u(fe,{description:g.value.noApps},null,8,["description"]),y("div",Ja,[y("p",null,'"'+U(s(v).t.common.refresh)+'"',1),A[3]||(A[3]=y("p",{class:"empty-hint-small"},"",-1))])])):(D(),N("div",qa,[(D(!0),N(He,null,Je(O.value,L=>(D(),N("div",{key:L.package,class:"package-item"},[y("div",Ka,[y("div",Za,U(L.name||""),1),y("div",Qa,U(L.package||""),1),L.version?(D(),N("div",eo,"v"+U(L.version),1)):we("",!0)]),u(ve,{size:8},{default:h(()=>[u(Q,{size:"small",onClick:P=>_(L.package)},{default:h(()=>[K(U(g.value.launch),1)]),_:1},8,["onClick"]),u(Q,{size:"small",onClick:P=>I(L.package)},{icon:h(()=>[u(_e,null,{default:h(()=>[u(s(Pn))]),_:1})]),default:h(()=>[A[4]||(A[4]=K(" Backup ",-1))]),_:1},8,["onClick"]),u(Q,{size:"small",onClick:P=>j(L.package)},{default:h(()=>[K(U(g.value.clear),1)]),_:1},8,["onClick"]),u(Q,{size:"small",type:"error",onClick:P=>S(L.package)},{default:h(()=>[K(U(g.value.uninstall),1)]),_:1},8,["onClick"])]),_:2},1024)]))),128))]))])]),_:1})])])}}}),no=Le(to,[["__scopeId","data-v-fff7dce7"]]),ro={class:"modal-title"},ao={class:"config-content"},oo={style:{"font-weight":"600"}},io={style:{"font-size":"13px","line-height":"1.6"}},so={style:{margin:"0 0 8px 0"}},lo={style:{margin:"0"}},uo={class:"bundle-hints"},co={class:"hints-title"},fo={class:"hint-label"},ho={class:"hint-label"},po={class:"help-section"},vo={class:"help-title"},mo={class:"help-list"},xo={class:"help-note"},yo=ce({__name:"IOSConfigDialog",props:{show:{type:Boolean},serial:{},errorMessage:{}},emits:["update:show","confirm"],setup(a,{emit:d}){const l=d,v=qe(),g=Ge(),x=de(()=>g.t.iosConfig),E=H({bundleId:"com.facebook.WebDriverAgentRunner.xctrunner",port:8100}),F=H(!1);function $(){l("update:show",!1)}async function O(){if(!E.value.bundleId.trim()){v.warning("Please enter WDA Bundle ID");return}if(!Number.isFinite(E.value.port)||E.value.port<=0){v.warning("Please enter WDA Port");return}F.value=!0;try{l("confirm",E.value.bundleId,E.value.port),v.success("Configuration saved"),l("update:show",!1)}finally{F.value=!1}}return(w,_)=>(D(),be(s(ht),{show:a.show,"onUpdate:show":_[4]||(_[4]=S=>l("update:show",S)),preset:"card",size:"medium",bordered:!1,segmented:{content:!0},style:{"max-width":"600px"},closable:!1},{header:h(()=>[u(s(Ie),{align:"center",size:12},{default:h(()=>[u(s(le),{size:"24",color:"var(--md-primary)"},{default:h(()=>[u(s(nr))]),_:1}),y("span",ro,U(x.value.title),1)]),_:1})]),footer:h(()=>[u(s(Ie),{justify:"end"},{default:h(()=>[u(s(se),{onClick:$,disabled:F.value},{default:h(()=>[K(U(x.value.cancel),1)]),_:1},8,["disabled"]),u(s(se),{type:"primary",onClick:O,loading:F.value},{default:h(()=>[K(U(x.value.saveConfiguration),1)]),_:1},8,["loading"])]),_:1})]),default:h(()=>[y("div",ao,[a.errorMessage?(D(),be(s(ct),{key:0,title:x.value.wdaStartFailed,type:"error",bordered:!1,style:{"margin-bottom":"20px"}},{default:h(()=>[K(U(a.errorMessage),1)]),_:1},8,["title"])):we("",!0),u(s(ct),{type:"info",bordered:!1,style:{"margin-bottom":"24px"}},{header:h(()=>[y("span",oo,U(x.value.firstTimeSetup),1)]),default:h(()=>[y("div",io,[y("p",so,U(x.value.setupDescription),1),y("p",lo,[y("strong",null,U(x.value.setupGuide),1),_[5]||(_[5]=K()),_[6]||(_[6]=y("a",{href:"https://github.com/appium/WebDriverAgent#getting-started",target:"_blank"},"appium/WebDriverAgent",-1))])])]),_:1}),u(s(pt),{"label-placement":"left","label-width":"120",model:E.value},{default:h(()=>[u(s(Te),{label:x.value.deviceUDID,path:"serial"},{default:h(()=>[u(s(je),{value:a.serial,readonly:"",disabled:""},null,8,["value"])]),_:1},8,["label"]),u(s(Te),{label:x.value.wdaBundleId,path:"bundleId",required:""},{default:h(()=>[u(s(je),{value:E.value.bundleId,"onUpdate:value":_[0]||(_[0]=S=>E.value.bundleId=S),placeholder:"com.facebook.WebDriverAgentRunner.xctrunner",style:{fontFamily:"var(--md-font-family-mono)",fontSize:"13px"}},null,8,["value"])]),_:1},8,["label"]),u(s(Te),{label:x.value.wdaPort,path:"port"},{default:h(()=>[u(s(ze),{value:E.value.port,"onUpdate:value":_[1]||(_[1]=S=>E.value.port=S),min:1,max:65535,placeholder:"8100"},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"]),y("div",uo,[y("div",co,U(x.value.commonBundleIds),1),y("div",{class:"hint-item",onClick:_[2]||(_[2]=S=>E.value.bundleId="com.facebook.WebDriverAgentRunner.xctrunner")},[_[7]||(_[7]=y("code",null,"com.facebook.WebDriverAgentRunner.xctrunner",-1)),y("span",fo,U(x.value.defaultBundleId),1)]),y("div",{class:"hint-item",onClick:_[3]||(_[3]=S=>E.value.bundleId="com.appium.WebDriverAgentRunner.xctrunner")},[_[8]||(_[8]=y("code",null,"com.appium.WebDriverAgentRunner.xctrunner",-1)),y("span",ho,U(x.value.appiumBundleId),1)])]),y("div",po,[y("p",vo,U(x.value.helpTitle),1),y("ol",mo,[y("li",null,U(x.value.helpSteps.step1),1),y("li",null,U(x.value.helpSteps.step2),1),y("li",null,U(x.value.helpSteps.step3),1)]),y("p",xo,[y("strong",null,U(x.value.helpNote),1)])])])]),_:1},8,["show"]))}}),go=Le(yo,[["__scopeId","data-v-27c06d6d"]]),wo={class:"device-page"},ko={class:"page-header"},bo={class:"serial"},So={class:"main-area"},_o={class:"control-sidebar"},Co={class:"control-group"},$o={class:"control-group"},Po={class:"control-group"},Ao={key:0,class:"control-group"},Fo={class:"vertical-text"},To={class:"screen-content"},Uo={class:"text-input-bar"},Do={class:"screenshot-area"},Eo={key:0,class:"property-details-panel"},Mo={class:"xpath-selector-bar"},Bo={class:"xpath-select-wrapper"},Ro={key:0,class:"xpath-display-bar"},Oo={class:"xpath-text"},zo={key:0,class:"siblings-nav"},Io={class:"property-details-table"},Lo={class:"property-cell label-cell"},No={class:"property-cell value-cell"},jo={class:"right-panel"},Ho=ce({__name:"Device",props:{platform:{},serial:{}},setup(a){const d=a,l=ln(),v=qe(),g=rt(),x=tn(),E=Ge(),F=H(null),$=H("hierarchy"),O=H(!1),w=H(!1),_=H(void 0),S=de(()=>E.t.device),j=H(""),I=H(450),B=H(!1);function C(i){B.value=!0,i.preventDefault()}function A(i){if(!B.value)return;const p=i.clientX;p>=300&&p<=800&&(I.value=p,localStorage.setItem("screenPanelWidth",p.toString()))}function Z(){B.value=!1}async function Q(i,p={},T,R){try{await Fe(d.platform,d.serial,i,p),v.success(T)}catch(re){v.error(`${R}: ${re instanceof Error?re.message:String(re)}`)}}const ve=()=>Q("volumeUp",{},"Volume up","Volume control failed"),_e=()=>Q("volumeDown",{},"Volume down","Volume control failed"),Pe=()=>Q("volumeMute",{},"Volume muted","Volume control failed"),fe=H(""),L=H(d.platform==="ios"?"class_and_label":"id");Re(()=>d.platform,i=>{(i==="ios"?new Set(["label","class","class_and_label"]):new Set(["id","text","class","class_and_text"])).has(L.value)||(L.value=i==="ios"?"class_and_label":"id")},{immediate:!0});const P=(i,p)=>{if(!p)return"";switch(i){case"id":return p.resource_id?`//*[@resource-id="${p.resource_id}"]`:"";case"content-desc":return p.content_desc?`//*[@content-desc="${p.content_desc}"]`:"";case"text":return p.text?`//*[@text="${p.text}"]`:"";case"label":return p.label?`//*[@label="${p.label}"]`:"";case"class_and_text":return p.class_name&&p.text?`//${p.class_name}[@text="${p.text}"]`:"";case"class_and_label":return p.class_name&&p.label?`//${p.class_name}[@label="${p.label}"]`:"";case"class":return p.class_name?`//${p.class_name}`:"";default:return p.xpath||""}},z=de(()=>{const i=G.value;if(!i)return[];const p=(R,re)=>{if(!re||!g.hierarchy?.nodes)return 0;let he=0;function xe(ke){ke.forEach($e=>{P(R,$e)===re&&he++,$e.children&&xe($e.children)})}return xe(g.hierarchy.nodes),he};return(d.platform==="ios"?[{label:"class_and_label",value:"class_and_label",xpath:P("class_and_label",i)},{label:"label",value:"label",xpath:P("label",i)},{label:"class",value:"class",xpath:P("class",i)}]:[{label:"id",value:"id",xpath:P("id",i)},{label:"class_and_text",value:"class_and_text",xpath:P("class_and_text",i)},{label:"class",value:"class",xpath:P("class",i)},{label:"text",value:"text",xpath:P("text",i)}]).map(R=>({...R,count:R.xpath?p(R.value,R.xpath):0}))}),V=de(()=>P(L.value,G.value)),Y=H([]),ee=H(-1);function Ce(i){if(Y.value=[],ee.value=-1,!i||!g.hierarchy?.nodes)return;const p=P(L.value,i);if(!p)return;const T=[];function R(re){re.forEach(he=>{P(L.value,he)===p&&T.push(he),he.children&&R(he.children)})}R(g.hierarchy.nodes),T.length>1&&(Y.value=T,ee.value=T.findIndex(re=>re.key===i.key))}function pe(i){i>=0&&i<Y.value.length&&g.selectNode(Y.value[i])}function oe({option:i}){return i.label}function M(i){return me("div",{class:"xpath-option"},[me("span",{class:"xpath-option-label"},i.label),me("div",{class:"xpath-option-right"},[i.xpath?me("span",{class:"xpath-option-preview"},i.xpath):null,i.count>0?me("span",{class:"xpath-option-count"},i.count.toString()):null].filter(Boolean))])}async function q(){if(!fe.value.trim()){v.warning("Please enter text");return}try{await Fe(d.platform,d.serial,"sendKeys",{text:fe.value}),v.success(`Sent: ${fe.value}`),fe.value=""}catch(i){v.error(`Send text failed: ${i instanceof Error?i.message:String(i)}`)}}async function te(){try{await Fe(d.platform,d.serial,"clearText",{}),v.success("Text cleared")}catch(i){v.error(`Clear text failed: ${i instanceof Error?i.message:String(i)}`)}}const ye=()=>Q("home",{},"Home","Home failed"),X=()=>Q("back",{},"Back","Back failed"),J=()=>Q("appSwitch",{},"App Switch","App Switch failed"),ae=()=>Q("wakeUp",{},"Wake Up","Wake Up failed"),Ae=()=>Q("terminate",{},"Terminated current app","Terminate failed"),Me=de(()=>{switch(d.platform){case"android":return $t;case"ios":return cn;case"harmony":return Pt;default:return $t}}),Be=de(()=>{const i=g.screenSize;return{width:i?.width||0,height:i?.height||0}}),G=de(()=>g.selectedNode);Re(()=>[G.value,L.value],([i])=>{Ce(i)},{immediate:!0});function W(i){const p={};if(i.index!==void 0&&(p.index=String(i.index)),i.text&&(p.text=i.text),i.label&&(p.label=i.label),i.resource_id&&(p["resource-id"]=i.resource_id),i.class_name&&(p.class=i.class_name),i.package&&(p.package=i.package),i.content_desc&&(p["content-desc"]=i.content_desc),i.checkable!==void 0&&(p.checkable=String(i.checkable)),i.checked!==void 0&&(p.checked=String(i.checked)),i.clickable!==void 0&&(p.clickable=String(i.clickable)),i.enabled!==void 0&&(p.enabled=String(i.enabled)),i.focusable!==void 0&&(p.focusable=String(i.focusable)),i.focused!==void 0&&(p.focused=String(i.focused)),i.scrollable!==void 0&&(p.scrollable=String(i.scrollable)),i.long_clickable!==void 0&&(p["long-clickable"]=String(i.long_clickable)),i.password!==void 0&&(p.password=String(i.password)),i.selected!==void 0&&(p.selected=String(i.selected)),i.visible_to_user!==void 0&&(p["visible-to-user"]=String(i.visible_to_user)),i.bounds){const[T,R,re,he]=i.bounds;p.bounds=`[${T},${R}][${re},${he}]`}return p}const ne=de(()=>{if(!G.value)return[];const i=G.value,p=[];if(i.index!==void 0&&p.push({label:"index",value:i.index}),i.text&&p.push({label:"text",value:i.text}),i.label&&p.push({label:"label",value:i.label}),i.resource_id&&p.push({label:"resource-id",value:i.resource_id}),i.class_name&&p.push({label:"class",value:i.class_name}),i.package&&p.push({label:"package",value:i.package}),i.content_desc&&p.push({label:"content-desc",value:i.content_desc}),i.checkable!==void 0&&p.push({label:"checkable",value:i.checkable}),i.checked!==void 0&&p.push({label:"checked",value:i.checked}),i.clickable!==void 0&&p.push({label:"clickable",value:i.clickable}),i.enabled!==void 0&&p.push({label:"enabled",value:i.enabled}),i.focusable!==void 0&&p.push({label:"focusable",value:i.focusable}),i.focused!==void 0&&p.push({label:"focused",value:i.focused}),i.scrollable!==void 0&&p.push({label:"scrollable",value:i.scrollable}),i.long_clickable!==void 0&&p.push({label:"long-clickable",value:i.long_clickable}),i.password!==void 0&&p.push({label:"password",value:i.password}),i.selected!==void 0&&p.push({label:"selected",value:i.selected}),i.visible_to_user!==void 0&&p.push({label:"visible-to-user",value:i.visible_to_user}),i.bounds){const[T,R,re,he]=i.bounds;p.push({label:"bounds",value:`[${T},${R}][${re},${he}]`})}return i.rect&&(p.push({label:"rect.x",value:i.rect.x}),p.push({label:"rect.y",value:i.rect.y}),p.push({label:"rect.width",value:i.rect.width}),p.push({label:"rect.height",value:i.rect.height})),i.xpath&&p.push({label:"xpath",value:i.xpath}),p.push({label:"raw",value:JSON.stringify(W(i),null,2)}),p});function ie(i){const{width:p,height:T}=Be.value,[R,re,he,xe]=i;if(he<=1&&xe<=1){if(!p||!T)throw new Error("");return[Math.round(R*p),Math.round(re*T),Math.round(he*p),Math.round(xe*T)]}return i}function ue(i,p){}async function De(i,p,T){if(F.value)try{await F.value.recordTap(i,p,T)}catch(R){v.error(`: ${R instanceof Error?R.message:String(R)}`),console.error("Failed to record tap:",R)}}async function Ue(i,p,T,R,re,he){if(F.value)try{await F.value.recordSwipe(i,p,T,R,re,he)}catch(xe){v.error(`: ${xe instanceof Error?xe.message:String(xe)}`),console.error("Failed to record swipe:",xe)}}async function Ne(){if(!G.value||!G.value.bounds){v.warning("");return}try{const i=V.value||G.value.xpath;if(i)await Fe(d.platform,d.serial,"clickElement",{by:"xpath",value:i}),v.success(" XPath ");else{const p=ie(G.value.bounds),[T,R,re,he]=p,xe=Math.round((T+re)/2),ke=Math.round((R+he)/2);await vt(d.platform,d.serial,xe,ke),v.success(`: (${xe}, ${ke})`)}if(F.value?.getIsRecording?.()){const p=ie(G.value.bounds),[T,R,re,he]=p,xe=Math.round((T+re)/2),ke=Math.round((R+he)/2);await F.value.recordTap(xe,ke,G.value),v.info(" XPath")}}catch(i){v.error(`: ${i instanceof Error?i.message:String(i)}`)}}async function n(){if(await g.refreshHierarchy(),g.error&&d.platform==="ios"){const i=g.error;if(i.includes("InvalidService")||i.includes("WDA")||i.includes("WebDriverAgent")){_.value=i,w.value=!0;return}}try{const i=await Fe(d.platform,d.serial,"currentApp",{});i&&typeof i=="object"&&"package"in i&&(j.value=i.package||"")}catch{}}async function c(i,p){try{await fn(d.serial,{wda_bundle_id:i,wda_port:p}),v.success(""),w.value=!1,_.value=void 0,await n()}catch(T){v.error(`: ${T instanceof Error?T.message:String(T)}`)}}function e(){navigator.clipboard.writeText(d.serial),v.success("Copied")}function t(i,p){l.push(`/${i}/${p}`)}function r(){const i=V.value;if(!i){v.warning("No XPath available");return}navigator.clipboard.writeText(i),v.success("XPath copied")}function o(i){(i.key==="r"||i.key==="R")&&!i.ctrlKey&&!i.metaKey&&(i.preventDefault(),n())}zt(()=>{const i=localStorage.getItem("screenPanelWidth");i&&(I.value=parseInt(i,10)),document.addEventListener("mousemove",A),document.addEventListener("mouseup",Z),g.setDevice(d.platform,d.serial),n(),document.addEventListener("keydown",o)}),nt(()=>{document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",Z),document.removeEventListener("keydown",o)}),Re(()=>[d.platform,d.serial],()=>{g.setDevice(d.platform,d.serial),n()});const f=()=>Q("swipeUp",{},"Swiped up","Swipe failed"),m=()=>Q("swipeDown",{},"Swiped down","Swipe failed"),k=()=>Q("swipeLeft",{},"Swiped left","Swipe failed"),b=()=>Q("swipeRight",{},"Swiped right","Swipe failed");return(i,p)=>(D(),N("div",wo,[y("header",ko,[u(s(Ie),{align:"center",size:12},{default:h(()=>[u(s(se),{secondary:"",size:"small",onClick:p[0]||(p[0]=T=>O.value=!0)},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(At))]),_:1})]),default:h(()=>[K(" "+U(S.value.selectDevice),1)]),_:1}),u(s(le),{size:"20",color:"#18a058"},{default:h(()=>[(D(),be(_t(Me.value)))]),_:1}),y("span",bo,U(a.serial),1),u(s(se),{text:"",size:"small",onClick:e},{icon:h(()=>[u(s(le),{size:"14"},{default:h(()=>[u(s(Tt))]),_:1})]),_:1}),u(s(Ot),{size:"small"},{default:h(()=>[u(s(se),{type:$.value==="hierarchy"?"primary":"default",secondary:$.value!=="hierarchy",onClick:p[1]||(p[1]=T=>$.value="hierarchy")},{default:h(()=>[K(U(S.value.hierarchy),1)]),_:1},8,["type","secondary"]),u(s(se),{type:$.value==="actions"?"primary":"default",secondary:$.value!=="actions",onClick:p[2]||(p[2]=T=>$.value="actions")},{default:h(()=>[K(U(S.value.actions),1)]),_:1},8,["type","secondary"]),u(s(se),{type:$.value==="package"?"primary":"default",secondary:$.value!=="package",onClick:p[3]||(p[3]=T=>$.value="package")},{default:h(()=>[K(U(S.value.package),1)]),_:1},8,["type","secondary"])]),_:1})]),_:1}),u(s(Ie),{align:"center",size:16},{default:h(()=>[u(s(Ee),{placement:"bottom"},{trigger:h(()=>[u(s(se),{quaternary:"",circle:"",onClick:n,loading:s(g).loading},{icon:h(()=>[u(s(le),{size:"20"},{default:h(()=>[u(s(mt))]),_:1})]),_:1},8,["loading"])]),default:h(()=>[K(" "+U(S.value.refresh),1)]),_:1}),u(s(se),{quaternary:"",circle:"",onClick:s(x).toggleTheme},{icon:h(()=>[u(s(le),{size:"20"},{default:h(()=>[(D(),be(_t(s(x).isDark?s(Pt):s(On))))]),_:1})]),_:1},8,["onClick"]),u(s(Mt),{value:s(E).locale,"onUpdate:value":p[4]||(p[4]=T=>s(E).locale=T),size:"small"},{default:h(()=>[u(s(et),{value:"zh"},{default:h(()=>[...p[9]||(p[9]=[K("",-1)])]),_:1}),u(s(et),{value:"en"},{default:h(()=>[...p[10]||(p[10]=[K("English",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),y("div",So,[y("div",{class:"screen-panel",style:nn({width:I.value+"px"})},[y("div",_o,[y("div",Co,[u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{quaternary:"",circle:"",size:"small",onClick:ye},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(Bn))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.home),1)]),_:1}),u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{quaternary:"",circle:"",size:"small",onClick:X},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(Ft))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.back),1)]),_:1}),u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{quaternary:"",circle:"",size:"small",onClick:J},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(At))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.apps),1)]),_:1}),u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{quaternary:"",circle:"",size:"small",onClick:ae},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(Wn))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.wake),1)]),_:1}),u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{quaternary:"",circle:"",size:"small",onClick:Ae},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(xt))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.stop),1)]),_:1})]),y("div",$o,[u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{quaternary:"",circle:"",size:"small",onClick:_e},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(lr))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.volumeDown),1)]),_:1}),u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{quaternary:"",circle:"",size:"small",onClick:Pe},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(cr))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.volumeMute),1)]),_:1}),u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{quaternary:"",circle:"",size:"small",onClick:ve},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(ir))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.volumeUp),1)]),_:1})]),y("div",Po,[u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{circle:"",size:"small",onClick:f},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(gn))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.swipeUp),1)]),_:1}),u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{circle:"",size:"small",onClick:m},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(mn))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.swipeDown),1)]),_:1}),u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{circle:"",size:"small",onClick:k},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(Ft))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.swipeLeft),1)]),_:1}),u(s(Ee),{placement:"right"},{trigger:h(()=>[u(s(se),{circle:"",size:"small",onClick:b},{icon:h(()=>[u(s(le),{size:"18"},{default:h(()=>[u(s(Lt))]),_:1})]),_:1})]),default:h(()=>[K(" "+U(S.value.swipeRight),1)]),_:1})]),G.value?(D(),N("div",Ao,[u(s(se),{type:"primary",size:"small",onClick:Ne,class:"vertical-text-btn"},{default:h(()=>[y("span",Fo,U(S.value.tapElement),1)]),_:1})])):we("",!0)]),y("div",To,[y("div",Uo,[u(s(je),{value:fe.value,"onUpdate:value":p[5]||(p[5]=T=>fe.value=T),size:"small",placeholder:"Enter text to send...",onKeydown:Bt(q,["enter"]),style:{flex:"1"}},null,8,["value"]),u(s(Ee),null,{trigger:h(()=>[u(s(se),{type:"primary",size:"small",onClick:q,disabled:!fe.value.trim()},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(er))]),_:1})]),_:1},8,["disabled"])]),default:h(()=>[p[11]||(p[11]=K(" Send ",-1))]),_:1}),u(s(Ee),null,{trigger:h(()=>[u(s(se),{quaternary:"",size:"small",onClick:te},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(yt))]),_:1})]),_:1})]),default:h(()=>[p[12]||(p[12]=K(" Clear ",-1))]),_:1})]),y("div",Do,[u(s(rn),{show:s(g).loading,style:{width:"100%",height:"100%"}},{default:h(()=>[s(g).screenshotUrl?(D(),be(zr,{key:0,platform:a.platform,serial:a.serial,"screen-size":Be.value,onTap:ue,onRecordTap:De,onRecordSwipe:Ue},null,8,["platform","serial","screen-size"])):we("",!0)]),_:1},8,["show"])])])],4),y("div",{class:"resize-handle",onMousedown:C},null,32),$.value==="hierarchy"?(D(),N("div",Eo,[y("div",Mo,[p[13]||(p[13]=y("span",{class:"xpath-label"},"XPath by",-1)),y("div",Bo,[u(s(an),{value:L.value,"onUpdate:value":p[6]||(p[6]=T=>L.value=T),options:z.value,"render-label":M,"render-tag":oe,"consistent-menu-width":!1,size:"small"},null,8,["value","options"])]),u(s(se),{size:"small",quaternary:"",circle:"",onClick:r,disabled:!V.value},{icon:h(()=>[u(s(le),null,{default:h(()=>[u(s(Tt))]),_:1})]),_:1},8,["disabled"])]),V.value?(D(),N("div",Ro,[y("div",Oo,U(V.value),1),Y.value.length>1?(D(),N("div",zo,[(D(!0),N(He,null,Je(Y.value,(T,R)=>(D(),be(s(se),{key:R,size:"small",type:R===ee.value?"info":"default",secondary:R!==ee.value,circle:"",onClick:re=>pe(R),class:"sibling-btn"},{default:h(()=>[K(U(R+1),1)]),_:2},1032,["type","secondary","onClick"]))),128))])):we("",!0)])):we("",!0),y("div",Io,[(D(!0),N(He,null,Je(ne.value,T=>(D(),N("div",{key:T.label,class:"property-row"},[y("div",Lo,U(T.label),1),y("div",No,[u(s(le),{class:"circle-icon"},{default:h(()=>[u(s(dt))]),_:1}),y("span",null,U(T.value),1)])]))),128)),ne.value.length===0?(D(),be(s(tt),{key:0,description:"No element selected"})):we("",!0)])])):we("",!0),y("div",jo,[$.value==="hierarchy"?(D(),be(Zr,{key:0,platform:a.platform,serial:a.serial},null,8,["platform","serial"])):we("",!0),on(u(Na,{ref_key:"actionsPanelRef",ref:F,platform:a.platform,serial:a.serial},null,8,["platform","serial"]),[[sn,$.value==="actions"]]),$.value==="package"?(D(),be(no,{key:1,platform:a.platform,serial:a.serial},null,8,["platform","serial"])):we("",!0)])]),u(dn,{show:O.value,"onUpdate:show":p[7]||(p[7]=T=>O.value=T),onSelect:t},null,8,["show"]),u(go,{show:w.value,"onUpdate:show":p[8]||(p[8]=T=>w.value=T),serial:a.serial,"error-message":_.value,onConfirm:c},null,8,["show","serial","error-message"])]))}}),Go=Le(Ho,[["__scopeId","data-v-cc87f1cc"]]);export{Go as default};
